<div class="main">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="heading-title page-title">
                    <h1 class="page-title"><i class="fa fa-dashboard"></i><?php echo $title; ?></h1>
                    <a class="black-btn pull-right" href="<?php echo base_url('dashboard/reports/' . $company_sid); ?>">
                        <i class="fa fa-long-arrow-left"></i> 
                        Back to Reports
                    </a>
                </div>
                <!-- search form drop down -->
                <div class="hr-search-criteria <?php
                if (isset($flag) && $flag == true) {
                    echo 'opened';
                }
                ?>">
                    <strong>Click to modify search criteria</strong>
                </div>
                <div class="hr-search-main" <?php
                if (isset($flag) && $flag == true) {
                    echo "style='display:block'";
                }
                ?>>
                    <!-- search form -->
                    <form method="GET" action="<?php echo base_url('reports/applicant_source_report/' . $company_sid); ?>" name="search" id="search">
                        <div class="row">
                            <!-- jobs div -->
                            <div class="col-lg-6 col-md-6 col-xs-12 col-sm-6">
                                <div class="field-row">
                                    <label class="text-left">Job Title </label>
                                    <div class="hr-select-dropdown">
                                        <?php if (isset($jobs) && sizeof($jobs) > 0) { ?>
                                            <select class="invoice-fields" name="filter_value_Title" id="job_sid">
                                                <option value="">Please Select</option>
                                                <?php foreach ($jobs as $job) { ?>
                                                    <option <?php if (isset($search['filter_value_Title']) && $search['filter_value_Title'] == $job['sid']) { ?> selected="selected" <?php } ?> value="<?php echo $job['sid']; ?>">
                                                        <?php echo $job['Title']; ?>
                                                    </option>
                                                <?php } ?>
                                            </select>
                                        <?php } else { ?>
                                        <select class="invoice-fields"><option>No jobs found.</option></select>
                                        <?php } ?>
                                    </div>
                                </div>
                            </div>
                            <!-- jobs div -->
                            <input type="hidden" name="filter_method_Title" id="filter_method_Title" value="equals"/>
                            <div class="col-lg-6 col-md-6 col-xs-12 col-sm-6">
                                <div class="box-view reports-filtering">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label> First Name </label>
                                                <div class="hr-select-dropdown">
                                                    <select name="filter_method_first_name" class="invoice-fields">
                                                        <option value="like" <?php
                                                        if (isset($search['filter_method_first_name']) && $search['filter_method_first_name'] == 'like') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Like</option>
                                                        <option value="equals" <?php
                                                        if (isset($search['filter_method_first_name']) && $search['filter_method_first_name'] == 'equals') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Equals</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label class="transparent-label"> Empty </label>
                                                <input class="invoice-fields" placeholder="Filter Text" type="text" name="filter_value_first_name" id="filter_value_first_name" value="<?php echo isset($search['filter_value_first_name']) ? $search['filter_value_first_name'] : ''; ?>">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-xs-12 col-sm-6">
                                <div class="box-view reports-filtering">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label>Last Name </label>
                                                <div class="hr-select-dropdown">
                                                    <select name="filter_method_last_name" class="invoice-fields">
                                                        <option value="like" <?php
                                                        if (isset($search['filter_method_last_name']) && $search['filter_method_last_name'] == 'like') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Like</option>
                                                        <option value="equals" <?php
                                                        if (isset($search['filter_method_last_name']) && $search['filter_method_last_name'] == 'equals') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Equals</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label class="transparent-label"> Empty </label>
                                                <input class="invoice-fields"
                                                       placeholder="Filter Text"
                                                       type="text"
                                                       name="filter_value_last_name"
                                                       id="filter_value_last_name"
                                                       value="<?php echo isset($search['filter_value_last_name']) ? $search['filter_value_last_name'] : ''; ?>"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-xs-12 col-sm-6">
                                <div class="box-view reports-filtering">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label>Email </label>
                                                <div class="hr-select-dropdown">
                                                    <select name="filter_method_email" class="invoice-fields">
                                                        <option value="like" <?php
                                                        if (isset($search['filter_method_email']) && $search['filter_method_email'] == 'like') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Like</option>
                                                        <option value="equals" <?php
                                                        if (isset($search['filter_method_email']) && $search['filter_method_email'] == 'equals') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Equals</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label class="transparent-label">empty</label>
                                                <input class="invoice-fields"
                                                       placeholder="Filter Text"
                                                       type="text"
                                                       name="filter_value_email"
                                                       id="filter_value_email"
                                                       value="<?php echo isset($search['filter_value_email']) ? $search['filter_value_email'] : ''; ?>"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-xs-12 col-sm-6">
                                <div class="box-view reports-filtering">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label>Phone Number </label>
                                                <div class="hr-select-dropdown">
                                                    <select name="filter_method_phone_number" class="invoice-fields">
                                                        <option value="like" <?php
                                                        if (isset($search['filter_method_phone_number']) && $search['filter_method_phone_number'] == 'like') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Like</option>
                                                        <option value="equals" <?php
                                                        if (isset($search['filter_method_phone_number']) && $search['filter_method_phone_number'] == 'equals') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Equals</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label class="transparent-label">empty</label>
                                                <input class="invoice-fields"
                                                       placeholder="Filter Text"
                                                       type="text"
                                                       name="filter_value_phone_number"
                                                       id="filter_value_phone_number"
                                                       value="<?php echo isset($search['filter_value_phone_number']) ? $search['filter_value_phone_number'] : ''; ?>"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-xs-12 col-sm-6">
                                <div class="box-view reports-filtering">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label>Date Applied</label>
                                                <div class="hr-select-dropdown">
                                                    <select name="filter_method_date_applied" class="invoice-fields">
                                                        <option value="equals" <?php
                                                        if (isset($search['filter_method_date_applied']) && $search['filter_method_date_applied'] == 'equals') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Equals</option>
                                                        <option value="greater_than" <?php
                                                        if (isset($search['filter_method_date_applied']) && $search['filter_method_date_applied'] == 'greater_than') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Greater Than</option>
                                                        <option value="lesser_than" <?php
                                                        if (isset($search['filter_method_date_applied']) && $search['filter_method_date_applied'] == 'lesser_than') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Lesser Than</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label class="transparent-label">empty</label>
                                                <input class="invoice-fields datepicker"
                                                       placeholder="Filter Text"
                                                       type="text"
                                                       name="filter_value_date_applied"
                                                       id="filter_value_date_applied"
                                                       value="<?php echo isset($search['filter_value_date_applied']) ? $search['filter_value_date_applied'] : ''; ?>"/>                                                                   
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-xs-12 col-sm-6">
                                <div class="box-view reports-filtering">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label>Applicant Type </label>
                                                <div class="hr-select-dropdown">
                                                    <select name="filter_method_applicant_type" class="invoice-fields">
                                                        <option value="like" <?php
                                                        if (isset($search['filter_method_applicant_type']) && $search['filter_method_applicant_type'] == 'like') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Like</option>
                                                        <option value="equals" <?php
                                                        if (isset($search['filter_method_applicant_type']) && $search['filter_method_applicant_type'] == 'equals') {
                                                            echo 'selected';
                                                        }
                                                        ?>>Equals</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="field-row">
                                                <label class="transparent-label">empty</label>
                                                <input class="invoice-fields"
                                                       placeholder="Filter Text"
                                                       type="text"
                                                       name="filter_value_applicant_type"
                                                       id="filter_value_applicant_type"
                                                       value="<?php echo isset($search['filter_value_applicant_type']) ? $search['filter_value_applicant_type'] : ''; ?>"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>                                                
                            </div>
                            <div class="field-row field-row-autoheight col-lg-12 text-right">
                                <input type="submit" class="btn btn-success" value="Apply Filters" name="submit" id="apply_filters_submit">
                                <a class="btn btn-success" href="<?php echo base_url('reports/applicant_source_report/' . $company_sid); ?>">Reset Filters</a>
                            </div>

                        </div>
                    </form>
                    <!-- search form -->
                </div>
                <!-- search form drop down -->
                <?php if (isset($applicants) && sizeof($applicants) > 0) { ?>
                <div class="col-xs-12 col-sm-12 margin-top">
                    <div class="row">
                        <div class="bt-panel">
                            <a href="javascript:;" class="btn btn-success" onclick="print_page('#print_div');">
                                <i class="fa fa-print" aria-hidden="true"></i> 
                                Print
                            </a>
                            <form method="post" id="export" name="export">
                                <input type="hidden" name="submit" value="Export" />
                                <button class="btn btn-success" type="submit"><i class="fa fa-file-excel-o" aria-hidden="true"></i> Export To Excel</button>
                            </form>
                        </div>                                                               
                    </div>
                </div>
                <?php } ?>
                <!-- table -->
                <div class="hr-box">                                        
                    <div class="hr-box-header bg-header-green">
                        <h1 class="hr-registered">Applicants Report</h1>
                    </div>
                    <div class="table-responsive hr-innerpadding" id="print_div">
                        <table class="table table-bordered" id="example">
                            <thead>
                                <tr>
                                    <th class="col-xs-3">Job Title</th>
                                    <th class="col-xs-1">First Name</th>
                                    <th class="col-xs-1">Last Name</th>
                                    <th class="col-xs-1">Date Applied</th>
                                    <th class="col-xs-5">Applicant Source</th>
                                    <th class="col-xs-1">IP Address</th>
                                </tr> 
                            </thead>
                            <tbody>
                                <?php if (isset($applicants) && sizeof($applicants) > 0) { ?>
                                    <?php foreach ($applicants as $applicant) { ?>
                                        <tr>
                                            <td><?php echo ucwords($applicant['Title']); ?></td>
                                            <td><?php echo ucwords($applicant['first_name']); ?></td>
                                            <td><?php echo ucwords($applicant['last_name']); ?></td>
                                            <td class="text-center"><?php echo date_with_time($applicant['date_applied']); ?></td>
                                            <td><div class="table-responsive applicant_source_link_in_table"><?php echo ucwords($applicant['applicant_source']); ?></div></td>
                                            <td><?php echo ucwords($applicant['ip_address']); ?></td>
                                        </tr>
                                    <?php } ?>
                                <?php } else { ?>
                                    <tr>
                                        <td class="text-center" colspan="6">
                                            <div class="no-data">No applicants found.</div>
                                        </td>
                                    </tr>
                                <?php } ?>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- table -->
                <?php if (isset($applicants) && sizeof($applicants) > 0) { ?>
                <div class="col-xs-12 col-sm-12 margin-top">
                    <div class="row">
                        <div class="bt-panel">
                            <a href="javascript:;" class="btn btn-success" onclick="print_page('#print_div');">
                                <i class="fa fa-print" aria-hidden="true"></i> 
                                Print
                            </a>
                            <form method="post" id="export" name="export">
                                <input type="hidden" name="submit" value="Export" />
                                <button class="btn btn-success" type="submit"><i class="fa fa-file-excel-o" aria-hidden="true"></i> Export To Excel</button>
                            </form>
                        </div>                                                               
                    </div>
                </div>
                <?php } ?>
            </div>               					
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        // Search Area Toggle Function    
        jQuery('.hr-search-criteria').click(function () {
            jQuery(this).next().slideToggle('1000');
            jQuery(this).toggleClass("opened");
        });

        $('.datepicker').datepicker({dateFormat: 'mm-dd-yy'}).val();
    });

    function print_page(elem)
    {
        
        var data = ($(elem).html());
        var mywindow = window.open('', 'Print Report', 'height=800,width=1200');

        mywindow.document.write('<html><head><title>' + '<?php echo $title; ?>' + '</title>');
        mywindow.document.write('<link rel="stylesheet" href="<?php echo base_url('assets/css/style.css'); ?>" type="text/css" />');
        mywindow.document.write('<link rel="stylesheet" href="<?php echo base_url('assets/css/font-awesome.css'); ?>" type="text/css" />');
        mywindow.document.write('<link rel="stylesheet" href="<?php echo base_url('assets/css/bootstrap.css'); ?>" type="text/css" />');
        mywindow.document.write('</head><body >');
        mywindow.document.write(data);
        mywindow.document.write('</body></html>');
        mywindow.document.write('<scr' + 'ipt src="<?php echo base_url('assets/js/jquery-1.11.3.min.js'); ?>"></scr' + 'ipt>');
        mywindow.document.write('<scr' + 'ipt type="text/javascript">$(window).load(function() { window.print(); window.close(); });</scr' + 'ipt>');
        mywindow.document.close();
        mywindow.focus();
        
    }
</script>