<?php defined('BASEPATH') OR exit('No direct script access allowed');

class Hr_documents_content extends Admin_Controller
{
    function __construct()
    {
        parent::__construct();

        $this->load->model('hr_document_model');
    }

    public function index()
    {
        // ** Check Security Permissions Checks - Start ** //
        $redirect_url       = 'manage_admin';
        $function_name      = 'hr_documents_content';

        $admin_id = $this->ion_auth->user()->row()->id;
        $security_details = db_get_admin_access_level_details($admin_id);
        $this->data['security_details'] = $security_details;
        check_access_permissions($security_details, $redirect_url, $function_name); // Param2: Redirect URL, Param3: Function Name
        // ** Check Security Permissions Checks - End ** //

        $this->form_validation->set_rules('perform_action', 'perform_action', 'required');
        if($this->form_validation->run() == false){


            $this->data['editors'] = $this->hr_document_model->get_editors_data();
            $this->render('manage_admin/hr_documents_content/index');
        } else {
            $perform_action = $this->input->post('perform_action');

            switch ($perform_action){
                case 'save_editors':

                    $editor_01 = $this->input->post('editor_01');
                    $editor_02 = $this->input->post('editor_02');
                    $editor_03 = $this->input->post('editor_03');

                    $editors_data = array();
                    $editors_data['editor_01'] = htmlentities($editor_01);
                    $editors_data['editor_02'] = htmlentities($editor_02);
                    $editors_data['editor_03'] = htmlentities($editor_03);


                    $from_db = $this->hr_document_model->get_editors_data();

                    if(empty($from_db)){
                        $this->hr_document_model->insert_editors_data($editors_data);
                    } else {
                        $this->hr_document_model->update_editors_data(1, $editors_data);
                    }

                    $this->session->set_flashdata('message', '<strong>Success</strong> Editors Content Successfully Updated!');

                    redirect('manage_admin/hr_documents_content', 'refresh');
                    break;
            }
        }
    }


}