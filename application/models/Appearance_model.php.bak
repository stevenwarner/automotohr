<?php

class appearance_model extends CI_Model {

    function __construct() {
        // Call the Model constructor
        parent::__construct();
    }

    function get_themes($user_sid) {
        $this->db->where('user_sid', $user_sid);
        return $this->db->get('portal_themes')->result_array();
    }

    function run_query($qry) {
        return $this->db->query($qry);
    }

    function active_theme($theme_id, $employer_id) {
        //mark all theme deactive
        $this->db->set('theme_status', 0);
        $this->db->where('user_sid', $employer_id);
        $this->db->update('portal_themes');

        //now active only that theme you want to active
        $this->db->set('theme_status', 1);
        $this->db->where('sid', $theme_id);
        $this->db->update('portal_themes');
    }

    function SetThemeStatus($theme_id, $status = 0) {
        $this->db->where('sid', $theme_id);

        $data = array(
            'theme_status' => $status
        );

        $this->db->update('portal_themes', $data);
    }

    function SetPurchasedStatus($theme_id, $purchased = 0) {
        $this->db->where('sid', $theme_id);

        $data = array(
            'purchased' => $purchased
        );

        $this->db->update('portal_themes', $data);
    }

    function updateTheme($company_sid, $data) {
        $this->db->where('user_sid', $company_sid);
        $this->db->where('theme_name', 'theme-4');
        $this->db->update('portal_themes', $data);
    }

    function GetThemeId($theme_name, $user_sid) {

        $this->db->select('sid');
        $this->db->where('user_sid', $user_sid);
        $this->db->where('theme_name', $theme_name);
        $this->db->limit(1);
        $result = $this->db->get('portal_themes')->result_array();

        if (!empty($result)) {
            return intval($result[0]['sid']);
        } else {
            return null;
        }
    }

    function get_enterprise_theme_product() {
        $this->db->where('product_type', 'account-package');
        $this->db->where('sid', 27);
        $this->db->where('active', 1);
        return $this->db->get('products')->result_array();
    }

    function insert_career_page_logo_record($data){
        $this->db->insert('career_page_logo', $data);
    }

    function update_career_page_logo_record($company_sid, $data){
        $this->db->where('company_sid', $company_sid);
        $this->db->update('career_page_logo', $data);
    }

    function get_career_page_logo_record($company_sid){
        $this->db->where('company_sid', $company_sid);
        $record_obj = $this->db->get('career_page_logo');
        $record_arr = $record_obj->result_array();
        $record_obj->free_result();

        if(!empty($record_arr)){
            return $record_arr[0];
        } else {
            return array();
        }
    }

}

