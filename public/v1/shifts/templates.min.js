$(function(){let i=null,r=null;const t="jsModalPage",a=t+"Loader",o=t+"Body";function n(e,n,r,s){Modal({Id:t,Title:e,Body:'<div id="'+o+'"></div>',Loader:a},function(){var e=n,t=r,a=s;null!==i&&i.abort(),i=$.ajax({url:baseUrl("settings/page/"+e+"/"+t),method:"GET"}).always(function(){i=null}).fail(handleErrorResponse).done(function(e){$("#"+o).html(e.view),a(e)})})}function s(e,t,a){if(null===i){const n=callButtonHook(t,!0);i=$.ajax({url:baseUrl(a),method:"POST",data:e,processData:!1,contentType:!1}).always(function(){callButtonHook(n,!1),i=null}).fail(handleErrorResponse).done(function(e){return r?.destroy(),_success(e.msg,function(){window.location.href=baseUrl("settings/shifts/breaks")})})}}function l(){$(".jsTimeField").timepicker({timeFormat:"h:mm p",dynamic:!1,dropdown:!1,scrollbar:!1})}$(".jsAddShiftTemplateBtn").click(function(e){e.preventDefault(),n("New Shift Template","shift_template",0,function(){ml(!1,a),l(),r=$("#jsPageShiftBreakForm").validate({rules:{start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){return s(formArrayToObj($(e).serializeArray()),$(".jsPageShiftBreakBtn"),"settings/shifts/templates")}})})}),$(".jsEditShiftBreakBtn").click(function(e){e.preventDefault();const t=$(this).closest(".jsBox").data("id");n("Edit Break","shifts",t,function(){ml(!1,a),r=$("#jsPageShiftBreakForm").validate({rules:{rule_name:{required:!0},overtime_multiplier:{required:!0},double_overtime_multiplier:{required:!0}},submitHandler:function(e){e=formArrayToObj($(e).serializeArray());return e.append("id",t),s(e,$(".jsPageShiftBreakBtn"),"settings/shifts/breaks")}})})}),$(document).on("click",".jsAddBreak",function(e){e.preventDefault();e=getRandomCode();$(".jsBreakContainer").append(function(e){let t="";t+="<option></option>",breaksObject.map(function(e){t+='<option value="'+e.break_name+'" data-duration="'+e.break_duration+'">'+e.break_name+" ("+e.break_type+")</option>"});return'<div class="row jsBreakRow" data-key="'+e+'">    <br> '+'     <div class="col-sm-5">        <label class="text-medium">'+'            Break             <strong class="text-red">*</strong>'+'         </label>         <select name="breaks['+e+'][break]" class="form-control jsBreakSelect">'+t+"         </select>"+'     </div>     <div class="col-sm-3">'+'         <label class="text-medium">             Duration '+'             <strong class="text-red">*</strong>         </label>'+'         <div class="input-group">             <input type="number" class="form-control jsDuration" name="breaks['+e+'][duration]" />'+'             <div class="input-group-addon">mins</div>         </div>'+'     </div>     <div class="col-sm-3">'+'         <label class="text-medium">             Start TIme '+'         </label>         <input type="text" class="form-control jsTimeField jsStartTime" placeholder="HH:MM" name="breaks['+e+'][start_time]" />'+'     </div>     <div class="col-sm-1">'+'         <br>         <button class="btn btn-red jsDeleteBreakRow" title="Delete this break" type="button">'+'             <i class="fa fa-trash" style="margin-right: 0"></i>         </button>'+"     </div></div>"}(e)),$('[name="breaks['+e+'][break]"]').rules("add",{required:!0}),$('[name="breaks['+e+'][duration]"]').rules("add",{required:!0,number:!0,digits:!0,greaterThanZero:!0}),l()}),$(document).on("click",".jsDeleteBreakRow",function(e){e.preventDefault();e=$(this).closest(".jsBreakRow").data("key");$('.jsBreakRow[data-key="'+e+'"]').remove(),$('[name="breaks['+e+'][break]"]').rules("remove"),$('[name="breaks['+e+'][duration]"]').rules("remove")}),$(document).on("change",".jsBreakSelect",function(){var e=$(this).closest(".jsBreakRow").data("key");$('[name="breaks['+e+'][duration]"]').val($(this).find("option:selected").data("duration"))}),$(".jsDeleteShiftTemplateBtn").click(function(e){e.preventDefault();const n=$(this).closest(".jsBox"),r=n.data("id");return _confirm("Are you sure you want to delete it? This action cannot be undone.",function(){var e=n,t=r;if(null===i){const a=callButtonHook(e.find(".jsDeleteShiftTemplateBtn"),!0);i=$.ajax({url:baseUrl("settings/shifts/template/"+t),method:"DELETE"}).always(function(){callButtonHook(a,!1),i=null}).fail(handleErrorResponse).done(function(e){return _success(e.msg,function(){window.location.href=baseUrl("settings/shifts/templates")})})}})}),$(document).on("click",".jsAddChangeStatus",function(){var e=$(this).data("target");$('[name="'+e+'"]').prop("disabled",!$(this).prop("checked")),$('[name="'+e+'"]').rules("remove"),$(this).prop("checked")&&$('[name="'+e+'"]').rules("add",{required:!0,number:!0})})});
