const modalId="jsModalPage",modalLoader=modalId+"Loader",modalBody=modalId+"Body";let shiftsIds=[];$(function(){let o=null,r=null;function s(e){var t,s,n,i;shiftsIds=e,t="Swap Shifts",s="trade_shift",n=0,i=function(){ml(!1,modalLoader),r=$("#jsPageTradeShiftForm").validate({rules:{employees:{required:!0}},errorPlacement:function(t,e){($(e).parent().hasClass("input-group")?$(e).parent():$(e)).after(t)},submitHandler:function(t){if($(t).serializeArray(),"0"==$("#employees :selected").val())return _error("Please select an employee.");employeeId=$("#employees :selected").val(),alertify.confirm("Are You Sure?","Are you sure want to shifts swap?",function(){var t=new FormData;t.append("employeeid",employeeId),t.append("shiftids",e),c(t,"","settings/shifts/tradeshifts",function(t){_success(t.msg,function(){window.location.reload()})})},function(){})}})},Modal({Id:modalId,Title:t,Body:'<div id="'+modalBody+'"></div>',Loader:modalLoader},function(){var t=s,e=n,a=i;params="params?shiftsIds="+shiftsIds,callUrl=""!=shiftsIds?baseUrl("settings/page/"+t+"/"+e+"/"+params):baseUrl("settings/page/"+t+"/"+e),null!==o&&o.abort(),o=$.ajax({url:callUrl,method:"GET"}).always(function(){o=null}).fail(handleErrorResponse).done(function(t){$("#"+modalBody).html(t.view),a(t)})})}function c(e,a,s,n){if(null===o){let t;a&&(t=callButtonHook(a,!0)),o=$.ajax({url:baseUrl(s),method:"POST",data:e,processData:!1,contentType:!1}).always(function(){a&&callButtonHook(t,!1),o=null}).fail(handleErrorResponse).done(function(t){return r?.destroy(),n(t)})}}$(".jsDateRangePicker").daterangepicker({showDropdowns:!0,autoApply:!0,locale:{format:"MM/DD/YYYY",separator:" - "}}),$("#check_all").click(function(){$("#check_all").is(":checked")?$(".my_checkbox:checkbox").each(function(){this.checked=!0}):$(".my_checkbox:checkbox").each(function(){this.checked=!1})}),$(".jsTradeShifts").click(function(t){t.preventDefault();let e=[];var a;$(".my_checkbox:checked").each(function(){""!=(a=$(this).data("status"))&&"rejected"!=a&&"cancelled"!=a||e.push($(this).val())}),0<e.length?s(e):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsCancelTradeShifts").click(function(t){t.preventDefault();let e=[];$(".my_checkbox:checked").each(function(){"awaiting confirmation"==$(this).data("status")&&e.push($(this).val())}),0<e.length?alertify.confirm("Are You Sure?","Are you sure want to cancel shifts swap?",function(){var t=new FormData;t.append("shiftids",e),c(t,"","settings/shifts/tradeshiftscancel",function(t){_success(t.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsTradeShift").click(function(t){t.preventDefault();t=[];t.push($(this).data("shiftid")),s(t)}),$(".jsCancelTradeShift").click(function(t){t.preventDefault();let e=[],a=$(this).data("shiftid");alertify.confirm("Are You Sure?","Are you sure want to cancel shifts swap?",function(){var t=new FormData;e.push(a),t.append("shiftids",e),c(t,"","settings/shifts/tradeshiftscancel",function(t){_success(t.msg,function(){window.location.reload()})})},function(){})}),$(".jsConfirmTradeShifts").click(function(t){t.preventDefault();let e=[];$(".my_checkbox:checked").each(function(){"awaiting confirmation"==$(this).data("status")&&e.push($(this).val())}),0<e.length?alertify.confirm("Are You Sure?","Are you sure want to Confirm shifts?",function(){var t=new FormData;t.append("shiftids",e),t.append("shiftstatus","confirmed"),c(t,"","settings/shifts/my_trade_change_status",function(t){_success(t.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsRejectTradeShifts").click(function(t){t.preventDefault();let e=[];var a;$(".my_checkbox:checked").each(function(){"awaiting confirmation"!=(a=$(this).data("status"))&&"confirmed"!=a||e.push($(this).val())}),0<e.length?alertify.confirm("Are You Sure?","Are you sure want to Reject shifts?",function(){var t=new FormData;t.append("shiftids",e),t.append("shiftstatus","rejected"),c(t,"","settings/shifts/my_trade_change_status",function(t){_success(t.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsRejectTradeShift").click(function(t){t.preventDefault();let e=[];e.push($(this).data("shiftid")),alertify.confirm("Are You Sure?","Are you sure want to Reject shifts?",function(){var t=new FormData;t.append("shiftids",e),t.append("shiftstatus","rejected"),c(t,"","settings/shifts/my_trade_change_status",function(t){_success(t.msg,function(){window.location.reload()})})},function(){})}),$(".jsConfirmTradeShift").click(function(t){t.preventDefault();let e=[];e.push($(this).data("shiftid")),alertify.confirm("Are You Sure?","Are you sure want to Confirm shifts?",function(){var t=new FormData;t.append("shiftids",e),t.append("shiftstatus","confirmed"),c(t,"","settings/shifts/my_trade_change_status",function(t){_success(t.msg,function(){window.location.reload()})})},function(){})}),$(document).on("click",".jsApproveTradeShift",function(t){t.preventDefault();let e=[],a=$(this).data("shiftid");alertify.confirm("Are You Sure?","Are you sure want to Approve shifts request?",function(){var t=new FormData;e.push(a),t.append("shiftids",e),c(t,"","settings/shifts/tradeshiftsapprove",function(t){_success(t.msg,function(){window.location.reload()})})},function(){})}),$(document).on("click",".jsAdminApproveTradeShifts",function(t){t.preventDefault();let e=[];$(".my_checkbox:checked").each(function(){e.push($(this).val())}),0<e.length?alertify.confirm("Are You Sure?","Are you sure want to Approve shifts request?",function(){var t=new FormData;t.append("shiftids",e),c(t,"","settings/shifts/tradeshiftsapprove",function(t){_success(t.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(document).on("click",".jsAdminRejectTradeShift",function(t){t.preventDefault();let e=[],a=$(this).data("shiftid");alertify.confirm("Are You Sure?","Are you sure want to Reject shifts request?",function(){var t=new FormData;e.push(a),t.append("shiftids",e),c(t,"","settings/shifts/tradeshiftsreject",function(t){_success(t.msg,function(){window.location.reload()})})},function(){})}),$(".jsAdminRejectTradeShifts").click(function(t){t.preventDefault();let e=[];$(".my_checkbox:checked").each(function(){e.push($(this).val())}),0<e.length?alertify.confirm("Are You Sure?","Are you sure want to Reject shifts request?",function(){var t=new FormData;t.append("shiftids",e),c(t,"","settings/shifts/tradeshiftsreject",function(t){_success(t.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$("#jsApplyFilter").click(function(t){t.preventDefault(),e.Requests.Main.type=$(".csActiveTab").find("a").data("key"),e.Requests.Main.filter.dateRange=$(".jsDateRangePicker").val(),n()});let e={Requests:{Main:{action:"get_requests",type:"all",filter:{dateRange:""}}}},a=null,t=baseUrl("settings/handler");function n(){null==a&&(ml(!0,"requests"),$(".js-error-row").remove(),a=$.post(t,e.Requests.Main,function(t){if(!(a=null)===t.Redirect)alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});else{if(!1===t.Status&&1==e.Balances.Main.page)alert("asdasdasd"),$(".js-ip-pagination").html(""),$("#js-data-area").html(`<tr class="js-error-row"><td colspan="${$(".js-table-head").find("th").length}"><p class="alert alert-info text-center">${t.Response}</p></td></tr>`);else if(!1!==t.Status){let a="";0==t.Data.length?$("#js-data-area").html('<tr><td colspan="6"><p class="alert alert-info text-center">No Request found.</p></td></tr>'):($.each(t.Data,function(t,e){a+="<tr><td>",""+e.request_status!="Approved"&&""+e.request_status!="Admin Rejected"&&(a=(a=(a+='<label class="control control--checkbox">')+`<input type="checkbox" name="checkit[]" value="${e.shift_sid}" class="my_checkbox" data-status="" >`)+'<div class="control__indicator"></div></label>'),a=(a=(a=(a=(a=(a=(a+="</td>")+`<td style="vertical-align: middle;">${e.shift_date} `+"<br> "+e.start_time+"</td>")+'<td style="vertical-align: middle;">'+("Admin Rejected"==e.request_status?"Rejected":e.request_status)+"<br> "+e.updated_at+"</td>")+'<td style="vertical-align: middle;">'+e.created_at+"</td>")+'<td style="vertical-align: middle;">'+e.from_employee+"</td>")+'<td style="vertical-align: middle;">'+e.to_employee+"</td>")+'<td><div class="col-sm-12 text-right">',""+e.request_status!="Approved"&&""+e.request_status!="Admin Rejected"&&(a=(a=a+`<button class="btn btn-red jsAdminRejectTradeShift" data-shiftid="${e.shift_sid}">Reject`+"</button>")+`<button class="btn btn-orange jsApproveTradeShift" data-shiftid="${e.shift_sid}">Approve`+"</button>"),a=(a+="</div>")+"</td></tr>"}),$("#js-data-area").html(a))}else $(".js-ip-pagination").html("");ml(!1,"requests")}}))}$(".jsReportTab").click(function(t){t.preventDefault(),e.Requests.Main.type=$(this).data("key"),e.Requests.Main.filter.dateRange=$(".jsDateRangePicker").val(),$(".jsReportTab").parent().removeClass("active").removeClass("csActiveTab"),$(this).parent().addClass("active").addClass("csActiveTab"),n()}),$('.jsReportTab[data-key="all"]').trigger("click")});
