const modalId="jsModalPage",modalLoader=modalId+"Loader",modalBody=modalId+"Body";let shiftsIds=[];$(function(){let o=null,r=null;function a(t){var e,a,n,i;shiftsIds=t,e="Swap Shifts",a="trade_shift",n=0,i=function(){ml(!1,modalLoader),r=$("#jsPageTradeShiftForm").validate({rules:{employees:{required:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){if($(e).serializeArray(),"0"==$("#employees :selected").val())return _error("Please select an employee.");employeeId=$("#employees :selected").val(),alertify.confirm("Are You Sure?","Are you sure want to shifts swap?",function(){var e=new FormData;e.append("employeeid",employeeId),e.append("shiftids",t),c(e,"","settings/shifts/tradeshifts",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}})},Modal({Id:modalId,Title:e,Body:'<div id="'+modalBody+'"></div>',Loader:modalLoader},function(){var e=a,t=n,s=i;params="params?shiftsIds="+shiftsIds,callUrl=""!=shiftsIds?baseUrl("settings/page/"+e+"/"+t+"/"+params):baseUrl("settings/page/"+e+"/"+t),null!==o&&o.abort(),o=$.ajax({url:callUrl,method:"GET"}).always(function(){o=null}).fail(handleErrorResponse).done(function(e){$("#"+modalBody).html(e.view),s(e)})})}function c(t,s,a,n){if(null===o){let e;s&&(e=callButtonHook(s,!0)),o=$.ajax({url:baseUrl(a),method:"POST",data:t,processData:!1,contentType:!1}).always(function(){s&&callButtonHook(e,!1),o=null}).fail(handleErrorResponse).done(function(e){return r?.destroy(),n(e)})}}$(".jsDateRangePicker").daterangepicker({showDropdowns:!0,autoApply:!0,locale:{format:"MM/DD/YYYY",separator:" - "}}),$("#check_all").click(function(){$("#check_all").is(":checked")?$(".my_checkbox:checkbox").each(function(){this.checked=!0}):$(".my_checkbox:checkbox").each(function(){this.checked=!1})}),$(".jsTradeShifts").click(function(e){e.preventDefault();let t=[];var s;$(".my_checkbox:checked").each(function(){""!=(s=$(this).data("status"))&&"rejected"!=s&&"cancelled"!=s||t.push($(this).val())}),0<t.length?a(t):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsCancelTradeShifts").click(function(e){e.preventDefault();let t=[];$(".my_checkbox:checked").each(function(){"awaiting confirmation"==$(this).data("status")&&t.push($(this).val())}),0<t.length?alertify.confirm("Are You Sure?","Are you sure want to cancel shifts swap?",function(){var e=new FormData;e.append("shiftids",t),c(e,"","settings/shifts/tradeshiftscancel",function(e){_success(e.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsTradeShift").click(function(e){e.preventDefault();e=[];e.push($(this).data("shiftid")),a(e)}),$(".jsCancelTradeShift").click(function(e){e.preventDefault();let t=[],s=$(this).data("shiftid");alertify.confirm("Are You Sure?","Are you sure want to cancel shifts swap?",function(){var e=new FormData;t.push(s),e.append("shiftids",t),c(e,"","settings/shifts/tradeshiftscancel",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}),$(".jsConfirmTradeShifts").click(function(e){e.preventDefault();let t=[];$(".my_checkbox:checked").each(function(){"awaiting confirmation"==$(this).data("status")&&t.push($(this).val())}),0<t.length?alertify.confirm("Are You Sure?","Are you sure want to Confirm shifts?",function(){var e=new FormData;e.append("shiftids",t),e.append("shiftstatus","confirmed"),c(e,"","settings/shifts/my_trade_change_status",function(e){_success(e.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsRejectTradeShifts").click(function(e){e.preventDefault();let t=[];var s;$(".my_checkbox:checked").each(function(){"awaiting confirmation"!=(s=$(this).data("status"))&&"confirmed"!=s||t.push($(this).val())}),0<t.length?alertify.confirm("Are You Sure?","Are you sure want to Reject shifts?",function(){var e=new FormData;e.append("shiftids",t),e.append("shiftstatus","rejected"),c(e,"","settings/shifts/my_trade_change_status",function(e){_success(e.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(".jsRejectTradeShift").click(function(e){e.preventDefault();let t=[];t.push($(this).data("shiftid")),alertify.confirm("Are You Sure?","Are you sure want to Reject shifts?",function(){var e=new FormData;e.append("shiftids",t),e.append("shiftstatus","rejected"),c(e,"","settings/shifts/my_trade_change_status",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}),$(".jsConfirmTradeShift").click(function(e){e.preventDefault();let t=[];t.push($(this).data("shiftid")),alertify.confirm("Are You Sure?","Are you sure want to Confirm shifts?",function(){var e=new FormData;e.append("shiftids",t),e.append("shiftstatus","confirmed"),c(e,"","settings/shifts/my_trade_change_status",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}),$(document).on("click",".jsApproveTradeShift",function(e){e.preventDefault();let t=[],s=$(this).data("shiftid");alertify.confirm("Are You Sure?","Are you sure want to Approve shifts request?",function(){var e=new FormData;t.push(s),e.append("shiftids",t),c(e,"","settings/shifts/tradeshiftsapprove",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}),$(document).on("click",".jsAdminApproveTradeShifts",function(e){e.preventDefault();let t=[];$(".my_checkbox:checked").each(function(){t.push($(this).val())}),0<t.length?alertify.confirm("Are You Sure?","Are you sure want to Approve shifts request?",function(){var e=new FormData;e.append("shiftids",t),c(e,"","settings/shifts/tradeshiftsapprove",function(e){_success(e.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(document).on("click",".jsAdminRejectTradeShift",function(e){e.preventDefault();let t=[],s=$(this).data("shiftid");alertify.confirm("Are You Sure?","Are you sure want to Reject shifts request?",function(){var e=new FormData;t.push(s),e.append("shiftids",t),c(e,"","settings/shifts/tradeshiftsreject",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}),$(".jsAdminRejectTradeShifts").click(function(e){e.preventDefault();let t=[];$(".my_checkbox:checked").each(function(){t.push($(this).val())}),0<t.length?alertify.confirm("Are You Sure?","Are you sure want to Reject shifts request?",function(){var e=new FormData;e.append("shiftids",t),c(e,"","settings/shifts/tradeshiftsreject",function(e){_success(e.msg,function(){window.location.reload()})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$("#jsApplyFilter").click(function(e){e.preventDefault(),t.Requests.Main.type=$(".csActiveTab").find("a").data("key"),t.Requests.Main.filter.dateRange=$(".jsDateRangePicker").val(),n()});let t={Requests:{Main:{action:"get_requests",type:"all",filter:{dateRange:""}}}},s=null,e=baseUrl("settings/handler");function n(){null==s&&(ml(!0,"requests"),$(".js-error-row").remove(),s=$.post(e,t.Requests.Main,function(e){if(!(s=null)===e.Redirect)alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});else{if(!1===e.Status&&1==t.Balances.Main.page)alert("asdasdasd"),$(".js-ip-pagination").html(""),$("#js-data-area").html(`<tr class="js-error-row"><td colspan="${$(".js-table-head").find("th").length}"><p class="alert alert-info text-center">${e.Response}</p></td></tr>`);else if(!1!==e.Status){let s="";0==e.Data.length?$("#js-data-area").html('<tr><td colspan="6"><p class="alert alert-info text-center">No Request found.</p></td></tr>'):($("#jsAllRequests").html("("+e.allRequests+")"),$("#jsPendingRequests").html("("+e.pendingRequests+")"),$("#jsApprovedRequests").html("("+e.approvedRequests+")"),$("#jsRejectedRequests").html("("+e.rejectedRequests+")"),$.each(e.Data,function(e,t){s+="<tr><td>",""+t.request_status!="Approved"&&""+t.request_status!="Admin Rejected"&&(s=(s=(s+='<label class="control control--checkbox">')+`<input type="checkbox" name="checkit[]" value="${t.shift_sid}" class="my_checkbox" data-status="" >`)+'<div class="control__indicator"></div></label>'),s=(s=(s=(s=(s=(s=(s+="</td>")+`<td style="vertical-align: middle;">${t.shift_date} `+"<br> "+t.start_time+"</td>")+'<td style="vertical-align: middle;">'+("Admin Rejected"==t.request_status?"Rejected":t.request_status)+"<br> "+t.updated_at+"</td>")+'<td style="vertical-align: middle;">'+t.created_at+"</td>")+'<td style="vertical-align: middle;">'+t.from_employee+"</td>")+'<td style="vertical-align: middle;">'+t.to_employee+"</td>")+'<td><div class="col-sm-12 text-right">',""+t.request_status!="Approved"&&""+t.request_status!="Admin Rejected"&&(s=(s=s+`<button class="btn btn-red jsAdminRejectTradeShift" data-shiftid="${t.shift_sid}">Reject`+"</button>")+`<button class="btn btn-orange jsApproveTradeShift" data-shiftid="${t.shift_sid}">Approve`+"</button>"),s=(s+="</div>")+"</td></tr>"}),$("#js-data-area").html(s))}else $(".js-ip-pagination").html("");ml(!1,"requests")}}))}$(".jsReportTab").click(function(e){e.preventDefault(),t.Requests.Main.type=$(this).data("key"),t.Requests.Main.filter.dateRange=$(".jsDateRangePicker").val(),$(".jsReportTab").parent().removeClass("active").removeClass("csActiveTab"),$(this).parent().addClass("active").addClass("csActiveTab"),n()}),$('.jsReportTab[data-key="all"]').trigger("click")});
