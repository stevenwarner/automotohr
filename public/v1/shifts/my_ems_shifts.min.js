!function(){let o,s=0;$(document).on("click",".jsModalCancel",e=>{e.preventDefault(),"yes"==$(e.target).data("ask")?alertify.confirm("Any unsaved changes will be lost.",()=>{$(e.target).closest(".csModal").fadeOut(300),$("body").css("overflow-y","auto"),$("#ui-datepicker-div").remove(),$(".jsMsModal").remove()}).set("labels",{ok:"LEAVE",cancel:"NO, I WILL STAY"}).set("title","Notice!"):($(e.target).closest(".csModal").fadeOut(300),$("body").css("overflow-y","auto"),$(".jsMsModal").remove(),$("#ui-datepicker-div").remove())}),window._ml=window.ml=function(e,t,a){t=void 0===t?".jsIPLoader":`.jsIPLoader[data-page="${t}"]`,void 0!==o&&document.getElementsByClassName("csModalBody").length&&(document.getElementsByClassName("csModalBody")[0].scrollTop=0),void 0!==o&&e&&$(".jsIPLoader").height($(`#${o}Body`).height()+s),void 0===e||!1===e?$(t).hide():$(t).show(),void 0!==a&&$(".jsIPLoaderText").html(a),e||$(".jsIPLoaderText").html("Please wait, while we are generating a preview.")},window.Model=window.Modal=function(e,t){var a=`
			<!-- Custom Modal -->
			<div class="csModal jsMsModal" id="${e.Id}">
				<div class="${e.Cl||"container"}">
					<div class="csModalHeader">
						<h3 class="csModalHeaderTitle">
							<span>${e.Title}</span>
							<span class="csModalButtonWrap">
							${void 0!==e.Buttons&&0!==e.Buttons.length?e.Buttons.join(""):""}
								<button class="btn btn-black btn-cancel csW jsModalCancel" ${void 0===e.Ask?"":'data-ask="no"'} title="Close this window">Cancel</button>
							</span>
							<div class="clearfix"></div>
						</h3>
					</div>
					<div class="csModalBody">
						<div class="csIPLoader jsIPLoader" data-page="${e.Loader}">
							<div class="csIPLoaderBox">
								<i class="fa fa-circle-o-notch fa-spin" aria-hidden="true"></i><br><br>
								<br>
								<span class="jsIPLoaderText">Please wait while we process your request.</span>
							</div>
						</div>
						${e.Body}
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
			`;o=e.Id,s=$(`#${e.Id} .csModalHeader`).height()+50,$(".jsMsModal").remove(),$("#"+e.Id).remove(),$("body").append(a),$("#"+e.Id).fadeIn(300),$("body").css("overflow-y","hidden"),$(`#${e.Id} .csModalBody`).css("top",s),void 0!==t&&t()}}(),$(function(){let l=null;const t="jsModalPage",n=t+"Loader",s=t+"Body";function r(){$(".jsTimeField").timepicker({timeFormat:"h:mm p",dynamic:!1,dropdown:!1,scrollbar:!1})}$('[data-toggle="cpopover"]').popover({trigger:"hover click",placement:"left auto",html:!0}),$(document).on("click",".jsEmployeeAvailability",function(e){e.preventDefault(),$(this).data("eid");var e="Add unavailability",a="add_unavailability_shift",o=function(e){ml(!1,n),r(),$(".jsUnavailableDate").daterangepicker({showDropdowns:!0,singleDatePicker:!0,autoApply:!0,locale:{format:"MM/DD/YYYY"}}),$(".multipleSelect").select2()};Modal({Id:t,Title:e,Body:'<div id="'+s+'"></div>',Loader:n},function(){var e=a,t=o;null!==l&&l.abort(),l=$.ajax({url:baseUrl("settings/page/"+e),method:"GET"}).always(function(){l=null}).fail(handleErrorResponse).done(function(e){$("#"+s).html(e.view),t(e)})})}),$(document).on("click",".jsUnavailableAllDay",function(e){0==$(".jsUnavailableAllDay").prop("checked")?($(".jsHoursRowCustom").remove(),$("#jsAddUnavailableTime").removeClass("hidden")):$("#jsAddUnavailableTime").addClass("hidden")}),$(document).on("click",".jsRepeat",function(e){(1==$(".jsRepeat").prop("checked")?($("#jsSelectedDate").html($(".jsUnavailableDate").val()),$(".jsRepeatSection").removeClass("hidden"),$(".jsOnOccurrences")):$(".jsRepeatSection")).addClass("hidden")}),$(document).on("change","#jsRepeatType",function(e){$(".jsRepeatType").addClass("hidden"),$(".jsWeeklyMonthlySection").addClass("hidden"),$(".jsWeeklyMonthlySectionSeparator").addClass("hidden");var t=$(this).val();"daily"==t?$(".jsDailyRepeat").removeClass("hidden"):"weekly"==t?($(".jsWeeklyRepeat").removeClass("hidden"),$(".jsWeeklySection").removeClass("hidden"),$(".jsWeeklyMonthlySectionSeparator").removeClass("hidden")):"monthly"==t&&($(".jsMonthlyRepeat").removeClass("hidden"),$(".jsMonthlySection").removeClass("hidden"),$(".jsWeeklyMonthlySectionSeparator").removeClass("hidden"))}),$(document).on("change","#jsOccurrencesType",function(e){var t=$(this).val();"after"==t?($(".jsAfterOccurrences").removeClass("hidden"),$(".jsOnOccurrences").addClass("hidden")):"on"==t&&($(".jsOnOccurrences").removeClass("hidden"),$(".jsAfterOccurrences").addClass("hidden"),$(".jsUnavailableEndDate").daterangepicker({showDropdowns:!0,singleDatePicker:!0,autoApply:!0,locale:{format:"MM/DD/YYYY"}}))}),$(document).on("click",".jsAddHours",function(e){e.preventDefault();e=getRandomCode();$(".jsHoursContainer").append(""+'<div class="row jsHoursRow jsHoursRowCustom" data-key="'+e+'">\t<div class="col-lg-1 col-md-1 col-xs-12 col-sm-1">\t\t<label class="text-medium">From<strong class="text-red">*</strong></label>\t</div>\t<div class="col-lg-3 col-md-3 col-xs-12 col-sm-3">\t\t<div class="form-group">\t\t\t<input type="text" class="form-control jsTimeField jsStartTime" placeholder="HH:MM" aria-invalid="false">\t\t</div>\t</div>\t<div class="col-lg-1 col-md-1 col-xs-12 col-sm-1">\t\t<label class="text-medium">To<strong class="text-red">*</strong></label>\t</div>\t<div class="col-lg-3 col-md-3 col-xs-12 col-sm-3">\t\t<div class="form-group">\t\t\t<input type="text" class="form-control jsTimeField jsEndTime" placeholder="HH:MM">\t\t</div>\t</div>\t<div class="col-lg-4 col-md-4 col-xs-12 col-sm-4">\t\t<button class="btn btn-orange jsAddHours">\t\t\t<i class="fa fa-plus-circle" aria-hidden="true"></i>\t\t\tAdd Hours\t\t</button>\t\t<button class="btn btn-red jsDeleteHourRow" title="Delete this break" type="button">             <i class="fa fa-trash" style="margin-right: 0"></i>\t\t</button>\t</div></div>'),r()}),$(document).on("click",".jsDeleteHourRow",function(e){e.preventDefault();e=$(this).closest(".jsHoursRow").data("key");$('.jsHoursRow[data-key="'+e+'"]').remove()}),$(document).on("click",".jsDeleteUnavailability",function(e){e.preventDefault();var o=$(this).data("unavailability"),e=$(this).data("unavailable_type"),s="",e=("partial_day"==e&&(s=$(this).data("unavailable_time")),$("#jsDeleteContent").html());alertify.confirm(e).set("onok",function(e,t){var a={};a.sequence=$('input[name="delete_type"]:checked').val(),a.date=o,a.time=s,ml(!0,n),l=$.ajax({url:baseUrl("shifts/delete/myUnavailability"),method:"POST",data:a,cache:!1}).done(function(e){alertify.alert("SUCCESS!",e.msg,function(){window.location.reload()})}).fail(handleErrorResponse).always(function(){l=null,ml(!1,n)})}).set("labels",{ok:"Delete",cancel:"Cancel"}).set("title","Delete Unavailability")}),$(document).on("click",".jsPageCreateUnavailabilityBtn",function(e){e.preventDefault();const t=[];var a={};if(a.date=$(".jsUnavailableDate").val(),a.note=$(".jsNote").val(),1==$(".jsUnavailableAllDay").prop("checked")?a.allDay="yes":(a.allDay="no",a.dailyTimes=[],$(".jsHoursRow").map(function(e){e+=1;startTime=$(this).closest("div").find(".jsStartTime").val(),endTime=$(this).closest("div").find(".jsEndTime").val(),startTime||t.push("At row "+e+" start time is missing."),endTime||t.push("At row "+e+" end time is missing."),a.dailyTimes.push({startTime:startTime,emdTime:endTime})})),1==$(".jsRepeat").prop("checked")?(a.repeat="yes",a.repeatType=$("#jsRepeatType").val(),"daily"==a.repeatType?a.daily=$("#jsEveryDaily").val():"weekly"==a.repeatType?(a.weekly=$("#jsEveryWeekly").val(),a.weekDays=[],$(".jsUnavailableWeekDay:checkbox:checked").each(function(){a.weekDays.push($(this).val())}),a.weekDays.length||t.push("Week days is missing.")):"monthly"==a.repeatType&&(a.monthly=$("#jsEveryMonthly").val(),a.monthDays=$("#jsMonthlyFrequency").val(),a.monthDays.length||t.push("Month days is missing.")),a.occurrencesType=$("#jsOccurrencesType").val(),"after"==a.occurrencesType?(a.occurrences=$("#jsOccurrences").val(),a.occurrences&&0!=a.occurrences?30<a.occurrences&&t.push("Occurrences number is less then 30."):t.push("Occurrences number is missing.")):"on"==a.occurrencesType&&(a.occurrenceEndDate=$(".jsUnavailableEndDate").val(),a.occurrenceEndDate||t.push("Last occurrence date is missing."))):a.repeat="no",t.length)return alertify.alert("ERROR!",getErrorsStringFromArray(t),CB);ml(!0,n),l=$.ajax({url:baseUrl("shifts/myUnavailability"),method:"POST",data:a,cache:!1}).done(function(e){alertify.alert("SUCCESS!",e.msg,function(){window.location.reload()})}).fail(handleErrorResponse).always(function(){l=null,ml(!1,n)})})}),$(function(){const l=getSearchParam("mode")||"month";function e(){let e="";var t;return e="month"===l?(t=getSearchParam("year")||moment().format("YYYY"),(getSearchParam("month")||moment().format("MM"))+"/01/"+t):getSearchParam("start_date")||moment().weekday(1).format("MM/DD/YYYY")}$(".jsWeekDaySelect").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:e(),locale:{format:"MM/DD/YYYY"},isInvalidDate:function(e){return"month"===l?"01"!==e.format("DD"):1!==e.day()}}),$(".jsWeekDaySelect").on("apply.daterangepicker",function(e,t){var a=("month"===l?t.startDate.clone().startOf("month"):t.startDate.clone()).format("MM/DD/YYYY");let o=0;o="week"===l?6:"two_week"===l?13:t.startDate.endOf("month").format("MM/DD/YYYY");var s=t.startDate.add(o,"days").format("MM/DD/YYYY");if("month"==l)return window.location.href=baseUrl("shifts/my?mode="+l+"&year="+t.startDate.clone().format("YYYY")+"&month="+t.startDate.clone().format("MM"));window.location.href=baseUrl("shifts/my?mode="+l+"&start_date="+a+"&end_date="+s)}),$(".schedule-employee-row").map(function(){$(".schedule-column-"+$(this).data("id")).height($(this).height())}),$("#shift_date_from").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:e(),locale:{format:"MM/DD/YYYY"}},function(e,t,a){$("#shift_date_to").data("daterangepicker").setStartDate(e)}),$("#shift_date_to").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:function(e){let t="";var a;return t="week"===l?getSearchParam("end_date")||moment(e,"MM/DD/YYYY").endOf("week").add(1,"day").format("MM/DD/YYYY"):"two_week"===l?getSearchParam("end_date")||moment(e,"MM/DD/YYYY").add(2,"week").subtract(1,"days").format("MM/DD/YYYY"):(e=getSearchParam("year")||moment().format("YYYY"),a=getSearchParam("month")||moment().format("MM"),moment(e+"-"+a+"-01").endOf("month").format("MM/DD/YYYY"))}(),locale:{format:"MM/DD/YYYY"}}),$(".jsNavigateRightMy").click(function(e){e.preventDefault();var e=$(".jsWeekDaySelect").data("daterangepicker").startDate;let t="",a=1;return t="week"===l?e.clone().add(1,"week"):"two_week"===l?(a=2,e.clone().add(2,"week")):e.clone().endOf("month"),"month"!==l?window.location.href=baseUrl("shifts/my?mode="+l+"&start_date="+t.clone().format("MM/DD/YYYY")+"&end_date="+t.clone().add(a,"week").subtract(1,"day").format("MM/DD/YYYY")):(e=t.clone().add(1,"month"),window.location.href=baseUrl("shifts/my?mode="+l+"&year="+e.clone().format("YYYY")+"&month="+e.clone().format("MM")))}),$(".jsNavigateLeftMy").click(function(e){e.preventDefault();var e=$(".jsWeekDaySelect").data("daterangepicker").startDate;return"month"!==l?window.location.href=baseUrl("shifts/my?mode="+l+"&start_date="+e.clone().subtract("week"===l?1:2,"week").format("MM/DD/YYYY")+"&end_date="+e.clone().subtract(1,"day").format("MM/DD/YYYY")):(e=e.clone().subtract(1,"month"),window.location.href=baseUrl("shifts/my?mode="+l+"&year="+e.clone().format("YYYY")+"&month="+e.clone().format("MM")))}),$(".jsFilterBtn").click(function(e){e.preventDefault(),$(".jsFilterRow").toggleClass("hidden")}),$(".jsFilterResetBtn").click(function(e){return e.preventDefault(),window.location.href=baseUrl("shifts/my?mode=month")}),$(".jsFilterApplyBtn").click(function(e){e.preventDefault();var e=$("#start_date").val(),t=$("#end_date").val();return e?t?window.location.href=baseUrl("shifts/my?mode=week&start_date="+e+"&end_date="+t):_error("Please select a end date."):_error("Please select a start date.")}),getSearchParam("start_date")&&$(".jsFilterBtn").trigger("click")});
