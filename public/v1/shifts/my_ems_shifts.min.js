!function(){let o,r=0;$(document).on("click",".jsModalCancel",e=>{e.preventDefault(),"yes"==$(e.target).data("ask")?alertify.confirm("Any unsaved changes will be lost.",()=>{$(e.target).closest(".csModal").fadeOut(300),$("body").css("overflow-y","auto"),$("#ui-datepicker-div").remove(),$(".jsMsModal").remove()}).set("labels",{ok:"LEAVE",cancel:"NO, I WILL STAY"}).set("title","Notice!"):($(e.target).closest(".csModal").fadeOut(300),$("body").css("overflow-y","auto"),$(".jsMsModal").remove(),$("#ui-datepicker-div").remove())}),window._ml=window.ml=function(e,t,a){t=void 0===t?".jsIPLoader":`.jsIPLoader[data-page="${t}"]`,void 0!==o&&document.getElementsByClassName("csModalBody").length&&(document.getElementsByClassName("csModalBody")[0].scrollTop=0),void 0!==o&&e&&$(".jsIPLoader").height($(`#${o}Body`).height()+r),void 0===e||!1===e?$(t).hide():$(t).show(),void 0!==a&&$(".jsIPLoaderText").html(a),e||$(".jsIPLoaderText").html("Please wait, while we are generating a preview.")},window.Model=window.Modal=function(e,t){var a=`
			<!-- Custom Modal -->
			<div class="csModal jsMsModal" id="${e.Id}">
				<div class="${e.Cl||"container"}">
					<div class="csModalHeader">
						<h3 class="csModalHeaderTitle">
							<span>${e.Title}</span>
							<span class="csModalButtonWrap">
							${void 0!==e.Buttons&&0!==e.Buttons.length?e.Buttons.join(""):""}
								<button class="btn btn-black btn-cancel csW jsModalCancel" ${void 0===e.Ask?"":'data-ask="no"'} title="Close this window">Cancel</button>
							</span>
							<div class="clearfix"></div>
						</h3>
					</div>
					<div class="csModalBody">
						<div class="csIPLoader jsIPLoader" data-page="${e.Loader}">
							<div class="csIPLoaderBox">
								<i class="fa fa-circle-o-notch fa-spin" aria-hidden="true"></i><br><br>
								<br>
								<span class="jsIPLoaderText">Please wait while we process your request.</span>
							</div>
						</div>
						${e.Body}
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
			`;o=e.Id,r=$(`#${e.Id} .csModalHeader`).height()+50,$(".jsMsModal").remove(),$("#"+e.Id).remove(),$("body").append(a),$("#"+e.Id).fadeIn(300),$("body").css("overflow-y","hidden"),$(`#${e.Id} .csModalBody`).css("top",r),void 0!==t&&t()}}(),$(function(){let r=null;const t="jsModalPage",n=t+"Loader",s=t+"Body";$(document).on("click",".jsEmployeeAvailability",function(e){e.preventDefault(),$(this).data("eid");var e="Add unavailability",a="add_unavailability_shift",o=function(e){ml(!1,n),$('[name="shift_date"]').val(moment(date,"YYYY-MM-DD").format("MM/DD/YYYY")),$(".jsTimeField").timepicker({timeFormat:"h:mm p",dynamic:!1,dropdown:!1,scrollbar:!1}),validatorRef=$("#jsPageCreateSingleShiftForm").validate({rules:{shift_employee:{required:!0},shift_date:{required:!0},start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){return processCallWithoutContentType(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/single/create",function(e){_success(e.msg,function(){window.location.reload()})})}})};Modal({Id:t,Title:e,Body:'<div id="'+s+'"></div>',Loader:n},function(){var e=a,t=o;null!==r&&r.abort(),r=$.ajax({url:baseUrl("settings/page/"+e),method:"GET"}).always(function(){r=null}).fail(handleErrorResponse).done(function(e){$("#"+s).html(e.view),t(e)})})})}),$(function(){const n=getSearchParam("mode")||"month";function e(){let e="";var t;return e="month"===n?(t=getSearchParam("year")||moment().format("YYYY"),(getSearchParam("month")||moment().format("MM"))+"/01/"+t):getSearchParam("start_date")||moment().weekday(1).format("MM/DD/YYYY")}$(".jsWeekDaySelect").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:e(),locale:{format:"MM/DD/YYYY"},isInvalidDate:function(e){return"month"===n?"01"!==e.format("DD"):1!==e.day()}}),$(".jsWeekDaySelect").on("apply.daterangepicker",function(e,t){var a=("month"===n?t.startDate.clone().startOf("month"):t.startDate.clone()).format("MM/DD/YYYY");let o=0;o="week"===n?6:"two_week"===n?13:t.startDate.endOf("month").format("MM/DD/YYYY");var r=t.startDate.add(o,"days").format("MM/DD/YYYY");if("month"==n)return window.location.href=baseUrl("shifts/my?mode="+n+"&year="+t.startDate.clone().format("YYYY")+"&month="+t.startDate.clone().format("MM"));window.location.href=baseUrl("shifts/my?mode="+n+"&start_date="+a+"&end_date="+r)}),$(".schedule-employee-row").map(function(){$(".schedule-column-"+$(this).data("id")).height($(this).height())}),$("#shift_date_from").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:e(),locale:{format:"MM/DD/YYYY"}},function(e,t,a){$("#shift_date_to").data("daterangepicker").setStartDate(e)}),$("#shift_date_to").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:function(e){let t="";var a;return t="week"===n?getSearchParam("end_date")||moment(e,"MM/DD/YYYY").endOf("week").add(1,"day").format("MM/DD/YYYY"):"two_week"===n?getSearchParam("end_date")||moment(e,"MM/DD/YYYY").add(2,"week").subtract(1,"days").format("MM/DD/YYYY"):(e=getSearchParam("year")||moment().format("YYYY"),a=getSearchParam("month")||moment().format("MM"),moment(e+"-"+a+"-01").endOf("month").format("MM/DD/YYYY"))}(),locale:{format:"MM/DD/YYYY"}}),$(".jsNavigateRightMy").click(function(e){e.preventDefault();var e=$(".jsWeekDaySelect").data("daterangepicker").startDate;let t="",a=1;return t="week"===n?e.clone().add(1,"week"):"two_week"===n?(a=2,e.clone().add(2,"week")):e.clone().endOf("month"),"month"!==n?window.location.href=baseUrl("shifts/my?mode="+n+"&start_date="+t.clone().format("MM/DD/YYYY")+"&end_date="+t.clone().add(a,"week").subtract(1,"day").format("MM/DD/YYYY")):(e=t.clone().add(1,"month"),window.location.href=baseUrl("shifts/my?mode="+n+"&year="+e.clone().format("YYYY")+"&month="+e.clone().format("MM")))}),$(".jsNavigateLeftMy").click(function(e){e.preventDefault();var e=$(".jsWeekDaySelect").data("daterangepicker").startDate;return"month"!==n?window.location.href=baseUrl("shifts/my?mode="+n+"&start_date="+e.clone().subtract("week"===n?1:2,"week").format("MM/DD/YYYY")+"&end_date="+e.clone().subtract(1,"day").format("MM/DD/YYYY")):(e=e.clone().subtract(1,"month"),window.location.href=baseUrl("shifts/my?mode="+n+"&year="+e.clone().format("YYYY")+"&month="+e.clone().format("MM")))}),$(".jsFilterBtn").click(function(e){e.preventDefault(),$(".jsFilterRow").toggleClass("hidden")}),$(".jsFilterResetBtn").click(function(e){return e.preventDefault(),window.location.href=baseUrl("shifts/my?mode=month")}),$(".jsFilterApplyBtn").click(function(e){e.preventDefault();var e=$("#start_date").val(),t=$("#end_date").val();return e?t?window.location.href=baseUrl("shifts/my?mode=week&start_date="+e+"&end_date="+t):_error("Please select a end date."):_error("Please select a start date.")}),getSearchParam("start_date")&&$(".jsFilterBtn").trigger("click")});
