$(function(){let l=null,o=null;const t="jsModalPage",r=t+"Loader",c=t+"Body",f=getSearchParam("mode")||"month";function a(e,n,s,i){Modal({Id:t,Title:e,Body:'<div id="'+c+'"></div>',Loader:r},function(){var e=n,t=s,a=i;null!==l&&l.abort(),l=$.ajax({url:baseUrl("settings/page/"+e+"/"+t),method:"GET"}).always(function(){l=null}).fail(handleErrorResponse).done(function(e){$("#"+c).html(e.view),a(e)})})}function s(t,a,n,s){if(null===l){let e;a&&(e=callButtonHook(a,!0)),l=$.ajax({url:baseUrl(n),method:"POST",data:t,processData:!1,contentType:!1}).always(function(){a&&callButtonHook(e,!1),l=null}).fail(handleErrorResponse).done(function(e){return o?.destroy(),s(e)})}}function u(){let e="";var t;return e="month"===f?(t=getSearchParam("year")||moment().format("YYYY"),(getSearchParam("month")||moment().format("MM"))+"/01/"+t):getSearchParam("start_date")||moment().weekday(1).format("MM/DD/YYYY")}function d(e){let t="";var a;return t="week"===f?getSearchParam("end_date")||moment(e,"MM/DD/YYYY").endOf("week").add(1,"day").format("MM/DD/YYYY"):"two_week"===f?getSearchParam("end_date")||moment(e,"MM/DD/YYYY").add(2,"week").subtract(1,"days").format("MM/DD/YYYY"):(e=getSearchParam("year")||moment().format("YYYY"),a=getSearchParam("month")||moment().format("MM"),moment(e+"-"+a+"-01").endOf("month").format("MM/DD/YYYY"))}function n(){$(".jsTimeField").timepicker({timeFormat:"h:mm p",dynamic:!1,dropdown:!1,scrollbar:!1})}function i(){$("#shift_date_from").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:u(),locale:{format:"MM/DD/YYYY"}}),$("#shift_date_to").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:d(),locale:{format:"MM/DD/YYYY"}})}$(".jsWeekDaySelect").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:u(),locale:{format:"MM/DD/YYYY"},isInvalidDate:function(e){return"month"===f?"01"!==e.format("DD"):1!==e.day()}}),$(".jsWeekDaySelect").on("apply.daterangepicker",function(e,t){var a=("month"===f?t.startDate.clone().startOf("month"):t.startDate.clone()).format("MM/DD/YYYY");let n=0;n="week"===f?6:"two_week"===f?13:t.startDate.endOf("month").format("MM/DD/YYYY");var s=t.startDate.add(n,"days").format("MM/DD/YYYY");if("month"==f)return window.location.href=baseUrl("settings/shifts/manage?mode="+f+"&year="+t.startDate.clone().format("YYYY")+"&month="+t.startDate.clone().format("MM"));window.location.href=baseUrl("settings/shifts/manage?mode="+f+"&start_date="+a+"&end_date="+s)}),$(".jsNavigateLeft").click(function(e){e.preventDefault();let t="";""!=filterTeam&&(t="&employees="+filterEmployeesSid+"&team="+filterTeam+"&jobtitle="+filterJobtitle);var e=$(".jsWeekDaySelect").data("daterangepicker").startDate;return"month"!==f?window.location.href=baseUrl("settings/shifts/manage?mode="+f+"&start_date="+e.clone().subtract("week"===f?1:2,"week").format("MM/DD/YYYY")+"&end_date="+e.clone().subtract(1,"day").format("MM/DD/YYYY")+t):(e=e.clone().subtract(1,"month"),window.location.href=baseUrl("settings/shifts/manage?mode="+f+"&year="+e.clone().format("YYYY")+"&month="+e.clone().format("MM")+t))}),$(".jsNavigateRight").click(function(e){e.preventDefault();let t="";""!=filterTeam&&(t="&employees="+filterEmployeesSid+"&team="+filterTeam+"&jobtitle="+filterJobtitle);var e=$(".jsWeekDaySelect").data("daterangepicker").startDate;let a="",n=1;return a="week"===f?e.clone().add(1,"week"):"two_week"===f?(n=2,e.clone().add(2,"week")):e.clone().endOf("month"),"month"!==f?window.location.href=baseUrl("settings/shifts/manage?mode="+f+"&start_date="+a.clone().format("MM/DD/YYYY")+t+"&end_date="+a.clone().add(n,"week").subtract(1,"day").format("MM/DD/YYYY")):(e=a.clone().add(1,"month"),window.location.href=baseUrl("settings/shifts/manage?mode="+f+"&year="+e.clone().format("YYYY")+"&month="+e.clone().format("MM")+t))}),$(".schedule-employee-row").map(function(){$(".schedule-column-"+$(this).data("id")).height($(this).height())}),$(".schedule-column-clickable").click(function(e){var t;e.preventDefault(),e=$(this).data("eid"),t=$(this).closest(".schedule-column-container").data("date"),a("Create Shift","create_single_shift",e,function(e){ml(!1,r),$('[name="shift_date"]').val(moment(t,"YYYY-MM-DD").format("MM/DD/YYYY")),n(),o=$("#jsPageCreateSingleShiftForm").validate({rules:{shift_employee:{required:!0},shift_date:{required:!0},start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){return s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/single/create",function(e){0!=e.shiftid?p(e.shiftid,e.shiftdate):_success(e.msg,function(){window.location.reload()})})}})})}),$(".jsEmployeesShifts").click(function(e){e.preventDefault(),a("Create Shift","create_multi_shift",0,function(){ml(!1,r),n(),i(),$(".jsSelectAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!0)}),$(".jsRemoveAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!1)}),o=$("#jsPageCreateSingleShiftForm").validate({rules:{start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){$(e).serializeArray();const t={start_date:$("#shift_date_from").val(),end_date:$("#shift_date_to").val(),employees:[]};return $(".jsPageApplyTemplateEmployees:checked").map(function(){t.employees.push($(this).val())}),t.start_date.length?t.end_date.length?t.employees.length?void s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/multyshift/apply",function(e){let a="";0<Object.keys(e.list).length&&$.each(e.list,function(e,t){a=(a=(a+="<p>")+$('.jsPageApplyTemplateEmployees[value="'+e+'"]').parent().text().trim())+" has already shift on the following dates;</p>",t.dates.map(function(e){a+="<span>"+moment(e,"YYYY-MM-DD").format("MM/DD/YYYY")+"</span>, "}),a+="<br /><br />"}),_success(e.msg+a,function(){window.location.href=baseUrl("settings/shifts/manage"+window.location.search)})}):_error("Please select at least one employee."):_error("Please select To Date."):_error("Please select From Date.")}})})}),$(".jsEmployeeShiftsDelete").click(function(e){e.preventDefault(),a("Delete Shifts","delete_multi_shift",0,function(){ml(!1,r),i(),$(".jsSelectAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!0)}),$(".jsRemoveAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!1)}),o=$("#jsPageCreateSingleShiftForm").validate({submitHandler:function(e){$(e).serializeArray();const t={start_date:$("#shift_date_from").val(),end_date:$("#shift_date_to").val(),employees:[]};return $(".jsPageApplyTemplateEmployees:checked").map(function(){t.employees.push($(this).val())}),t.start_date.length?t.end_date.length?t.employees.length?void alertify.confirm("Are You Sure?","Are you sure want to delete shifts?",function(){s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/multyshift/delete",function(e){_success(e.msg,function(){window.location.href=baseUrl("settings/shifts/manage"+window.location.search)})})},function(){}):_error("Please select at least one employee."):_error("Please select To Date."):_error("Please select From Date.")}})})}),$(".jsEmployeeShiftsCopy").click(function(e){a("Copy Shifts","copy_shift",0,function(){ml(!1,r),$("#last_shift_date_from").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:u(),locale:{format:"MM/DD/YYYY"}}),$("#last_shift_date_to").daterangepicker({opens:"center",singleDatePicker:!0,showDropdowns:!0,autoApply:!0,startDate:d(),locale:{format:"MM/DD/YYYY"}}),i(),$(".jsSelectAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!0)}),$(".jsRemoveAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!1)}),o=$("#jsPageCreateSingleShiftForm").validate({submitHandler:function(e){$(e).serializeArray();const t={last_start_date:$("#shift_date_from").val(),last_end_date:$("#shift_date_to").val(),start_date:$("#shift_date_from").val(),end_date:$("#shift_date_to").val(),employees:[]};return $(".jsPageApplyTemplateEmployees:checked").map(function(){t.employees.push($(this).val())}),t.last_start_date.length?t.last_end_date.length?t.start_date.length?t.end_date.length?t.employees.length?void s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/multyshift/copy",function(e){let a="";0<Object.keys(e.list).length&&$.each(e.list,function(e,t){a=(a=(a+="<p>")+$('.jsPageApplyTemplateEmployees[value="'+e+'"]').parent().text().trim())+" has already shift on the following dates;</p>",t.dates.map(function(e){a+="<span>"+moment(e,"YYYY-MM-DD").format("MM/DD/YYYY")+"</span>, "}),a+="<br /><br />"}),_success(e.msg+a,function(){window.location.href=baseUrl("settings/shifts/manage"+window.location.search)})}):_error("Please select at least one employee."):_error("Please select To Date."):_error("Please select From Date."):_error("Please select To Date."):_error("Please select From Date.")}})})}),$(".schedule-item").click(function(e){e.preventDefault(),e.stopPropagation(),a("Edit Shift","edit_single_shift",$(this).data("id"),function(e){ml(!1,r),n(),o=$("#jsPageCreateSingleShiftForm").validate({rules:{shift_employee:{required:!0},shift_date:{required:!0},start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){return s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/single/create",function(e){_success(e.msg,function(){window.location.reload()})})}})})}),$(".jsApplyTemplate").click(function(e){e.preventDefault(),a("Apply shift template","apply_shift_templates",0,function(){ml(!1,r),$(".jsSelectScheduleTemplate").click(function(e){e.preventDefault(),$(".jsSelectScheduleTemplate").removeClass("active"),$(this).addClass("active")}),$(".jsSelectAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!0)}),$(".jsRemoveAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!1)}),$("#jsPageApplyShiftTemplateForm").submit(function(e){e.preventDefault();const t={start_date:u(),schedule_id:$(".jsSelectScheduleTemplate.active").data("id"),employees:[]};if(t.end_date=d(t.start_date),$(".jsPageApplyTemplateEmployees:checked").map(function(){t.employees.push($(this).val())}),!t.schedule_id)return _error("Please select a schedule.");if(!t.employees.length)return _error("Please select at least one employee.");var e=t,a=$(".jsPageApplyShiftTemplateBtn"),n="settings/shifts/template/apply",s=function(e){let a="";0<Object.keys(e.list).length&&$.each(e.list,function(e,t){a=(a=(a+="<p>")+$('.jsPageApplyTemplateEmployees[value="'+e+'"]').parent().text().trim())+" has already shift on the following dates;</p>",t.dates.map(function(e){a+="<span>"+moment(e,"YYYY-MM-DD").format("MM/DD/YYYY")+"</span>, "}),a+="<br /><br />"}),_success(e.msg+a,function(){window.location.href=baseUrl("settings/shifts/manage"+window.location.search)})};if(null===l){const i=callButtonHook(a,!0);l=$.ajax({url:baseUrl(n),method:"POST",data:e,processData:!0}).always(function(){callButtonHook(i,!1),l=null}).fail(handleErrorResponse).done(function(e){return o?.destroy(),s(e)})}})})}),$(".schedule-item-openshift").click(function(e){e.preventDefault(),e.stopPropagation(),a("","edit_open_single_shift",$(this).data("id"),function(e){ml(!1,r),n(),o=$("#jsPageCreateSingleShiftForm").validate({rules:{shift_date:{required:!0},start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){return s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/opensingle/create",function(e){_success(e.msg,function(){window.location.reload()})})}})})}),$(document).on("click",".jsAddBreak",function(e){e.preventDefault();e=getRandomCode();$(".jsBreakContainer").append(function(e,t){let a="";a+="<option></option>",breaksObject.map(function(e){a+='<option value="'+e.break_name+'" data-duration="'+e.break_duration+'" '+(void 0!==t&&t.break===e.break_name?"selected":"")+">"+e.break_name+" ("+e.break_type+")</option>"});return'<div class="row jsBreakRow" data-key="'+e+'">    <br> '+'     <div class="col-sm-5">        <label class="text-medium">'+'            Break             <strong class="text-red">*</strong>'+'         </label>         <select name="breaks['+e+'][break]" class="form-control jsBreakSelect">'+a+"         </select>     </div>"+'     <div class="col-sm-3">         <label class="text-medium">'+'             Duration              <strong class="text-red">*</strong>'+'         </label>         <div class="input-group">'+'             <input type="number" class="form-control jsDuration" name="breaks['+e+'][duration]" value="'+(t?.duration||"")+'" />             <div class="input-group-addon">mins</div>'+"         </div>     </div>"+'     <div class="col-sm-3">         <label class="text-medium">'+"             Start TIme          </label>"+'         <input type="text" class="form-control jsTimeField jsStartTime" placeholder="HH:MM" name="breaks['+e+'][start_time]"value="'+(t?.start_time?moment(t.start_time,"HH:mm").format("h:mm a"):"")+'" />'+'     </div>     <div class="col-sm-1">'+'         <br>         <button class="btn btn-red jsDeleteBreakRow" title="Delete this break" type="button">'+'             <i class="fa fa-trash" style="margin-right: 0"></i>         </button>'+"     </div></div>"}(e)),$('[name="breaks['+e+'][break]"]').rules("add",{required:!0}),$('[name="breaks['+e+'][duration]"]').rules("add",{required:!0,number:!0,digits:!0,greaterThanZero:!0}),n()}),$(document).on("click",".jsMarkAsDayOff",function(e){e.preventDefault();const t=$(this).data("id");alertify.confirm("Are You Sure?","Are you sure want to delete shifts?",function(){var e=new FormData;e.append("id",t),s(e,"","settings/shifts/singleshift/delete",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}),$(document).on("click",".jsDeleteBreakRow",function(e){e.preventDefault();e=$(this).closest(".jsBreakRow").data("key");$('.jsBreakRow[data-key="'+e+'"]').remove(),$('[name="breaks['+e+'][break]"]').rules("remove"),$('[name="breaks['+e+'][duration]"]').rules("remove")}),$(document).on("change",".jsBreakSelect",function(){var e=$(this).closest(".jsBreakRow").data("key");$('[name="breaks['+e+'][duration]"]').val($(this).find("option:selected").data("duration"))}),$(".schedule-column-clickable-openshift").click(function(e){var t;e.preventDefault(),e=$(this).data("eid"),t=$(this).closest(".schedule-column-container").data("date"),a("","create_single_open_shift",e,function(e){ml(!1,r),$('[name="shift_date"]').val(moment(t,"YYYY-MM-DD").format("MM/DD/YYYY")),n(),o=$("#jsPageCreateSingleShiftForm").validate({rules:{shift_date:{required:!0},start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){return s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/opensingle/create",function(e){0!=e.shiftid?p(e.shiftid,e.shiftdate):_success(e.msg,function(){window.location.reload()})})}})})}),$(document).on("click",".jsAdminRejectOpenShiftRequest",function(e){e.preventDefault();let t=[],a=$(this).data("shiftid"),n=$(this).data("toemployeeid");alertify.confirm("Are You Sure?","Are you sure want to reject request?",function(){var e=new FormData;t.push(a),e.append("shiftids",t),e.append("toEmployeeId",n),s(e,"","settings/shifts/claimshiftsreject",function(e){_success(e.msg,function(){$("#rowId"+a).remove()})})},function(){})}),$(document).on("click",".jsAdminRejectOpenShiftRequests",function(e){e.preventDefault();let t=[];$(".my_checkbox:checked").each(function(){t.push($(this).val())}),0<t.length?alertify.confirm("Are You Sure?","Are you sure want to reject requests?",function(){var e=new FormData;e.append("shiftids",t),s(e,"","settings/shifts/claimshiftsreject",function(e){_success(e.msg,function(){t.forEach((e,t)=>{$("#rowId"+e).remove()})})})},function(){}):alertify.alert("Error! Not selected","Please Select at-least one shift ")}),$(document).on("click",".jsApproveOpenShiftRequest",function(e){e.preventDefault();let t=[],a=$(this).data("shiftid"),n=$(this).data("toemployeeid");$(this).data("toemployeeid");alertify.confirm("Are You Sure?","Are you sure want to approve request?",function(){var e=new FormData;t.push(a),e.append("shiftids",t),e.append("toEmployeeId",n),s(e,"","settings/shifts/claimshiftsapprove",function(e){_success(e.msg,function(){null==e.error&&window.location.reload()})})},function(){})}),$(document).on("click","#check_all",function(e){$("#check_all").is(":checked")?$(".my_checkbox:checkbox").each(function(){this.checked=!0}):$(".my_checkbox:checkbox").each(function(){this.checked=!1})}),$(function(){$(".expander").on("click",function(){$("#TableData").toggle()})}),1==filterToggle&&$("#TableData").toggle(),$(".js-filter-employee").select2(),$(".js-filter-jobtitle").select2(),$(".jsSelect2").select2(),$(".js-apply-filter-btn").click(function(e){e.preventDefault();var e=$(".jsWeekDaySelect").data("daterangepicker").startDate,t=u(),a=d(e);let n="";var s=e.clone().format("YYYY"),e=e.clone().format("MM"),i=$(".js-filter-employee").val(),l=$(".jsSelect2").val(),o=$(".js-filter-jobtitle").val();return n=getSearchParam("year")?"settings/shifts/manage?mode="+f+"&year="+s+"&month="+e+"&employees="+i+"&team="+l+"&jobtitle="+o:getSearchParam("start_date")?"settings/shifts/manage?mode="+f+"&start_date="+t+"&end_date="+a+"&employees="+i+"&team="+l+"&jobtitle="+o:"settings/shifts/manage?mode="+f+"&employees="+i+"&team="+l+"&jobtitle="+o,window.location.href=baseUrl(n)}),$(".js-reset-filter-btn").click(function(e){e.preventDefault();var e=$(".jsWeekDaySelect").data("daterangepicker").startDate,t=u(),a=d(e);let n="";var s=e.clone().format("YYYY"),e=e.clone().format("MM");$(".js-filter-employee").val(),$(".jsSelect2").val();return n=getSearchParam("year")?"settings/shifts/manage?mode="+f+"&year="+s+"&month="+e:getSearchParam("start_date")?"settings/shifts/manage?mode="+f+"&start_date="+t+"&end_date="+a:"settings/shifts/manage?mode="+f,window.location.href=baseUrl(n)});var e=filterJobtitle.split(",");function m(e){var t=new FormData;t.append("shiftId",publishUnpublishSingleShiftId),t.append("publishStatus",publishUnpublishSingleShiftStatus),t.append("sendEmail",e),s(t,"","settings/shifts/singleshift/public-status",function(e){_success(e.msg,function(){window.location.reload()})})}function p(e,t){a("Send Shift","send_shift",0,function(){ml(!1,r),$(".jsSelect2").select2(),$(".js-filter-jobtitle").select2(),$("#jssendShiftId").val(e),$("#jssendShiftDate").val(t),$(".jsSelectAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!0)}),$(".jsRemoveAll").click(function(e){e.preventDefault(),$(".jsPageApplyTemplateEmployees").prop("checked",!1)}),o=$("#jsPageCreateSingleShiftForm").validate({rules:{start_time:{required:!0,timeIn12Format:!0},end_time:{required:!0,timeIn12Format:!0}},errorPlacement:function(e,t){($(t).parent().hasClass("input-group")?$(t).parent():$(t)).after(e)},submitHandler:function(e){$(e).serializeArray();const t={start_date:$("#shift_date_from").val(),end_date:$("#shift_date_to").val(),employees:[]};return $(".jsPageApplyTemplateEmployees:checked").map(function(){t.employees.push($(this).val())}),t.start_date.length?t.end_date.length?t.employees.length?void s(formArrayToObj($(e).serializeArray()),$(".jsPageCreateSingleShiftBtn"),"settings/shifts/multyshift/apply",function(e){let a="";0<Object.keys(e.list).length&&$.each(e.list,function(e,t){a=(a=(a+="<p>")+$('.jsPageApplyTemplateEmployees[value="'+e+'"]').parent().text().trim())+" has already shift on the following dates;</p>",t.dates.map(function(e){a+="<span>"+moment(e,"YYYY-MM-DD").format("MM/DD/YYYY")+"</span>, "}),a+="<br /><br />"}),_success(e.msg+a,function(){window.location.href=baseUrl("settings/shifts/manage"+window.location.search)})}):_error("Please select at least one employee."):_error("Please select To Date."):_error("Please select From Date.")}})})}$("#jobtitleId").val(e),$("#jobtitleId").trigger("change"),$(document).on("click",".jsPublishSingleShiftBtn",function(e){e.preventDefault(),publishUnpublishSingleShiftId=$(this).data("id"),publishUnpublishSingleShiftStatus=$(this).data("publish");{let e="";e=1==publishUnpublishSingleShiftStatus?(publishUnpublishSingleShiftStatus=0," Unpublish "):(publishUnpublishSingleShiftStatus=1," Publish "),alertify.publishSingleShift().setHeader("Confirmation"),alertify.publishSingleShift().set("labels",{ok:e,PublishAndSendEmails:e}),alertify.publishSingleShift("Are you sure want to "+e+"  this shift?").set({onok:function(){m(0)},onPublishAndSendEmails:function(){m(1)},labels:{}})}}),$(document).on("click",".jsUnpublishSingleShiftBtn",function(e){e.preventDefault(),publishUnpublishSingleShiftId=$(this).data("id"),publishUnpublishSingleShiftStatus=$(this).data("publish"),_confirm("Do you really want to unpublish the shift?",function(){var e,t;e=publishUnpublishSingleShiftId,(t=new FormData).append("shiftId",e),t.append("publishStatus",0),t.append("sendEmail",1),s(t,"","settings/shifts/singleshift/public-status",function(e){_success(e.msg,function(){window.location.reload()})})})}),$(document).on("click",".jsPublishSingleShiftBtnOk,.jsUnpublishSingleShiftBtnOkEmail",function(e){e.preventDefault();let t="",a=$(this).data("sendemail");t=1==publishUnpublishSingleShiftStatus?(publishUnpublishSingleShiftStatus=0," Unpublish "):(publishUnpublishSingleShiftStatus=1," Publish "),alertify.confirm("Are You Sure?","Are you sure want to "+t+" the shift?",function(){var e=new FormData;e.append("shiftId",publishUnpublishSingleShiftId),e.append("publishStatus",publishUnpublishSingleShiftStatus),e.append("sendEmail",a),s(e,"","settings/shifts/singleshift/public-status",function(e){_success(e.msg,function(){window.location.reload()})})},function(){})}),$(document).on("click",".jsModalCancel2",function(e){alertify.genericDialog().close()}),$(document).on("click",".jsPublishMultiShiftBtn",function(e){e.preventDefault(),publishUnpublishSingleShiftId=$(this).data("ids"),allShiftsId=$(this).data("shiftsids"),alertify.publishShift().setHeader("Confirmation"),alertify.publishShift("Are you sure want to publish shifts?").set({onok:function(){var e=new FormData;e.append("shiftIds",publishUnpublishSingleShiftId),e.append("publishStatus",1),e.append("sendEmail",0),s(e,"","settings/shifts/multishift/public-status",function(e){_success(e.msg,function(){window.location.reload()})})},onPublishAndSendEmails:function(){var e="";e+=' <div class="hr-fields-wrap"> <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12"><label class="control control--radio " style="margin-left: -20px;">Send Email To Effected Employees<input type="radio" name="shifts_email_selection" class="shiftemailselection" value="effected" checked>    <div class="control__indicator"></div>   </label></div> <div class="hr-fields-wrap"> <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12"><label class="control control--radio " style="margin-left: -20px;">Send Email To All Employees<input type="radio" name="shifts_email_selection" class="shiftemailselection" value="all">    <div class="control__indicator"></div>   </label></div><br>   </div> <br>',alertify.ShiftEmailOption(e).set({"title ":"Info",onok:function(){var e=$("input[name='shifts_email_selection']:checked").val(),t=new FormData;t.append("shiftIds",publishUnpublishSingleShiftId),t.append("publishStatus",1),t.append("sendEmail",1),t.append("sendShiftsEmailOption",e),t.append("allShiftsId",allShiftsId),s(t,"","settings/shifts/multishift/public-status",function(e){_success(e.msg,function(){window.location.reload()})})},oncancel:function(){},labels:{ok:"Send"}})},oncancel:function(){},labels:{ok:"Publish"}})}),alertify.dialog("publishShift",function(){return{setup:function(){var e,t=alertify.confirm().settings;for(e in t)this.settings[e]=t[e];var a=alertify.confirm().setup();return a.buttons.push({text:"Publish & Send Emails",key:67,scope:"auxiliary",className:"ajs-ok"}),a},settings:{onPublishAndSendEmails:null},callback:function(e){2==e.index?"function"==typeof this.get("onPublishAndSendEmails")&&"undefined"!=typeof(returnValue=this.get("onPublishAndSendEmails").call(this,e))&&(e.cancel=!returnValue):alertify.confirm().callback.call(this,e)}}},!1,"confirm"),alertify.dialog("ShiftEmailOption",function(){},!1,"confirm"),alertify.dialog("publishSingleShift",function(){return{setup:function(){var e,t=alertify.confirm().settings;for(e in t)this.settings[e]=t[e];var a=alertify.confirm().setup();return a.buttons.push({text:"Publish & Send Email",key:67,scope:"auxiliary",className:"ajs-ok"}),a},settings:{onPublishAndSendEmails:null},callback:function(e){2==e.index?"function"==typeof this.get("onPublishAndSendEmails")&&"undefined"!=typeof(returnValue=this.get("onPublishAndSendEmails").call(this,e))&&(e.cancel=!returnValue):alertify.confirm().callback.call(this,e)}}},!1,"confirm"),$("body").on("click",".jsPageCreateSingleShiftAndSendBtn",function(){$("<input>").attr({name:"create_and_send_shift",id:"hiddenId",type:"hidden",value:1}).appendTo("form"),$("#jsPageCreateSingleShiftForm").submit()}),$("body").on("click",".js-apply-filter",function(e){e.preventDefault();var t=$("#teamIds").val(),a=$("#jobtitleIds").val(),n=$("#jssendShiftDate").val(),e=(ml(!1,r),e.preventDefault(),{departmentId:t,job_titles:a,shift_date:n});const s=callButtonHook($(".js-apply-filter"),!0);url="settings/shifts/get_employee_list",l=$.ajax({url:baseUrl(url),method:"POST",data:e,processData:!0}).always(function(){callButtonHook(s,!1),l=null}).fail(handleErrorResponse).done(function(e){let a="";$.each(e.list,function(e,t){a=(a=(a=(a+='<div class="col-sm-6"><label class="control control--checkbox">')+'<input type="checkbox" class="jsPageApplyTemplateEmployees" value="'+t.userId+'" name="employees[]" />')+t.employee_name+'<div class="control__indicator"></div>')+"</label></div>"}),$("#employeeList").html(a)})}),$("body").on("click",".js-reset-filter",function(e){e.preventDefault(),$("#teamIds").select2("val","0"),$("#jobtitleIds").select2("val","all"),$("#employeeList").html("")}),$("body").on("click",".jsSendShiftNotification",function(e){e.preventDefault();const t={shift_id:$("#jssendShiftId").val(),employees:[]};if($(".jsPageApplyTemplateEmployees:checked").map(function(){t.employees.push($(this).val())}),!t.employees.length)return _error("Please select at least one employee.");const a=callButtonHook($(".jsSendShiftNotification"),!0);url="settings/shifts/send_shift",l=$.ajax({url:baseUrl(url),method:"POST",data:t,processData:!0}).always(function(){callButtonHook(a,!1),l=null}).fail(handleErrorResponse).done(function(e){_success(e.msg,function(){window.location.href=baseUrl("settings/shifts/manage"+window.location.search)})})}),$("body").on("click",".jsPageSingleShifthistory",function(e){e.preventDefault(),a("Shift Histroy","shift_history",$(".jsPageSingleShifthistory").data("shiftid"),function(){ml(!1,r)})})});
