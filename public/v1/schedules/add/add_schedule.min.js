$(function(){let t=null;var e={showDropdowns:!0,singleDatePicker:!0,locale:{format:"MM/DD/YYYY"},minYear:2023,autoApply:!0};$('[name="first_pay_date"]').daterangepicker(e),$('[name="deadline_to_run_payroll"]').daterangepicker(e),$('[name="first_pay_period_end_date"]').daterangepicker(e);const d=$("#jsAddScheduleForm").validate({rules:{pay_frequency:{required:!0},first_pay_date:{required:!0,date:!0},deadline_to_run_payroll:{required:!0,date:!0},first_pay_period_end_date:{required:!0},status:{required:!0}},submitHandler:function(e){var e=function(e){const a={};return e?.map(function(e){a[e.name]=e.value.trim()}),a}($(e).serializeArray()),a=moment(e.first_pay_date,"MM/DD/YYYY"),r=moment(e.first_pay_period_end_date,"MM/DD/YYYY");if(a.format("YYYY")<moment().format("YYYY"))return d.showErrors({first_pay_date:"First pay day cannot be in a prior year."});if(r.diff(a,"days")<=-10)return d.showErrors({first_pay_date:"The end of the pay period may not be more than 10 days before the pay day."});{r=e;a=$(".jsAddScheduleBtn");if(null!==t)return!1;const n=callButtonHook(a,!0,!0);t=$.ajax({url:baseUrl("schedules"),method:"POST",data:r}).always(function(){t=null,callButtonHook(n,!1)}).fail(function(e){return _error(e.responseJSON.msg)}).done(function(e){return _success(e.msg,function(){window.location.href=baseUrl("schedules")})});return}}});$('[name="first_pay_date"]').change(function(){"Every week"!==$('[name="pay_frequency"]').val()&&"Every other week"!==$('[name="pay_frequency"]').val()||(null!==t&&t.abort(),t=$.ajax({url:baseUrl("schedules/deadline/"+moment($(this).val(),"MM/DD/YYYY").format("YYYY-MM-DD")),method:"get"}).always(function(){t=null}).fail(handleErrorResponse).done(function(e){$('[name="deadline_to_run_payroll"]').val(moment(e.deadlineDate,"YYYY-MM-DD").format("MM/DD/YYYY"))}))}),$('[name="pay_frequency"]').change(function(){$(".jsFrequency").addClass("hidden"),$('[name="day_1"]').rules("remove"),$('[name="day_2"]').rules("remove"),$('[name="deadline_to_run_payroll"]').rules("add",{required:!0,date:!0}),"Twice a month: Custom"===$(this).val()&&($(".jsFrequency").removeClass("hidden"),$('[name="day_1"]').rules("add",{required:!0}),$('[name="day_2"]').rules("add",{required:!0})),"Monthly"===$(this).val()&&($(".jsMonthlyFrequency").removeClass("hidden"),$('[name="day_1"]').rules("add",{required:!0})),"Every week"!==$(this).val()&&"Every other week"!==$(this).val()?$('[name="deadline_to_run_payroll"]').val(""):$('[name="first_pay_date"]').trigger("change")})});
