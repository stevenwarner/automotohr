!function(){let a,n=0;$(document).on("click",".jsModalCancel",e=>{e.preventDefault(),"yes"==$(e.target).data("ask")?alertify.confirm("Any unsaved changes will be lost.",()=>{$(e.target).closest(".csModal").fadeOut(300),$("body").css("overflow-y","auto"),$("#ui-datepicker-div").remove(),$(".jsMsModal").remove()}).set("labels",{ok:"LEAVE",cancel:"NO, I WILL STAY"}).set("title","Notice!"):($(e.target).closest(".csModal").fadeOut(300),$("body").css("overflow-y","auto"),$(".jsMsModal").remove(),$("#ui-datepicker-div").remove())}),window._ml=window.ml=function(e,t,o){t=void 0===t?".jsIPLoader":`.jsIPLoader[data-page="${t}"]`,void 0!==a&&document.getElementsByClassName("csModalBody").length&&(document.getElementsByClassName("csModalBody")[0].scrollTop=0),void 0!==a&&e&&$(".jsIPLoader").height($(`#${a}Body`).height()+n),void 0===e||!1===e?$(t).hide():$(t).show(),void 0!==o&&$(".jsIPLoaderText").html(o),e||$(".jsIPLoaderText").html("Please wait, while we are generating a preview.")},window.Model=window.Modal=function(e,t){var o=`
			<!-- Custom Modal -->
			<div class="csModal jsMsModal" id="${e.Id}">
				<div class="${e.Cl||"container"}">
					<div class="csModalHeader">
						<h3 class="csModalHeaderTitle">
							<span>${e.Title}</span>
							<span class="csModalButtonWrap">
							${void 0!==e.Buttons&&0!==e.Buttons.length?e.Buttons.join(""):""}
								<button class="btn btn-black btn-cancel csW jsModalCancel" ${void 0===e.Ask?"":'data-ask="no"'} title="Close this window">Cancel</button>
							</span>
							<div class="clearfix"></div>
						</h3>
					</div>
					<div class="csModalBody">
						<div class="csIPLoader jsIPLoader" data-page="${e.Loader}">
							<div class="csIPLoaderBox">
								<i class="fa fa-circle-o-notch fa-spin" aria-hidden="true"></i><br><br>
								<br>
								<span class="jsIPLoaderText">Please wait while we process your request.</span>
							</div>
						</div>
						${e.Body}
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
			`;a=e.Id,n=$(`#${e.Id} .csModalHeader`).height()+50,$(".jsMsModal").remove(),$("#"+e.Id).remove(),$("body").append(o),$("#"+e.Id).fadeIn(300),$("body").css("overflow-y","hidden"),$(`#${e.Id} .csModalBody`).css("top",n),void 0!==t&&t()}}(),String.prototype.verifyEmail=function(){return null!==this.match(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g)},String.prototype.isValidYoutubeLink=function(){return null!==this.match(/^(https?\:\/\/)?((www\.)?youtube\.com|youtu\.be)\/.+$/g)},String.prototype.isValidVimeoLink=function(){return null!==this.match(/^(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)$/gim)},String.prototype.isValidInteger=function(){return null!==this.match(/^[1-9]\d*$/g)};{function ml(e,t,o){e?($(".jsIPLoader[data-page='"+t+"']").show(),$(".jsIPLoader[data-page='"+t+"']").find(".jsIPLoaderText").html(o||"Please wait, while we are processing your request.")):($(".jsIPLoader[data-page='"+t+"']").hide(),$(".jsIPLoader[data-page='"+t+"']").find(".jsIPLoaderText").html("Please wait, while we are processing your request."))}}{function CB(){}}{function getErrorsStringFromArray(e,t){return"<strong><p>"+(t||"Please, resolve the following errors")+"</p></strong><br >"+e.join("<br />")}}{function getBrowserVersion(){var e,t=navigator.userAgent,o=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(o[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===o[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(o=o[2]?[o[1],o[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&o.splice(1,1,e[1]),o)}}{function generateBrowserAlert(){var e={chrome:55,edge:14,firefox:52,opera:42,safari:10.1,chromeandroid:55,firefoxandroid:52,operaandroid:42,safariios:10.3,samsumginternet:6},t=getBrowserVersion();if(e[t[0].toLowerCase()]&&t[1]<e[t[0].toLowerCase()])return alert("This module require '"+t[0]+"' with version greater or equal then '"+t[1]+"'.")}}{function uploadFile(o){return new Promise(function(t){var e=new FormData;e.append("file",o),$.ajax({url:apiURL+"uploader",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:e}).success(function(e){t(e)}).fail(function(e){t(e.responseText)})})}}{function uploadStream(e){return new Promise(function(t){$.ajax({url:apiURL+"uploader/stream",method:"POST",timeout:0,contentType:"application/json",data:JSON.stringify({stream:e})}).success(function(e){t(e)}).fail(function(){t({})})})}}"undefined"!=typeof $&&($(".jsFilterPanel").height($(document).height()),$(document).on("click",".jsFilterSectionBtn",function(e){e.preventDefault();e=$(this).data("key");$(".jsFilterSection[data-key='"+e+"']").removeClass("hidden")}),$(document).on("click",".jsFilterSectionHideBtn",function(e){e.preventDefault();e=$(this).data("key");$(".jsFilterSection[data-key='"+e+"']").addClass("hidden")}),$(document).on("click",".jsExpandAdminView",function(e){e.preventDefault(),$(this).toggleClass("btn-success"),$(".jsExpandContent").toggleClass("col-sm-12 col-md-12 col-lg-12 col-xs-12 col-lg-9 col-md-9 col-sm-9"),$(".jsExpandSideBar").toggleClass("hidden")}));{function handleErrorResponse(e){return 0==e.status?alertify.alert("Errors!","The connection to the server has been lost. Kindly reach out to the system administrator for assistance.",CB):404==e.status?_error("The requested route doesn't exists."):(e=e.responseJSON||JSON.parse(e.responseText),alertify.alert("Errors!",e.errors.join("<br />"),CB))}}{function getQuestionsFromArray(e,t){return"<strong><p>"+(t||"Please, provide the following question answer.")+"</p></strong><br >"+e.join("<br />")}}{function baseUrl(e=""){return window.location.origin+"/"+e}}{function callButtonHook(e,t=!0){if(t)return t={pointer:e,html:e.html()},e.html('<i class="fa fa-circle-o-notch fa-spin csW csF16" aria-hidden="true"></i>'),e.off("click"),t;e.pointer.html(e.html)}}{function _error(e){alertify.alert("Error!",e,CB).setHeader("Error!").set("labels",{ok:"Ok",cancel:"cancel"})}}{function _success(e,t=CB){alertify.alert("Success!",e,t).setHeader("Success!").set("labels",{ok:"Ok",cancel:"cancel"})}}{function _confirm(e,t){alertify.confirm(e,t,CB).setHeader("Confirm").set("labels",{ok:"Yes",cancel:"No"})}}{function getSegment(e){let t=window.location.pathname.split("/");return(t=t?.filter(function(e){return e?.trim()}))[e]}}{function getRandomCode(){return(new Date).getTime()+Math.floor(5e6*Math.random())}}$(function(){let o=0,a="jsCreatePartnerCompanyModal",n=null,i={checkRequirements:function(){null!==n&&n.abort();n=$.ajax({url:window.location.origin+"/payroll/company/"+o+"/requirements",method:"GET"}).success(function(){n=null,i.welcomeStep()}).fail(l)},welcomeStep:function(){if(null!==n)return!1;n=$.ajax({url:window.location.origin+"/payroll/cpc/1/"+o,method:"GET"}).success(function(e){if(n=null,$(`#${a}Body`).html(e.view),void 0!==e.onboard){if("terms"===e.onboard)return i.gustoTerms();window.location.reload()}_ml(!1,a+"Loader"),$(".jsPayrollLoadSelectEmployees").click(function(e){e.preventDefault(),_ml(!0,a+"Loader"),i.employeeListingStep()})}).fail(l)},employeeListingStep:function(){if(null!==n)return!1;n=$.ajax({url:window.location.origin+"/payroll/cpc/2/"+o,method:"GET"}).success(function(e){n=null,$(`#${a}Body`).html(e.view),_ml(!1,a+"Loader"),$(".jsPayrollLoadOnboard").click(function(e){e.preventDefault(),t=[],$(".jsEmployeesList:checked").map(function(){t.push($(this).val())}),t.length?(_ml(!0,a+"Loader"),i.adminStep()):alertify.alert("ERROR","Please select at least one employee.",CB)}),$(".jsBackToStep1").click(function(e){e.preventDefault(),_ml(!0,a+"Loader"),i.welcomeStep()})}).fail(l)},adminStep:function(){if(null!==n)return!1;n=$.ajax({url:window.location.origin+"/payroll/cpc/3/"+o,method:"GET"}).success(function(e){n=null,$(`#${a}Body`).html(e.view),_ml(!1,a+"Loader"),$(".jsPayrollSetAdmin").click(function(e){e.preventDefault(),null===n&&(n=$.ajax({url:window.location.origin+"/payroll/cpc/4/"+o,method:"GET"}).success(function(e){n=null,$(`#${a}Body`).html(e.view),_ml(!1,a+"Loader")}).fail(l))}),$(".jsBackToStep2").click(function(e){e.preventDefault(),_ml(!0,a+"Loader"),i.employeeListingStep()})}).fail(l)},createPartnerCompany:e},t=[];function e(){n=$.ajax({url:window.location.origin+"/payroll/cpc/7/"+o,method:"POST",data:{employees:t}}).success(function(){if(n=null,"undefined"==typeof gustoServiceAgreement)return window.location.reload();gustoServiceAgreement(o)}).fail(r)}function r(e){return _ml(!1,a+"Loader"),n=null,handleErrorResponse(e)}function l(e){return $(`#${a} .jsModalCancel`).trigger("click"),handleErrorResponse(e)}$(document).on("click",".jsModalCancel",function(){n=null}),$(document).on("click",".jsSelectAll",function(){$(".jsSingleEmployee").prop("checked",!0)}),$(document).on("click",".jsUnSelectAll",function(){$(".jsSingleEmployee").prop("checked",!1)}),$(".jsCreatePartnerCompanyBtn").click(function(e){if(e.preventDefault(),0===(o=parseInt($(this).data("cid"))))return alertify.alert("ERROR","Company code is missing.",CB);Modal({Id:a,Title:"",Loader:a+"Loader",Body:`<div id="${a}Body"></div>`},i.checkRequirements)}),$(document).on("click",".jsPayrollViewAdminDetails",function(e){e.preventDefault(),_ml(!0,a+"Loader"),n=$.ajax({url:window.location.origin+"/payroll/cpc/6/"+o,method:"GET"}).success(function(e){n=null,$(`#${a}Body`).html(e.view),_ml(!1,a+"Loader")}).fail(l)}),$(document).on("click",".jsPayrollSaveAdmin",function(e){e.preventDefault();var e={firstName:$(".jsAdminFirstName").val().trim(),lastName:$(".jsAdminLastName").val().trim(),email:$(".jsAdminEmailAddress").val().trim(),id:$(".jsAdminUserId").val().trim()},t=[];e.firstName||t.push('"First name" is missing.'),e.lastName||t.push('"Last name" is missing.'),e.email||t.push('"Email" is missing.'),e.email.verifyEmail()||t.push('"Email" is invalid.'),t.length?alertify.alert("ERROR",getErrorsStringFromArray(t),CB):(_ml(!0,a+"Loader"),n=$.ajax({url:window.location.origin+"/payroll/cpc/5/"+o,method:"POST",data:e}).success(function(){return n=null,_ml(!1,a+"Loader"),alertify.alert("SUCCESS","Congratulations! You have successfully added a payroll admin for the company.",function(){i.adminStep()})}).fail(r))}),$(document).on("click",".jsBackToStep3",function(e){e.preventDefault(),_ml(!0,a+"Loader"),i.adminStep()}),$(document).on("click",".jsCreatePartnerCompanyProcessBtn",function(e){e.preventDefault(),_ml(!0,a+"Loader","Please wait patiently while we set up the payroll system. This procedure may take a few minutes."),i.createPartnerCompany()}),$(document).on("change","#jsEmployeeChoose",function(){var e=$(this).val();0!=e&&(ml(!0,"jsCreateLoader"),e=e,ml(!0,"jsCreateLoader","Please wait, while we are generating view."),$.ajax({url:baseUrl("/payrolls/employees/"+e+"/get"),method:"GET"}).success(function(e){$(".jsAdminFirstName").val(e.first_name||""),$(".jsAdminLastName").val(e.last_name||""),$(".jsAdminEmailAddress").val(e.email||""),$(".jsAdminUserId").val(e.id||0)}).fail(function(e){return window.scrollTo(0,0),$(".jsErrorDiv").html(getErrorsStringFromArray((e.responseJSON||JSON.parse(e.responseText)).errors)).removeClass("hidden")}).always(function(){ml(!1,"jsCreateLoader")}))})});
