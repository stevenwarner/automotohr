$(function(){let n=0,i="jsAgreementModal",l=null;function r(e){if(0===(n=e))return alertify.alert("ERROR","Company code is missing.",CB);Modal({Id:i,Title:"Service Agreement",Loader:i+"Loader",Body:`<div id="${i}Body"></div>`},a)}function a(){l=$.ajax({url:window.location.origin+"/payrolls/agreement/"+n,method:"GET"}).success(function(e){l=null,$(`#${i}Body`).html(e.view),_ml(!1,i+"Loader")}).fail(e)}function o(e){return _ml(!1,i+"Loader"),l=null,handleErrorResponse(e)}function e(e){return $(`#${i} .jsModalCancel`).trigger("click"),handleErrorResponse(e)}$(document).on("click",".jsModalCancel",function(){l=null}),$(".jsServiceAgreement").click(function(e){e.preventDefault(),r(parseInt($(this).data("cid")))}),$(document).on("change","#jsTermsOfServiceEmail",function(){$("#jsTermsOfServiceReference").val($("#jsTermsOfServiceEmail option:selected").data("id"))}),$(document).on("click",".jsPayrollAgreeServiceTerms",function(e){e.preventDefault();var e={email:$("#jsTermsOfServiceEmail option:selected").val(),userReference:$("#jsTermsOfServiceReference").val().replace(/[^0-9]/g,"")},r=[];if(e.email||r.push('"Email" is required.'),e.email.verifyEmail()||r.push('"Email" is invalid.'),e.userReference||r.push('"System User Reference" is required.'),r.length)return alertify.alert("Error!",getErrorsStringFromArray(r),CB);r=e,_ml(!0,i+"Loader"),l=$.ajax({url:window.location.origin+"/payrolls/agreement/"+n,method:"POST",data:r}).success(function(){return l=null,_ml(!1,i+"Loader"),alertify.alert("Success!","You have successfully signed the agreement.",function(){$(`#${i} .jsModalCancel`).trigger("click"),window.location.reload()})}).fail(o)}),window.gustoServiceAgreement=r});
