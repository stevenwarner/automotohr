$(function(){let a=null,l=getSegment(2);$(document).on("click",".jsRegularPayrollStep2Save",function(e){e.preventDefault(),$(".jsRegularPayrollEmployeeRowTimeOff").map(function(){let e=$(this).data("id");$(this).find(".jsTimeOffField").map(function(){payroll.employees[e].fixed_compensations[$(this).prop("name")].amount=parseFloat($(this).val().trim()||0)})}),ml(!0,"jsPageLoader","Please wait, while we are saving data."),null===a&&(a=$.ajax({url:baseUrl("payrolls/regular/"+l+"/save/1"),method:"POST",data:{payrollId:l,action:"Time Off",employees:payroll.employees},cache:!1}).success(function(e){return _success(e.msg,function(){ml(!0,"jsPageLoader","Please wait while we are generating a view."),window.location.href=baseUrl("payrolls/regular/"+l+"/review")})}).fail(handleErrorResponse).always(function(){a=null,ml(!1,"jsPageLoader")}))}),$(document).on("click",".jsToggleHoursPay",function(e){e.preventDefault(),$(".jsToggleHoursPay").removeClass("active"),$(this).addClass("active"),$('table[data-key="hours"]').addClass("hidden"),$('table[data-key="pay"]').addClass("hidden"),$('table[data-key="'+$(this).data("target")+'"]').removeClass("hidden")}),$(document).on("click",".jsSubmitPayroll",function(e){e.preventDefault(),null===a&&(ml(!0,"jsPageLoader","Please wait, while we are submitting the regular payroll. This might takes a few minutes."),a=$.ajax({url:baseUrl("payrolls/regular/"+l+"/submit"),method:"PUT",cache:!1}).success(function(e){return _success(e.msg,function(){window.location.href=baseUrl("payrolls/history/"+l)})}).fail(handleErrorResponse).always(function(){a=null,ml(!1,"jsPageLoader")}))}),null===a&&(ml(!0,"jsPageLoader","Please wait, while we are generating a view. This might take a few minutes."),a=$.ajax({url:baseUrl("payrolls/regular/"+l+"/view/3"),method:"GET",cache:!1}).success(function(e){$(".jsContentArea").html(e.view)}).fail(handleErrorResponse).always(function(){a=null,ml(!1,"jsPageLoader")}))});
