$(function(){let a=null,o,c,r,s;function l(t){t||d(),$.ajax({url:baseUrl("v1/clock"),method:"GET"}).always(function(){a=null}).fail(handleErrorResponse).done(function(e){clearInterval(r),clearInterval(s),""===e.state||"clocked_out"==e.state?d():(o=e.clock_time,c=e.time,r=setInterval(u,1e3));{var n=e.state;let t="";"clocked_in"===n||"break_ended"===n?t=(t+=m("break_start"))+m("clocked_out"):t+=m("break_started"===n?"break_end":"clocked_in"),$(".jsAttendanceBTNs").html(t),$(".jsAttendanceClockHeaderBTNs").html(t)}"clocked_out"==e.state&&(n=function(t){t={hours:Math.floor(t/3600),minutes:Math.floor(t%3600/60),seconds:t%60};return t.hours=1===t.hours.toString().length?"0"+t.hours:t.hours,t.minutes=1===t.minutes.toString().length?"0"+t.minutes:t.minutes,t.seconds=1===t.seconds.toString().length?"0"+t.seconds:t.seconds,t}(n=e.time),$(".jsAttendanceClockHour").html(n.hours),$(".jsAttendanceClockMinute").html(n.minutes),$(".jsAttendanceClockSeconds").html(n.seconds),$(".jsAttendanceClockSeparator").html(":")),s=setInterval(h,1e3)})}function i(e,n,o){if(null===a){let t=_showNotification("Please wait, while we are processing your request.");a=$.ajax({url:baseUrl("v1/clock/mark"),method:"POST",data:JSON.stringify({type:e,latitude:n,longitude:o}),headers:{"content-type":"application/json"}}).always(function(){closeAlert(t),a=null}).fail(handleErrorResponse).done(function(){_success("You have successfully "+k(e)+"."),l()})}}function d(){o="",c="",clearInterval(r),$(".jsAttendanceClockHour").html("00"),$(".jsAttendanceClockMinute").html("00"),$(".jsAttendanceClockSeconds").html("00"),$(".jsAttendanceClockSeparator").html(":"),$(".jsAttendanceBTNs").html(""),$(".jsAttendanceClockHeaderBTNs").html("")}function u(){var t;o?(t=moment.utc(o).subtract(c,"seconds"),t=moment.utc().diff(t),t=moment(t).utc(),$(".jsAttendanceClockHour").html(t.format("HH")),$(".jsAttendanceClockMinute").html(t.format("mm")),$(".jsAttendanceClockSeconds").html(t.format("ss"))):($(".jsAttendanceClockHour").html("00"),$(".jsAttendanceClockMinute").html("00"),$(".jsAttendanceClockSeconds").html("00")),$(".jsAttendanceClockSeparator").html(":")}function h(){$(".jsAttendanceCurrentClockDateTime").text(moment().format("MMM D YYYY, ddd HH:mm:ss")),$(".jsAttendanceLoader").hide()}function m(t){let e="";return"clocked_in"===t?e=(e+='<button class="btn btn-orange jsAttendanceBtn" data-type="clocked_in">\t<i class="fa fa-play-circle csF16" aria-hidden="true"></i>')+"\t&nbsp;Clock in</button>":"clocked_out"===t?e=(e+='&nbsp;<button class="btn btn-red jsAttendanceBtn" data-type="clocked_out">\t<i class="fa fa-stop-circle csF16" aria-hidden="true"></i>')+"\t&nbsp;Clock out</button>":"break_start"===t?e=(e+='&nbsp;<button class="btn btn-black jsAttendanceBtn" data-type="break_started">\t<i class="fa fa-pause-circle csF16" aria-hidden="true"></i>')+"\t&nbsp;Break start</button>":"break_end"===t&&(e=(e+='&nbsp;<button class="btn btn-yellow jsAttendanceBtn" data-type="break_ended">\t<i class="fa fa-stop csF16" aria-hidden="true"></i>')+"\t&nbsp;Break end & clock in</button>"),e}function k(t){return{clocked_in:"Clocked In",clocked_out:"Clocked Out",break_started:"Started your break",break_ended:"Ended your break",clocked_in_confirm:"clock in",clocked_out_confirm:"clock out",break_started_confirm:"start your break",break_ended_confirm:"end your break"}[t]}$(document).on("click",".jsAttendanceBtn",function(t){t.preventDefault();const n=$(this).data("type");return _confirm("Do you want to "+k(n+"_confirm")+"?",function(){var e;e=n,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){i(e,t.coords.latitude,t.coords.longitude)},function(){return alertify.alert("Location permission denied!",""+'<p>The "location" permission is denied on your browser. Please allow the location before you can mark your attendance \t\t\t\tPlease follow the following steps to allow location permission.</p><br /> \t\t\t\t<ol>   \t\t\t\t<li>On your computer, open Chrome <img src="//storage.googleapis.com/support-kms-prod/Y57p9LEW3v1cnw4Svh3a53DOnyRPFkiDfTDc" width="18" height="18" alt="Chrome" data-mime-type="image/png">.</li>   \t\t\t\t<li>At the top right, click More <img src="//lh3.googleusercontent.com/E2q6Vj9j60Dw0Z6NZFEx5vSB9yoZJp7C8suuvQXVA_2weMCXstGD7JEvNrzX3wuQrPtL=w36-h36" width="18" height="18" alt="More" data-mime-type="image/png" data-alt-src="//lh3.googleusercontent.com/E2q6Vj9j60Dw0Z6NZFEx5vSB9yoZJp7C8suuvQXVA_2weMCXstGD7JEvNrzX3wuQrPtL"> <img src="//lh3.googleusercontent.com/3_l97rr0GvhSP2XV5OoCkV2ZDTIisAOczrSdzNCBxhIKWrjXjHucxNwocghoUa39gw=w36-h36" width="18" height="18" alt="and then" data-mime-type="image/png" data-alt-src="//lh3.googleusercontent.com/3_l97rr0GvhSP2XV5OoCkV2ZDTIisAOczrSdzNCBxhIKWrjXjHucxNwocghoUa39gw"> <strong>Settings</strong>.</li>   \t\t\t\t<li>Click <strong>Privacy and security</strong>&nbsp;<img src="//lh3.googleusercontent.com/3_l97rr0GvhSP2XV5OoCkV2ZDTIisAOczrSdzNCBxhIKWrjXjHucxNwocghoUa39gw=w36-h36" width="18" height="18" alt="and then" data-mime-type="image/png" data-alt-src="//lh3.googleusercontent.com/3_l97rr0GvhSP2XV5OoCkV2ZDTIisAOczrSdzNCBxhIKWrjXjHucxNwocghoUa39gw">&nbsp;<strong>Site Settings</strong>.</li>   \t\t\t\t<li data-outlined="false" class="">Click <strong>Location</strong>.</li>   \t\t\t\t<li>Choose the option you want as your default setting.</li> \t\t\t</ol>')}):(i(e,0,0),console.log("Geolocation is required for this page, but your browser doesn't support it. Try it with a browser that does"))})}),setInterval(function(){l(!0)},1e4),s=setInterval(h,1e3),l()});
