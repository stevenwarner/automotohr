$(function(){let o,a,s=[],i=[],t=null,e=null,l=[],n=[];function r(){null!==t&&t.abort(),ml(!0,"jsWeekGraph",""),t=$.ajax({url:baseUrl("v1/clock/graphs/week_worked_time"),method:"GET",cache:!1}).always(function(){t=null,ml(!1,"jsWeekGraph")}).fail(handleErrorResponse).done(function(t){var e=Object.values(t);let l=[],n=0;e?.map(function(t,e){let o=0;t.minutes&&(o=parseFloat(t.minutes)+parseFloat(60*t.hours),n+=parseInt(o)),l.push(parseInt(o))}),n=n.toFixed(0),Highcharts.chart("container",{chart:{type:"column"},title:{text:`You have worked for ${n}m.`,align:"left",style:{fontSize:"16px"}},xAxis:{categories:Object.keys(t).map(function(t){return moment(t,"YYYY-MM-DD").format("MMM DD YYYY, ddd")}),crosshair:!0,accessibility:{description:"Week days"},labels:{style:{fontSize:"12px"}}},yAxis:{min:0,title:{text:"# of worked minutes",style:{fontSize:"14px"}},labels:{style:{fontSize:"12px"}}},tooltip:{valueSuffix:"m"},plotOptions:{column:{pointPadding:.2,borderWidth:0,labels:{style:{fontSize:"40px"}}}},series:[{name:"Worked minutes",data:l,column:{labels:{style:{fontSize:"40px"}}}}],colors:["#fd7a2a"]})})}function c(){null!==e&&e.abort(),e=$.ajax({url:baseUrl("v1/clock/my/footprints/today"),method:"GET",cache:!1}).always(function(){e=null}).fail(handleErrorResponse).done(function(t){l.toString()!==t.logs.locations.toString()&&(l=t.logs.locations,function t(e){"undefined"==typeof google?o=setInterval(function(){t(e)},3e3):(clearInterval(o),e())}(p)),n=t.logs.logs;{let o="";if(n.length){let e=0;n.forEach(function(t){e+=parseFloat(t.duration),o=(o=(o=(o=(o=(o+='<tr data-id="'+t.sid+'">')+'\t<td class="csVerticalAlignMiddle">\t\t<p>')+t.text)+"\t\t</p>\t</td>")+'\t<td class="csVerticalAlignMiddle text-right">\t\t<p>')+moment(t.startTime,"YYYY-MM-DD HH:mm:ss").format("hh:mm a")+"\t\t - ",t.endTime?o+=moment(t.endTime,"YYYY-MM-DD HH:mm:ss").format("hh:mm a"):o+="\t\tMissing",o=(o=(o=(o+="\t\t</p>\t</td>")+'\t<td class="csVerticalAlignMiddle text-right">\t\t<p>')+t.durationText+"\t\t</p>")+"\t</td></tr>"}),$(".jsTimeEntriesBox tbody").html(o),o=(o=(o=(o="<tr>")+'\t<th scope="col" colspan="3" class="csVerticalAlignMiddle text-right">\tTotal: ')+convertSecondsToTime(e))+"\t</th></tr>",$(".jsTimeEntriesBox tfoot").html(o)}else $(".jsTimeEntriesBox").html('<p class="alert alert-info text-center">No time entries yet!</p>')}})}function p(){delete a,a=new google.maps.Map(document.getElementById("map"),{center:{lat:parseFloat(l[0].lat),lng:parseFloat(l[0].lng)},mapTypeId:"roadmap"});const n=[];l.map(function(t,e){var o,l={map:a,position:{lat:parseFloat(t.lat),lng:parseFloat(t.lng)},title:t.title};0===e&&(l.icon="http://maps.google.com/mapfiles/ms/icons/green-dot.png"),e=l,o=new google.maps.Marker(e),s.push(o),i.push({lat:e.position.lat,lng:e.position.lng}),t.constraint,n.push(new google.maps.LatLng(l.position.lat,l.position.lng))});new google.maps.Polyline({path:i,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2}).setMap(a);for(var t=new google.maps.LatLngBounds,e=0;e<n.length;e++)t.extend(n[e]);a.fitBounds(t)}setInterval(r,5e4),setInterval(c,2e4),r(),c()});
