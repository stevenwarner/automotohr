$(function(){let o=null;const l="jsModalPage",i=l+"Loader",n=l+"Body";function a(e,s,r){Modal({Id:l,Title:e,Body:'<div id="'+n+'"></div>',Loader:i},function(){var e=s,a=r;null!==o&&o.abort(),o=$.ajax({url:baseUrl("payrolls/page/"+e+"/"+profileUserInfo.userId+"/"+profileUserInfo.userType),method:"GET"}).always(function(){o=null}).fail(handleErrorResponse).done(function(e){$("#"+n).html(e.view),a(e)})})}function s(e,a){if(null===o){const s=callButtonHook(a,!0);o=$.ajax({url:baseUrl("payrolls/page/update"),method:"POST",data:e,processData:!1,contentType:!1}).always(function(){callButtonHook(s,!1),o=null}).fail(handleErrorResponse).done(function(e){return _success(e.msg,function(){window.location.href=baseUrl("payrolls/dashboard/"+profileUserInfo.userType+"/"+profileUserInfo.userId)})})}}$(document).on("click",".jsAdjustForMinimumWage",function(e){$(this).is(":checked")?$(".jsMinimumWagesBox").removeClass("hidden"):($(".jsMinimumWagesBox").addClass("hidden"),$(".jsMinimumWages").select2("val",""))}),$(".jsEditPaySchedule").click(function(e){e.preventDefault(),a(profileUserInfo.nameWithRole,"pay_schedule",function(){ml(!1,i),$("#jsPagePayScheduleForm").validate({rules:{pay_schedule:{required:!0}},messages:{pay_schedule:{required:"Please select a pay schedule."}},submitHandler:function(e){e=formArrayToObj($(e).serializeArray());return e.append("page","pay_schedule"),e.append("userId",profileUserInfo.userId),e.append("userType",profileUserInfo.userType),s(e,$(".jsPagePayScheduleBtn"))}})})}),$(document).on("click",".jsPagePayScheduleBtn",function(e){e.preventDefault();var e={employeeType:$(".jsEmploymentType option:selected").val(),flsaStatus:$(".jsFLSAStatus option:selected").val().trim(),payType:$(".jsPayType option:selected").val().trim(),hireDate:$(".jsHireDate").val().trim(),overTimeRule:$(".jsOvertimeRule option:selected").val().trim(),employeeRate:$(".jsEmployeeRate").val().trim(),adjustMinimumWage:"on"==$('input[name="adjust_for_minimum_wage"]:checked').val()?1:0,wagesID:$(".jsMinimumWages").select2("val")},a=(console.log(e),[]);if(e.employeeType||a.push('"Employment type" is missing.'),e.flsaStatus||a.push('"FLSA status" is missing.'),e.payType||a.push('"Pay type" is missing.'),e.hireDate||a.push('"Hire date" is missing.'),e.employeeRate||a.push('"Rate" is missing.'),e.overTimeRule||a.push('"Overtime rule" is missing.'),a.length)return alertify.alert("ERROR",getErrorsStringFromArray(a),CB);ml(!0,i),o=$.ajax({url:window.location.origin+"/payrolls/employee_job_compensation/"+profileUserInfo.userId+"/"+profileUserInfo.userType,method:"POST",data:e}).success(function(){return o=null,_ml(!1,l+"Loader"),alertify.alert("SUCCESS","Congratulations! You have successfully added a payroll admin for the company.",function(){processQueue.adminStep()})}).fail(saveErrorsList)}),$(".jsEditJobWage").click(function(e){e.preventDefault(),a(profileUserInfo.nameWithRole,"job_and_wage",function(){ml(!1,i),$(".jsMinimumWages").select2({closeOnSelect:!1}),$(".jsHireDate").daterangepicker({singleDatePicker:!0,showDropdowns:!0,autoApply:!0,locale:{format:"MM/DD/YYYY"}}),$("#jsPageJobWageForm").validate({rules:{employment_type:{required:!0},flsa_status:{required:!0},per:{required:!0},hire_date:{required:!0},rate:{required:!0},overtime_rule:{required:!0}},submitHandler:function(e){e=formArrayToObj($(e).serializeArray());return e.append("page","pay_schedule"),e.append("userId",profileUserInfo.userId),e.append("userType",profileUserInfo.userType),s(e,$(".jsPageJobWageBtn"))}})})})});
