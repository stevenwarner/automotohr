$(function(){let i=null;const a="jsModalPage",n=a+"Loader",o=a+"Body";function s(e,s,r){Modal({Id:a,Title:e,Body:'<div id="'+o+'"></div>',Loader:n},function(){var e=s,a=r;null!==i&&i.abort(),i=$.ajax({url:baseUrl("payrolls/page/"+e+"/"+profileUserInfo.userId+"/"+profileUserInfo.userType),method:"GET"}).always(function(){i=null}).fail(handleErrorResponse).done(function(e){$("#"+o).html(e.view),a(e)})})}$(document).on("click",".jsAdjustForMinimumWage",function(e){$(this).is(":checked")?$(".jsMinimumWagesBox").removeClass("hidden"):($(".jsMinimumWagesBox").addClass("hidden"),$(".jsMinimumWages").select2("val",""))}),$(".jsEditPaySchedule").click(function(e){e.preventDefault(),s(profileUserInfo.nameWithRole,"pay_schedule",function(){ml(!1,n),$("#jsPagePayScheduleForm").validate({rules:{pay_schedule:{required:!0}},messages:{pay_schedule:{required:"Please select a pay schedule."}},submitHandler:function(e){var e=formArrayToObj($(e).serializeArray()),a=(e.append("page","pay_schedule"),e.append("userId",profileUserInfo.userId),e.append("userType",profileUserInfo.userType),$(".jsPagePayScheduleBtn"));if(null===i){const s=callButtonHook(a,!0);i=$.ajax({url:baseUrl("payrolls/page/update"),method:"POST",data:e,processData:!1,contentType:!1}).always(function(){callButtonHook(s,!1),i=null}).fail(handleErrorResponse).done(function(e){return _success(e.msg,function(){window.location.href=baseUrl("payrolls/dashboard/"+profileUserInfo.userType+"/"+profileUserInfo.userId)})})}}})})}),$(document).on("click",".jsPagePayScheduleBtn",function(e){e.preventDefault();var e={employeeType:$(".jsEmploymentType option:selected").val(),classification:$(".jsFLSAStatus option:selected").val().trim(),per:$(".jsPayType option:selected").val().trim(),hireDate:$(".jsHireDate").val().trim(),overTimeRule:$(".jsOvertimeRule option:selected").val().trim(),amount:$(".jsEmployeeRate").val().trim(),minimumWage:"on"==$('input[name="adjust_for_minimum_wage"]:checked').val()?1:0,wagesId:$(".jsMinimumWages").select2("val"),guaranteeRate:$(".jsEmployeeGuaranteeRate").val().trim(),guaranteePer:$(".jsEmployeeGuaranteePayType option:selected").val().trim(),guaranteeTime:$(".jsEmployeeGuaranteeTimes").val().trim()},a=[];if(e.employeeType||a.push('"Employment type" is missing.'),e.classification||a.push('"FLSA status" is missing.'),e.per||a.push('"Pay type" is missing.'),e.hireDate||a.push('"Hire date" is missing.'),e.amount||a.push('"Rate" is missing.'),e.overTimeRule||a.push('"Overtime rule" is missing.'),!e.guaranteeRate||e.guaranteeTime||a.push('"Guarantee time" is missing.'),a.length)return alertify.alert("ERROR",getErrorsStringFromArray(a),CB);ml(!0,n),i=$.ajax({url:window.location.origin+"/payrolls/employee_job_compensation/"+profileUserInfo.userId+"/"+profileUserInfo.userType,method:"POST",data:e}).always(function(){ml(!1,n),i=null}).fail(function(e){return console.log(),alertify.alert("ERROR",getErrorsStringFromArray(e.responseJSON.errors))}).done(function(e){return alertify.alert("SUCCESS",e.msg)})}),$(".jsEditJobWage").click(function(e){e.preventDefault(),s(profileUserInfo.nameWithRole,"job_and_wage",function(){ml(!1,n),$(".jsMinimumWages").select2({closeOnSelect:!1}),$(".jsHireDate").daterangepicker({singleDatePicker:!0,showDropdowns:!0,autoApply:!0,locale:{format:"MM/DD/YYYY"}})})})});
