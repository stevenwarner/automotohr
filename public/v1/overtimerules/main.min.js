$(function(){let a=null,i=null;const t="jsModalPage",r=t+"Loader",u=t+"Body";function o(e,o,i,n){Modal({Id:t,Title:e,Body:'<div id="'+u+'"></div>',Loader:r},function(){var e=o,t=i,r=n;null!==a&&a.abort(),a=$.ajax({url:baseUrl("settings/page/"+e+"/"+t),method:"GET"}).always(function(){a=null}).fail(handleErrorResponse).done(function(e){$("#"+u).html(e.view),r(e)})})}function n(e,t,r){if(null===a){const o=callButtonHook(t,!0);a=$.ajax({url:baseUrl(r||"payrolls/page/update"),method:"POST",data:e,processData:!1,contentType:!1}).always(function(){callButtonHook(o,!1),a=null}).fail(handleErrorResponse).done(function(e){return i?.destroy(),_success(e.msg,function(){window.location.href=baseUrl("overtimerules")})})}}function l(e){const t={};return"daily"===e?["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].forEach(function(e){t[e]={overtime:{},double:{}},t[e].overtime.status=$('[name="'+e+'_overtime_status"]').prop("checked"),t[e].overtime.hours=t[e].overtime.status?parseFloat($('[name="'+e+'_overtime_hours"]').val().trim()):"",t[e].double.status=$('[name="'+e+'_double_status"]').prop("checked"),t[e].double.hours=t[e].double.status?parseFloat($('[name="'+e+'_double_hours"]').val().trim()):""}):(t.overtime={status:"off",hours:""},t.double={status:"off",hours:""},t.overtime.status=$('[name="'+e+'_overtime_status"]').prop("checked"),t.overtime.status?t.overtime.hours=parseFloat($('[name="'+e+'_overtime_hours"]').val().trim()):t.overtime.hours="",t.double.status=$('[name="'+e+'_double_status"]').prop("checked"),t.double.status?t.double.hours=parseFloat($('[name="'+e+'_double_hours"]').val().trim()):t.double.hours=""),t}$(".jsAddOvertimeRuleBtn").click(function(e){e.preventDefault(),o("New Overtime Rule","overtime_rules",0,function(){ml(!1,r);$("#jsPageOvertimeRuleForm").validate({rules:{rule_name:{required:!0},overtime_multiplier:{required:!0},double_overtime_multiplier:{required:!0}},submitHandler:function(e){e=formArrayToObj($(e).serializeArray());return e.append("weekly",JSON.stringify(l("weekly"))),e.append("consecutive",JSON.stringify(l("consecutive"))),e.append("holiday",JSON.stringify(l("holidays"))),e.append("daily",JSON.stringify(l("daily"))),n(e,$(".jsPageOvertimeRuleBtn"),"overtimerules")}})})}),$(".jsEditOvertimeRuleBtn").click(function(e){e.preventDefault();const t=$(this).closest(".jsBox").data("id");o("Edi Overtime Rule","overtime_rules",t,function(){ml(!1,r),i=$("#jsPageOvertimeRuleForm").validate({rules:{rule_name:{required:!0},overtime_multiplier:{required:!0},double_overtime_multiplier:{required:!0}},submitHandler:function(e){e=formArrayToObj($(e).serializeArray());return e.append("id",t),e.append("weekly",JSON.stringify(l("weekly"))),e.append("consecutive",JSON.stringify(l("consecutive"))),e.append("holiday",JSON.stringify(l("holidays"))),e.append("daily",JSON.stringify(l("daily"))),n(e,$(".jsPageOvertimeRuleBtn"),"overtimerules")}})})}),$(".jsDeleteOvertimeRuleBtn").click(function(e){e.preventDefault();const o=$(this).closest(".jsBox"),i=o.data("id");return _confirm("Are you sure you want to delete it? This action cannot be undone.",function(){var e=o,t=i;if(null===a){const r=callButtonHook(e.find(".jsDeleteOvertimeRuleBtn"),!0);a=$.ajax({url:baseUrl("overtimerules/"+t),method:"DELETE"}).always(function(){callButtonHook(r,!1),a=null}).fail(handleErrorResponse).done(function(e){return _success(e.msg,function(){window.location.href=baseUrl("overtimerules")})})}})}),$(document).on("click",".jsAddChangeStatus",function(){var e=$(this).data("target");$('[name="'+e+'"]').prop("disabled",!$(this).prop("checked")),$('[name="'+e+'"]').rules("remove"),$(this).prop("checked")&&$('[name="'+e+'"]').rules("add",{required:!0,number:!0})})});
