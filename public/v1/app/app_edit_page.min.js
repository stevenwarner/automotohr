$(function(){let i=null,r=getSegment(4);function t(e,a,t){if(null!==i)return!1;let n=callButtonHook(a,!0);i=$.ajax({url:baseUrl("manage_admin/cms/page/edit/"+r),method:"POST",data:e,processData:!1,contentType:!1}).always(function(){i=null,callButtonHook(n,!1)}).fail(handleErrorResponse).done(function(e){return _success(e.msg,function(){window.location.href=baseUrl("manage_admin/cms/page/edit/"+r+"/?page="+t)})})}$("#jsPageDetailsForm").validate({ignore:[],rules:{title:{required:!0},slug:{required:!0}},submitHandler:function(e){e=formArrayToObj($(e).serializeArray());return e.append("section","main"),t(e,$(".jsPageDetailsBtn"),"details")}}),$("#jsMetaForm").validate({ignore:[],rules:{title:{required:!0},slug:{required:!0}},submitHandler:function(e){e=formArrayToObj($(e).serializeArray());return e.append("section","meta"),t(e,$(".jsMetaBtn"),"meta")}}),CKEDITOR.replace("jsSection1Details"),$("#jsSection1Banner").msFileUploader({allowedTypes:["jpg","jpeg","png","webp"],allowLinks:!1,activeLink:section1.sourceType,placeholderImage:section1.sourceFile,fileLimit:"200mb"}),$("#jsSection1Form").validate({ignore:[],rules:{title:{required:!0},slug:{required:!0}},submitHandler:function(e){var e=formArrayToObj($(e).serializeArray()),a=(e.append("section","pageDetails"),$("#jsSection1Banner").msFileUploader("get"));return isValidFile(a)?(void 0!==a.link?(e.append("source_type",a.type),e.append("source_link",a.link)):(e.append("source_type","upload"),e.append("file",a)),e.append("details",CKEDITOR.instances.jsSection1Details.getData()),t(e,$(".jsSection1Btn"),"pageDetails")):_error("Please select a valid source.")}}),$(".jsToSlug").keyup(function(){var e=$(this).data("target");$('[name="'+e+'"]').val($(this).val().toSlug())}),$(".jsPageStatus").click(function(e){e.preventDefault();e=new FormData;e.append("section","status"),e.append("status",$(this).data("key")),t(e,$(".jsPageStatus"),"pageDetails")})});
