$(function(){let n=0,l="jsAgreementModal",i=null;function r(e){if(0===(n=e))return alertify.alert("ERROR","Company code is missing.",CB);Modal({Id:l,Title:"Service Agreement",Loader:l+"Loader",Body:`<div id="${l}Body"></div>`},a)}function a(){i=$.ajax({url:baseUrl(`payroll/company/${n}/agreement/`),method:"GET"}).success(function(e){i=null,$(`#${l}Body`).html(e.view),_ml(!1,l+"Loader")}).fail(e)}function t(e){return _ml(!1,l+"Loader"),i=null,handleErrorResponse(e)}function e(e){return $(`#${l} .jsModalCancel`).trigger("click"),handleErrorResponse(e)}$(document).on("click",".jsModalCancel",function(){i=null}),$(".jsServiceAgreement").click(function(e){e.preventDefault(),r(parseInt($(this).data("cid")))}),$(document).on("change","#jsTermsOfServiceEmail",function(){$("#jsTermsOfServiceReference").val($("#jsTermsOfServiceEmail option:selected").data("id"))}),$(document).on("click",".jsPayrollAgreeServiceTerms",function(e){e.preventDefault();var e={email:$("#jsTermsOfServiceEmail option:selected").val(),userReference:$("#jsTermsOfServiceReference").val().replace(/[^0-9]/g,"")},r=[];if(e.email||r.push('"Email" is required.'),e.email.verifyEmail()||r.push('"Email" is invalid.'),e.userReference||r.push('"System User Reference" is required.'),r.length)return alertify.alert("Error!",getErrorsStringFromArray(r),CB);r=e,_ml(!0,l+"Loader"),i=$.ajax({url:baseUrl(`payroll/company/${n}/agreement/sign`),method:"POST",data:r}).success(function(){return i=null,_ml(!1,l+"Loader"),alertify.alert("Success!","You have successfully signed the agreement.",function(){$(`#${l} .jsModalCancel`).trigger("click"),window.location.reload()})}).fail(t)}),window.gustoServiceAgreement=r});
