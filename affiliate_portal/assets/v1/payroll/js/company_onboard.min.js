$((function(){let e=0,n="jsCreatePartnerCompanyModal",l=null,t={checkRequirements:function(){null!==l&&l.abort();l=$.ajax({url:window.location.origin+"/payroll/company/"+e+"/requirements",method:"GET"}).success((function(){l=null,t.welcomeStep()})).fail(r)},welcomeStep:function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/1/"+e,method:"GET"}).success((function(e){if(l=null,$(`#${n}Body`).html(e.view),void 0!==e.onboard){if("terms"===e.onboard)return t.gustoTerms();window.location.reload()}_ml(!1,n+"Loader"),$(".jsPayrollLoadSelectEmployees").click((function(e){e.preventDefault(),_ml(!0,n+"Loader"),t.employeeListingStep()}))})).fail(r)},employeeListingStep:function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/2/"+e,method:"GET"}).success((function(e){l=null,$(`#${n}Body`).html(e.view),_ml(!1,n+"Loader"),$(".jsPayrollLoadOnboard").click((function(e){e.preventDefault(),function(){if(i=[],$(".jsEmployeesList:checked").map((function(){i.push($(this).val())})),!i.length)return alertify.alert("ERROR","Please select at least one employee.",CB);_ml(!0,n+"Loader"),t.adminStep()}()})),$(".jsBackToStep1").click((function(e){e.preventDefault(),_ml(!0,n+"Loader"),t.welcomeStep()}))})).fail(r)},adminStep:function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/3/"+e,method:"GET"}).success((function(i){l=null,$(`#${n}Body`).html(i.view),_ml(!1,n+"Loader"),$(".jsPayrollSetAdmin").click((function(t){t.preventDefault(),function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/4/"+e,method:"GET"}).success((function(e){l=null,$(`#${n}Body`).html(e.view),_ml(!1,n+"Loader")})).fail(r)}()})),$(".jsBackToStep2").click((function(e){e.preventDefault(),_ml(!0,n+"Loader"),t.employeeListingStep()}))})).fail(r)},createPartnerCompany:o},i=[];function o(){l=$.ajax({url:window.location.origin+"/payroll/cpc/7/"+e,method:"POST",data:{employees:i}}).success((function(){l=null,gustoServiceAgreement(e)})).fail(a)}function a(e){return _ml(!1,n+"Loader"),l=null,handleErrorResponse(e)}function r(e){return $(`#${n} .jsModalCancel`).trigger("click"),handleErrorResponse(e)}$(document).on("click",".jsModalCancel",(function(){l=null})),$(".jsCreatePartnerCompanyBtn").click((function(l){if(l.preventDefault(),e=parseInt($(this).data("cid")),0===e)return alertify.alert("ERROR","Company code is missing.",CB);Modal({Id:n,Title:"",Loader:n+"Loader",Body:`<div id="${n}Body"></div>`},t.checkRequirements)})),$(document).on("click",".jsPayrollViewAdminDetails",(function(t){t.preventDefault(),_ml(!0,n+"Loader"),l=$.ajax({url:window.location.origin+"/payroll/cpc/6/"+e,method:"GET"}).success((function(e){l=null,$(`#${n}Body`).html(e.view),_ml(!1,n+"Loader")})).fail(r)})),$(document).on("click",".jsPayrollSaveAdmin",(function(i){i.preventDefault(),function(){let i={firstName:$(".jsAdminFirstName").val().trim(),lastName:$(".jsAdminLastName").val().trim(),email:$(".jsAdminEmailAddress").val().trim()},o=[];i.firstName||o.push('"First name" is missing.');i.lastName||o.push('"Last name" is missing.');i.email||o.push('"Email" is missing.');i.email.verifyEmail()||o.push('"Email" is invalid.');if(o.length)return alertify.alert("ERROR",getErrorsStringFromArray(o),CB);_ml(!0,n+"Loader"),l=$.ajax({url:window.location.origin+"/payroll/cpc/5/"+e,method:"POST",data:i}).success((function(){return l=null,alertify.alert("SUCCESS","Congratulations! You have successfully added a payroll admin for the company.",(function(){t.adminStep()}))})).fail(a)}()})),$(document).on("click",".jsBackToStep3",(function(e){e.preventDefault(),_ml(!0,n+"Loader"),t.adminStep()})),$(document).on("click",".jsCreatePartnerCompanyProcessBtn",(function(e){e.preventDefault(),_ml(!0,n+"Loader","Please wait patiently while we set up the payroll system. This procedure may take a few minutes."),t.createPartnerCompany()}))}));