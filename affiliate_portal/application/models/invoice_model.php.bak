<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class Invoice_model extends CI_Model {
    function __construct() {
        parent::__construct();
    }

    public function get_all_invoices($m_sid) {
        $this->db->select('voucher_number,payment_voucher.created,payment_voucher.payment_date,payment_voucher.payment_status,payment_voucher.company_name,paid_amount,commission_invoices.commission_applied,commission_invoices.secondary_commission_referrer_sid');
        $this->db->where('payment_voucher.marketing_agency_sid', $m_sid);
        $this->db->join('commission_invoices','commission_invoices.sid = payment_voucher.commission_invoice_sid','left');
        $records_obj = $this->db->get('payment_voucher');
        $records_arr = $records_obj->result_array();
        $records_obj->free_result();
        return $records_arr;
    }

    public function get_secondary_agency($m_sid) {
        $this->db->select('full_name');
        $this->db->where('sid', $m_sid);
        $records_obj = $this->db->get('marketing_agencies');
        $records_arr = $records_obj->result_array();
        $records_obj->free_result();
        if(sizeof($records_arr)>0){
            $records_arr = $records_arr[0];
        } else{
            $records_arr = 'N/A';
        }
        return $records_arr;
    }

}