let cmnOBJ={Employees:{Main:{action:"get_company_employees",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}},DepartmentTeam:{Main:{action:"get_company_departments_and_teams",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}}};function fetchEmployees(){$.post(handlerURL,cmnOBJ.Employees.Main,(function(resp){if(!0===resp.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});if(!1===resp.Status)return void console.log("Failed to load employees.");window.timeoff.employees=resp.Data;let rows="",dRows;rows+='<option value="all">All</option>',window.timeoff.employees.map((function(v){rows+='<option value="'+v.user_id+'">'+remakeEmployeeName(v)+"</option>",dRows+='<option value="'+v.user_id+'">'+remakeEmployeeName(v)+"</option>"})),$("#js-employee-add").html(dRows),$("#js-employee-add").select2(),$("#js-employee-add").select2MultiCheckboxes({templateSelection:function(selected,total){return total--,"Selected "+(-1!==$.inArray("all",$("#js-employee-add").val())?total:selected.length)+" of "+total}}),$("#js-employee-edit").html(dRows),$("#js-employee-reset").html(dRows),$("#js-filter-employee").html(rows),$("#js-filter-employee").select2()}))}function fetchDepartmentTeams(){$.post(handlerURL,cmnOBJ.DepartmentTeam.Main,(function(resp){if(!0===resp.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});if(!1===resp.Status)return void console.log("Failed to load employees.");let rows="";window.timeoff.dt=resp.Data,rows+='<option value="all">All</option>',window.timeoff.dt.Departments.length&&(window.timeoff.dt.Departments.map((function(v){rows+=`<option value="${v.department_id}">${v.title}</option>`})),$("#js-filter-departments").html(rows),$("#js-departments-add").html(rows),$("#js-departments-edit").html(rows)),rows='<option value="all">All</option>',window.timeoff.dt.Teams.length&&(window.timeoff.dt.Teams.map((function(v){rows+=`<option value="${v.team_id}">${v.title}</option>`})),$("#js-filter-teams").html(rows),$("#js-teams-add").html(rows),$("#js-teams-edit").html(rows)),$("#js-filter-departments").select2(),$("#js-filter-teams").select2()}))}function loadAddPage(){page="add",ml(!0,"approver"),$(".js-page").fadeOut(0),$("#js-page-add").fadeIn(500),void 0!==window.timeoff.employees?($("#js-employee-add").select2(),$("#js-employee-add").select2("val",null),$(".js-is-department-add").prop("checked",!1),$(".js-department-row-add, .js-team-row-add").hide(),$("#js-departments-add").select2(),$("#js-departments-add").select2("val",null),$("#js-teams-add").select2(),$("#js-teams-add").select2("val",null),$("#js-approve-100-percent-add").prop("checked",!1),$("#js-archived-add").prop("checked",!1),ml(!1,"approver")):setTimeout(loadAddPage,2e3)}function loadViewPage(){page="view",ml(!0,"policy"),$(".js-page").fadeOut(0),$("#js-page-view").fadeIn(500),window.timeoff.fetchCompanyApprovers()}function loadEditPage(typeId){page="edit",ml(!0,"approver"),$(".js-page").fadeOut(0),$("#js-page-edit").fadeIn(500),void 0!==window.timeoff.employees?($("#js-employee-edit").select2(),$("#js-employee-edit").select2("val",null),$(".js-is-department-edit").prop("checked",!1),$(".js-department-row-edit, .js-team-row-edit").hide(),$("#js-departments-edit").select2(),$("#js-departments-edit").select2("val",null),$("#js-teams-edit").select2(),$("#js-teams-edit").select2("val",null),$("#js-approve-100-percent-edit").prop("checked",!1),$("#js-archived-edit").prop("checked",!1),window.timeoff.startEditprocess(typeId)):setTimeout(loadEditPage,2e3)}fetchEmployees(),fetchDepartmentTeams(),"add"==page&&loadAddPage(),$("#js-add-type-btn").click(e=>{e.preventDefault(),loadAddPage()}),$(document).on("click",".js-edit-row-btn",e=>{e.preventDefault(),loadEditPage($(e.target).closest("tr").data("id"))}),$(".js-view-type-btn").click((function(e){e.preventDefault(),alertify.confirm("WARNING!","Any unsaved changes will be lost.",loadViewPage,()=>{}).set("labels",{ok:"Leave",cancel:"No, I will stay"})}));