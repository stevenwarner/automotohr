let cmnOBJ={Employees:{Main:{action:"get_company_employees_for_approvers",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}},DepartmentTeam:{Main:{action:"get_company_departments_and_teams",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}}};function fetchEmployees(){$.post(handlerURL,cmnOBJ.Employees.Main,(function(e){if(!0===e.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",(()=>{window.location.reload()}));if(!1===e.Status)return;window.timeoff.employees=e.Data;let t,a="";a+='<option value="all">All</option>',window.timeoff.employees.map((function(e){let o="";"1"===e.terminated_status?o=" - Terminated":"0"===e.active&&(o=" - Deactivated"),a+='<option value="'+e.user_id+'">'+remakeEmployeeName(e)+o+"</option>",t+='<option value="'+e.user_id+'">'+remakeEmployeeName(e)+o+"</option>"})),$("#js-employee-add").html(t),$("#js-employee-add").select2(),$("#js-employee-add").select2MultiCheckboxes({templateSelection:function(e,t){return t--,"Selected "+(-1!==$.inArray("all",$("#js-employee-add").val())?t:e.length)+" of "+t}}),$("#js-employee-edit").html(t),$("#js-employee-reset").html(t),$("#js-filter-employee").html(a),$("#js-filter-employee").select2()}))}function fetchDepartmentTeams(){$.post(handlerURL,cmnOBJ.DepartmentTeam.Main,(function(e){if(!0===e.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",(()=>{window.location.reload()}));if(!1===e.Status)return;let t="";window.timeoff.dt=e.Data,t+='<option value="all">All</option>',window.timeoff.dt.Departments.length&&(window.timeoff.dt.Departments.map((function(e){t+=`<option value="${e.department_id}">${e.title}</option>`})),$("#js-filter-departments").html(t),$("#js-departments-add").html(t),$("#js-departments-edit").html(t)),t='<option value="all">All</option>',window.timeoff.dt.Teams.length&&(window.timeoff.dt.Teams.map((function(e){t+=`<option value="${e.team_id}">${e.title}</option>`})),$("#js-filter-teams").html(t),$("#js-teams-add").html(t),$("#js-teams-edit").html(t)),$("#js-filter-departments").select2(),$("#js-filter-teams").select2()}))}function loadAddPage(){page="add",ml(!0,"approver"),$(".js-page").fadeOut(0),$("#js-page-add").fadeIn(500),void 0!==window.timeoff.employees?($("#js-employee-add").select2(),$("#js-employee-add").select2("val",null),$(".js-is-department-add").prop("checked",!1),$(".js-department-row-add, .js-team-row-add").hide(),$("#js-departments-add").select2(),$("#js-departments-add").select2("val",null),$("#js-teams-add").select2(),$("#js-teams-add").select2("val",null),$("#js-approve-100-percent-add").prop("checked",!1),$("#js-archived-add").prop("checked",!1),ml(!1,"approver")):setTimeout(loadAddPage,2e3)}function loadViewPage(){page="view",ml(!0,"policy"),$(".js-page").fadeOut(0),$("#js-page-view").fadeIn(500),window.timeoff.fetchCompanyApprovers()}function loadEditPage(e){page="edit",ml(!0,"approver"),$(".js-page").fadeOut(0),$("#js-page-edit").fadeIn(500),void 0!==window.timeoff.employees?($("#js-employee-edit").select2(),$("#js-employee-edit").select2("val",null),$(".js-is-department-edit").prop("checked",!1),$(".js-department-row-edit, .js-team-row-edit").hide(),$("#js-departments-edit").select2(),$("#js-departments-edit").select2("val",null),$("#js-teams-edit").select2(),$("#js-teams-edit").select2("val",null),$("#js-approve-100-percent-edit").prop("checked",!1),$("#js-archived-edit").prop("checked",!1),window.timeoff.startEditprocess(e)):setTimeout(loadEditPage,2e3)}fetchEmployees(),fetchDepartmentTeams(),"add"==page&&loadAddPage(),$("#js-add-type-btn").click((e=>{e.preventDefault(),loadAddPage()})),$(document).on("click",".js-edit-row-btn",(e=>{e.preventDefault(),loadEditPage($(e.target).closest("tr").data("id"))})),$(".js-view-type-btn").click((function(e){e.preventDefault(),alertify.confirm("WARNING!","Any unsaved changes will be lost.",loadViewPage,(()=>{})).set("labels",{ok:"Leave",cancel:"No, I will stay"})}));