$((function(){let holidayOBJ={year:0,holiday:0,icon:0,startDate:0,endDate:0,workOnHoliday:0,deactivate:0},cmnOBJ={Holidays:{Main:{action:"get_single_holiday",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}}};function updateHoliday(type){ml(!0,"holiday");let post=Object.assign({},holidayOBJ,{action:"update_holiday",companyId:companyId,employeeId:employeeId,employerId:employerId,public:0,holidayId:holidayId});$.post(handlerURL,post,resp=>{ml(!1,"holiday"),!0!==resp.Redirect?!1!==resp.Status?alertify.alert("SUCCESS!",resp.Response,()=>{loadViewPage()}):alertify.alert("WARNING!",resp.Response,()=>{}):alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()})})}function startEditProcess(id){holidayId=id,$.post(handlerURL,Object.assign(cmnOBJ.Holidays.Main,{holidayId:holidayId}),resp=>{!0!==resp.Redirect?!1!==resp.Status?(holidayOBJ.year=resp.Data.holiday_year,holidayOBJ.holiday=resp.Data.holiday_title,holidayOBJ.icon=resp.Data.icon,holidayOBJ.startDate=moment(resp.Data.from_date).format("MM-DD-YYYY"),holidayOBJ.endDate=moment(resp.Data.to_date).format("MM-DD-YYYY"),holidayOBJ.workOnHoliday=resp.Data.work_on_holiday,holidayOBJ.deactivate=resp.Data.is_archived,$("#js-year-edit").select2("val",holidayOBJ.year),$("#js-holiday-edit").val(holidayOBJ.holiday),$("#js-from-date-edit").val(holidayOBJ.startDate),$("#js-to-date-edit").val(holidayOBJ.endDate),$("#js-archive-check-edit").prop("checked",1==holidayOBJ.is_archived),$(`.allow_work_on_holiday-edit[value="${holidayOBJ.workOnHoliday}"]`).prop("checked",!0),null!=holidayOBJ.icon&&""!=holidayOBJ.icon&&($("#js-icon-plc-edit").prop("src",`${baseURL}assets/images/holidays/${holidayOBJ.icon}`),$("#js-icon-plc-box-edit").removeClass("hidden"),$("#js-holiday-icon-edit").val(holidayOBJ.icon))):alertify.alert("WARNING!",resp.Response,()=>{loadViewPage()}):alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()})}),ml(!1,"holiday")}holidayId=0,window.timeoff.startEditProcess=startEditProcess,$("#js-year-edit").change((function(e){$("#js-from-date-edit").val(""),$("#js-from-date-edit").datepicker("option","yearRange",getYearRange()),$("#js-from-date-edit").datepicker("option","defaultDate",moment().format("MM-DD-")+getYearRange("add",!0)),$("#js-to-date-edit").val(""),$("#js-to-date-edit").datepicker("option","yearRange",getYearRange()),$("#js-to-date-edit").datepicker("option","minDate",moment().format("MM-DD-")+getYearRange("add",!0))})),$("#js-icon-edit").click((function(e){e.preventDefault(),$("#js-holiday-icon-type").val("add"),Modal({Id:"jsModal2",Title:"Holiday Icons",Body:getIconBody("edit"),Buttons:['<button class="btn btn-success jsSaveIcon" data-type="edit">Update Icon</button>'],Loader:"jsModalEditIconLoader"},()=>{ml(!1,"jsModalEditIconLoader")})})),$(document).on("click",'.jsSaveIcon[data-type="edit"]',(function(e){if(e.preventDefault(),holidayOBJ.icon="",$("#js-icon-plc-edit").prop("src",""),$("#js-icon-plc-box-edit").addClass("hidden"),$("#js-holiday-icon-edit").val(0),0!=$(".js-icon-select.active").length){let type=$("#js-holiday-icon-type").val();$("#js-icon-plc-edit").prop("src",$(".js-icon-select.active").find("img").prop("src")),$("#js-icon-plc-box-edit").removeClass("hidden"),$("#js-holiday-icon-edit").val($(".js-icon-select.active").find("img").data("id")),holidayOBJ.icon=$(".js-icon-select.active").find("img").data("id")}$("#jsModal2").fadeOut(300).remove(),$("body").css("overflow-y","auto")})),$("#js-icon-remove-edit").click((function(){$("#js-icon-plc-edit").prop("src",!1),$("#js-icon-plc-box-edit").addClass("hidden"),$("#js-holiday-icon-edit").val(""),holidayOBJ.icon=""})),$("#js-save-edit-btn").click((function(e){return e.preventDefault(),holidayOBJ.holiday=getField("#js-holiday-edit"),holidayOBJ.startDate=getField("#js-from-date-edit"),holidayOBJ.endDate=getField("#js-to-date-edit"),holidayOBJ.workOnHoliday=getField(".allow_work_on_holiday-edit:checked"),holidayOBJ.deactivate=!0===$("#js-archive-check-edit").prop("checked")?1:0,0==holidayOBJ.holiday?(alertify.alert("WARNING!","Holiday is required.",()=>{}),!1):0==holidayOBJ.startDate?(alertify.alert("WARNING!","Please, select the holiday start date.",()=>{}),!1):0==holidayOBJ.endDate?(alertify.alert("WARNING!","Please, select the holiday end date.",()=>{}),!1):(holidayOBJ.year=moment(holidayOBJ.startDate).format("YYYY"),void updateHoliday(holidayOBJ))}))}));