let cmnOBJ={Categories:{Main:{action:"get_company_types_list",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}},Employees:{Main:{action:"get_company_employees",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}},Policies:{Main:{action:"get_policy_list_by_company",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}}};function getTypeNames(ids){if(0==ids.length)return"Not Assigned";if(0==window.timeoff.categories.length)return"Not Assigned";let row="";return window.timeoff.categories.map((function(v){v.type_id==ids&&(row=v.type_name+", ")})),row.substring(0,row.length-2)}function fetchCategories(){$.post(handlerURL,cmnOBJ.Categories.Main,(function(resp){if(!0===resp.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});if(!1===resp.Status)return void console.log("No categories found.");window.timeoff.categories=resp.Data;let rows="";rows+='<option value="-1" selected="true">All</option>',window.timeoff.categories.map((function(v){rows+=`<option value="${v.type_id}">${v.type_name}</option>`})),$("#js-filter-types").html(rows),$("#js-filter-types").select2()}))}function fetchPolicies(){$.post(handlerURL,cmnOBJ.Policies.Main,(function(resp){if(!0===resp.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});if(!1===resp.Status)return void console.log("Failed to load employees.");let rows="";window.timeoff.policies=resp.Data,rows+='<option value="all">All</option>',resp.Data.map((function(v){rows+=`<option value="${v.policy_id}">${v.policy_title}</option>`})),$("#js-filter-policies").html(rows),$("#js-filter-policies").select2(),$("#js-policies-add").html(rows),$("#js-policies-edit").html(rows)}))}function loadAddPage(){page="add",ml(!0,"type"),$(".js-page").fadeOut(0),$("#js-page-add").fadeIn(500),$("#js-type-add").val(""),$("#js-policies-add").select2(),$("#js-policies-add").select2("val",null),$("#js-archived-add").prop("checked",!1),ml(!1,"type")}function loadViewPage(){page="view",ml(!0,"policy"),$(".js-page").fadeOut(0),$("#js-page-view").fadeIn(500),window.timeoff.fetchCompanyTypes()}function loadEditPage(typeId){page="edit",ml(!0,"type"),$(".js-page").fadeOut(0),$("#js-page-edit").fadeIn(500),void 0!==window.timeoff.policies?($("#js-type-edit").val(""),$("#js-policies-edit").select2(),$("#js-policies-edit").select2("val",null),$("#js-archived-edit").prop("checked",!1),window.timeoff.startEditprocess(typeId)):setTimeout(loadEditPage,2e3)}fetchCategories(),fetchPolicies(),"add"==page&&loadAddPage(),$("#js-add-type-btn").click(e=>{e.preventDefault(),loadAddPage()}),$(".js-view-type-btn").click((function(e){e.preventDefault(),alertify.confirm("WARNING!","Any unsaved changes will be lost.",loadViewPage,()=>{}).set("labels",{ok:"Leave",cancel:"No, I will stay"})})),$(document).on("click",".js-edit-row-btn",e=>{e.preventDefault(),loadEditPage($(e.target).closest(".jsBox").data("id"))});