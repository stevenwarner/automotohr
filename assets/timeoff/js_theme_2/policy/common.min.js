let cmnOBJ={Categories:{Main:{action:"get_company_types_list",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}},Employees:{Main:{action:"get_company_employees",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}},Policies:{Main:{action:"get_policy_list_by_company",companyId:companyId,employerId:employerId,employeeId:employeeId,public:0}}},redirectPage=!0;function getTypeNames(ids){if(0==ids.length)return"Not Assigned";if(0==window.timeoff.categories.length)return"Not Assigned";let row="";return window.timeoff.categories.map((function(v){v.type_id==ids&&(row=v.type_name+", ")})),row.substring(0,row.length-2)}function fetchCategories(){$.post(handlerURL,cmnOBJ.Categories.Main,(function(resp){if(!0===resp.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});if(!1===resp.Status)return alertify.alert("Warning!","No policy types found. Please, add a type before creating policies.",(function(){$('.jsIPLoader[data-page="policy"]').hide(0)}));window.timeoff.categories=resp.Data;let rows="";rows+='<option value="0" selected="true">[Please select a policy type]</option>',window.timeoff.categories.map((function(v){rows+=`<option value="${v.type_id}">${v.type_name}</option>`})),$("#js-category-add, #js-category-edit, #js-category-reset").html(rows)}))}function fetchEmployees(){$.post(handlerURL,cmnOBJ.Employees.Main,(function(resp){if(!0===resp.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});if(!1===resp.Status)return void console.log("Failed to load employees.");window.timeoff.employees=resp.Data;let rows="";rows+='<option value="all">All</option>',window.timeoff.employees.map((function(v){rows+='<option value="'+v.user_id+'">'+remakeEmployeeName(v)+"</option>"})),$("#js-employee-add").html(rows),$("#js-employee-add").select2(),$("#js-employee-add").select2MultiCheckboxes({templateSelection:function(selected,total){return total--,"Selected "+(-1!==$.inArray("all",$("#js-employee-add").val())?total:selected.length)+" of "+total}}),$("#js-employee-edit").html(rows),$("#js-employee-reset").html(rows),$("#js-filter-employee").html(rows),$("#js-filter-employee").select2()}))}function fetchPolicies(){$.post(handlerURL,cmnOBJ.Policies.Main,(function(resp){if(!0===resp.Redirect)return void alertify.alert("WARNING!","Your session expired. Please, re-login to continue.",()=>{window.location.reload()});if(!1===resp.Status)return void console.log("Failed to load employees.");let rows="";rows+='<option value="all">All</option>',resp.Data.map((function(v){rows+=`<option value="${v.policy_id}">${v.policy_title} (${1==v.category_type?"Paid":"Unpaid"}) </option>`})),$("#js-filter-policies").html(rows),$("#js-filter-policies").select2()}))}function getAccrualText(accrualOBJ,isNewHire){let method=null==accrualOBJ.method?"days_per_year":accrualOBJ.method,frequency=null===accrualOBJ.frequency?"none":accrualOBJ.frequency,time=null==accrualOBJ.time?"none":accrualOBJ.time,rate=null==accrualOBJ.rate?0:accrualOBJ.rate,rateType=accrualOBJ.rateType,frequencyVal=accrualOBJ.frequencyVal,text=void 0===isNewHire?"The entitled employee(s) will have {{accrue}} that can be accrued from {{time}}.":"The entitled employee(s) (on probation) will have {{accrue}} that can be accrued from {{time}}.",accrue="",o={days:{none:"Jan to Dec",start_of_period:"Jan to June",end_of_period:"July to Dec"},time:{none:"1st to 30th",start_of_period:"1st to 15th",end_of_period:"16th to 30th"}};if(void 0!==isNewHire&&(rate=accrualOBJ.newHireRate,null!=rate&&0!=rate||(rate=accrualOBJ.rate)),time="none"==frequency?o.days[time]:o.time[time],0==rate)return accrue=' "Unlimited" days per year',text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time);if("hours_per_month"==method&&"none"==frequency)return accrue=` ${rate} hour${rate>1?"s":""} per year`,duration=` ${time}.`,text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time);if("hours_per_month"==method&&"yearly"==frequency){let newRate=("total_hours"==rateType?rate/12:12*rate).toFixed(2);return accrue="total_hours"==rateType?` ${rate} hour${rate>1?"s":""} per year with an accrue rate of ${newRate} hour${newRate>1?"s":""} per month`:` ${newRate} hour${newRate>1?"s":""} per year with an accrue rate of ${rate} hour${rate>1?"s":""} per month`,time=`${time} of each month`,text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time)}if("hours_per_month"==method&&"monthly"==frequency){let newRate=rate;return accrue=` ${rate} hour${rate>1?"s":""} each month`,duration=` ${time}.`,text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time)}if("hours_per_month"==method&&"custom"==frequency){let slots,frequencyValC=rate/(12/frequencyVal);return frequencyValC=frequencyValC.toFixed(2),accrue=` ${frequencyValC} hour${frequencyValC>1?"s":""} every ${frequencyVal} month${frequencyVal>1?"s":""}`,duration=` ${time}.`,text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time)}return"-"}function setAccrualText(){let method="hours_per_month",frequency=$(`#js-accrual-frequency-${page}`).val(),time=$(`#js-accrual-time-${page} option:selected`).text(),rate=""==$(`#js-accrual-rate-${page}`).val()?0:$(`#js-accrual-rate-${page}`).val(),rateType=$(`#js-accrual-rate-type-${page} option:selected`).val(),frequencyVal=$(`#js-accrual-frequency-val-${page}`).val(),text="The entitled employee(s) will have {{accrue}} that can be accrued from {{time}}.",accrue="";if($(`.js-plan-btn-${page}`).prop("disabled",!1),$(`#js-accrual-time-text-${page}`).html("<i>The accrual time can't be set for unlimited policies.</i>"),$(`#js-accrual-time-text-${page}`).hide(),$(`#js-accrual-time-${page}`).prop("disabled",!1),$(`#js-accrual-frequency-${page}`).prop("disabled",!1),$(`.js-policy-reset-date-${page}`).prop("disabled",!1),$(`#js-accrual-rate-type-${page}`).html('<option value="total_hours">Total Hour(s)</option><option value="hours">Hour(s)</option>'),$(`.jsTimeTypeSelect-${page}`).find("option").remove(),$(`.jsTimeType-${page}`).text("Hour(s)"),$(`.jsTimeTypeSelect-${page}`).append(`\n        <option value="total_hours" ${null==rateType||"total_hours"==rateType?'selected="true"':""}>Total Hour(s)</option>\n        <option value="hours_per_month" ${"hours_per_month"==rateType?'selected="true"':""}>Hour(s) /month</option>\n    `),time=$(`#js-accrual-time-${page} option:selected`).text(),0!=rate&&"none"==frequency&&($(`.jsTimeTypeSelect-${page} option[value="total_hours"]`).prop("checked",!0),$(`.jsTimeTypeSelect-${page} option[value="hours_per_month"]`).remove(),accrue=` ${rate} hour${rate>1?"s":""} per year `,text=text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time)),0!=rate&&"yearly"==frequency){let newRate=("total_hours"==rateType?rate/12:12*rate).toFixed(2);newRate=newRate,accrue="total_hours"==rateType?` ${rate} hour${rate>1?"s":""} per year with an accrue rate of ${newRate} hour${newRate>1?"s":""} per month`:` ${newRate} hour${newRate>1?"s":""} per year with an accrue rate of ${rate} hour${rate>1?"s":""} per month`,duration=` ${time}.`,text=text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time)}if(0!=rate&&"monthly"==frequency){$(`.jsTimeTypeSelect-${page} option[value="total_hours"]`).prop("checked",!0),$(`.jsTimeTypeSelect-${page} option[value="hours_per_month"]`).remove();let newRate=rate;accrue=` ${rate} hour${rate>1?"s":""} each month`,text=text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,time)}if(0!=rate&&"custom"==frequency){$(`.jsTimeTypeSelect-${page} option[value="total_hours"]`).prop("checked",!0),$(`.jsTimeTypeSelect-${page} option[value="hours_per_month"]`).remove();let slots,frequencyValC=rate/(12/frequencyVal);frequencyValC=frequencyValC.toFixed(2),accrue=` ${frequencyValC} hour${frequencyValC>1?"s":""} every ${frequencyVal} month${frequencyVal>1?"s":""}`,text=text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,"").replace(/that can be accrued from/g,""),$(`#js-accrual-time-${page}`).prop("disabled",!0),$(`#js-accrual-time-text-${page}`).html("<i>The accrual time can't be set for custom frequency.</i>"),$(`#js-accrual-time-text-${page}`).show()}0==rate&&(accrue=' "Unlimited" hours per month',text=text.replace(/{{accrue}}/g,accrue).replace(/{{time}}/g,"").replace(/ that can be accrued from/g,""),$(`#js-accrual-time-text-${page}`).show(),$(`#js-accrual-time-${page}`).prop("disabled",!0),$(`#js-accrual-frequency-${page}`).prop("disabled",!0),$(`.js-plan-btn-${page}`).prop("disabled",!0),$(`.js-plan-area-${page}`).html("")),null===text.match("{{")?$(`#jsFormula-${page}`).text(text):$(`#jsFormula-${page}`).text("")}function setNewHireAccrual(pageType){"object"==typeof pageType&&(pageType=void 0),pageType=void 0===pageType?page:pageType;let duration=$(`#js-accrue-new-hire-${pageType}`).val().trim(),rate=$(`#js-newhire-prorate-${pageType}`).val().trim(),type=$(`#js-accrual-new-hire-time-type-${pageType} option:selected`).val(),target=$(`.js-newhire-text-${pageType}`),msg="";"add"==pageType&&(type=$("#js-accrual-new-hire-time-type option:selected").val()),(""==duration||duration<0||null!==duration.match(/[^0-9]/))&&(duration=0),(""==rate||rate<0||null!==rate.match(/[^0-9]/))&&(rate=0),"per_month"==type?msg=`The employees that are working ${duration} hour${1==duration?"":"s"} per month will be considered as permanent.`:"per_week"==type?msg=`The employees that are working ${duration} hour${1==duration?"":"s"} per week will be considered as permanent.`:"months"==type?msg=`The employees that have worked for ${duration} month${1==duration?"":"s"} will be considered as permanent.`:"days"==type?msg=`The employees that have worked for ${duration} day${1==duration?"":"s"} will be considered as permanent.`:"hours"==type&&(msg=`The employees that have worked for ${duration} hour${1==duration?"":"s"} will be considered as permanent.`),msg+=`The employees that are on probation can use ${0==rate?"0":rate} ${null!==$(`.jsTimeType-${pageType}`).text().match(/hour/gi)?"hour":"day"}${1==rate?"":"s"}.`,target.html(msg)}function loadAccrualPlans(type,plans){type=void 0===type?"add":type;var rows="",dt="hours(s)",yt="year(s)";if(void 0!==plans&&0!==plans.length)return void 0!==plans[0]&&plans.map((function(plan){rows+='<div class="js-plan-row-'+type+'" style="padding: 20px 0 10px;">',rows+="    <span>Allow</span>",rows+='    <div class="form-group form-group-custom form-group-custom-settings csIn50">',rows+='        <input class="form-control form-control-custom js-pt js-plan-type-'+type+'" value="'+plan.accrualRate+'" />',rows+='    </div><span> extra <span class="js-plan-type">'+dt+"</span> after </span>",rows+='    <div class="form-group form-group-custom form-group-custom-settings csIn50">',rows+='        <input class="form-control form-control-custom js-py js-plan-year-'+type+'" value="'+plan.accrualType+'" />',rows+="    </div>",rows+='    <div class="form-group form-group-custom form-group-custom-settings csIn50 csW100">',rows+='        <select class="form-control form-control-custom js-pyt js-plan-duration-'+type+'"><option value="months" '+("months"==plan.accrualTypeM?'selected="true"':"")+'>Month(s)</option><option value="years" '+("years"==plan.accrualTypeM?'selected="true"':"")+">Year(s)</option></select>",rows+="    </div>",rows+='    <span class="label label-danger js-plan-remove-btn" title="Remove the accrual plan" placement="top"><i class="fa fa-close"></i></span>',rows+="</div>"})),void $("#js-plan-area-"+type).html(rows);void 0===plans&&(rows+='<div class="js-plan-row-'+type+'" style="padding: 20px 0 10px;">',rows+="    <span>Allow</span>",rows+='    <div class="form-group form-group-custom form-group-custom-settings csIn50">',rows+='        <input class="form-control form-control-custom js-pt js-plan-type-'+type+'" />',rows+='    </div><span> extra <span class="js-plan-type">'+dt+"</span> after </span>",rows+='    <div class="form-group form-group-custom form-group-custom-settings csIn50">',rows+='        <input class="form-control form-control-custom js-py js-plan-year-'+type+'" />',rows+="    </div>",rows+='    <div class="form-group form-group-custom form-group-custom-settings csIn50 csW100">',rows+='        <select class="form-control form-control-custom  js-pyt js-plan-duration-'+type+'"><option value="months">Month(s)</option><option value="years" selected="true">Year(s)</option></select>',rows+="    </div>",rows+='    <span class="label label-danger js-plan-remove-btn" title="Remove the accrual plan" placement="top"><i class="fa fa-close"></i></span>',rows+="</div>",$("#js-plan-area-"+type).append(rows))}function makePlanRow(planId,type){var plan=getPlanFromArray(planId);if(0!=plan.length){var rows="",slot=formatMinutes(plan.format,plan.default_timeslot,plan.allowed_timeoff,!1,!0),format=plan.format.split(":");rows+='<li data-id="'+plan.plan_id+'" data-timeslot="'+plan.default_timeslot+'" data-format="'+plan.format+'" class="js-plan-row-'+type+'">',rows+='    <div class="timeline-content margin-right">',rows+='        <h4 class="timeline-field-title">'+getPlanTitle(plan)+' <span title="Remove Plan" class="pull-right text-danger js-remove-plan-'+type+'"><i class="fa fa-close"></i></span></h4>',rows+='        <div class="row">',-1!=format.indexOf("D")&&(rows+='            <div class="col-lg-6 col-sm-6 col-xs-12">',rows+='                <div class="input-group pto-time-off-margin-custom">',rows+='                    <input type="text" class="form-control js-days-'+type+'" value="'+slot.D+'" />',rows+='                    <span class="input-group-addon">Days</span>',rows+="                </div>",rows+="            </div>"),-1!=format.indexOf("H")&&(rows+='            <div class="col-lg-6 col-sm-6 col-xs-12">',rows+='                <div class="input-group pto-time-off-margin-custom">',rows+='                    <input type="text" class="form-control js-hours-'+type+'" value="'+slot.H+'" />',rows+='                    <span class="input-group-addon">Hours</span>',rows+="                </div>",rows+="            </div>"),-1!=format.indexOf("M")&&(rows+='            <div class="col-lg-6 col-sm-6 col-xs-12">',rows+='                <div class="input-group pto-time-off-margin-custom">',rows+='                    <input type="text" class="form-control js-minutes-'+type+'" value="'+slot.M+'" />',rows+='                    <span class="input-group-addon">Minutes</span>',rows+="                </div>",rows+="            </div>"),rows+="        </div>",rows+="    </div>",rows+="</li>",$("#js-plan-area-"+type).append(rows)}else alertify.alert("ERROR!","Plan with Id "+planId+" not found.")}function removePlan(planId,type){$('li[data-id="'+planId+'"]').remove()}function isStepCompleted(step,type){return"add"==page||"add"==type?window.timeoff.stepCompletedAdd(step):"edit"==page||"edit"==type?window.timeoff.stepCompletedEdit(step):"reset"==page||"reset"==type?window.timeoff.stepCompletedReset(step):void 0}function loadTemplate(templateId){let o={method:"hours_per_month",time:"none",frequency:"none",frequencyMonths:0,rate:0,rateType:"hours_per_month"};10==templateId&&(o.method="hours_per_month",o.time="none",o.frequency="yearly",o.rate=24),11==templateId&&(o.method="hours_per_month",o.time="start_of_period",o.frequency="yearly",o.rate=24),12==templateId&&(o.method="hours_per_month",o.time="end_of_period",o.frequency="yearly",o.rate=24),13==templateId&&(o.method="hours_per_month",o.time="none",o.frequency="yearly",o.rate=3.33,o.rateType="hours_per_month"),14==templateId&&(o.method="hours_per_month",o.time="start_of_period",o.frequency="yearly",o.rate=3.33,o.rateType="hours_per_month"),15==templateId&&(o.method="hours_per_month",o.time="end_of_period",o.frequency="yearly",o.rate=3.33,o.rateType="hours_per_month"),16==templateId&&(o.method="hours_per_month",o.time="none",o.frequency="custom",o.rate=24,o.frequencyMonths=4),17==templateId&&(o.method="hours_per_month",o.time="start_of_period",o.frequency="custom",o.rate=24,o.frequencyMonths=4),18==templateId&&(o.method="hours_per_month",o.time="end_of_period",o.frequency="custom",o.rate=24,o.frequencyMonths=4),19==templateId&&(o.method="hours_per_month",o.time="none",o.frequency="none",o.rate=40,o.frequencyMonths=0),$(`#js-accrual-time-${page}`).select2("val",o.time),$(`#js-accrual-time-${page}`).trigger("change"),$(`#js-accrual-frequency-${page}`).select2("val",o.frequency),$(`#js-accrual-frequency-${page}`).trigger("change"),0!=o.frequencyMonths&&$(`#js-accrual-frequency-val-${page}`).val(o.frequencyMonths),0!=o.rateType&&$(`#js-accrual-rate-type-${page}`).val(o.rateType),$(`#js-accrual-rate-${page}`).val(o.rate).trigger("keyup")}function finalStep(type){return"add"==page||"add"==type?window.timeoff.finalStepCompletedAdd(getStep()):"edit"==page||"edit"==type?window.timeoff.finalStepCompletedEdit(getStep()):"reset"==page||"reset"==type?window.timeoff.finalStepCompletedReset(getStep()):void 0}function saveStep(d){return localStorage.setItem(`${page}Policy`,JSON.stringify(d))}function getStep(d){return JSON.parse(localStorage.getItem(`${page}Policy`))}function removeStep(d){return localStorage.removeItem(`${page}Policy`)}function loadAddPage(){page="add",ml(!0,"policy"),$(".js-page").fadeOut(0),$("#js-page-add").fadeIn(500),void 0!==window.timeoff.categories&&void 0!==window.timeoff.employees?($(".js-template-add").prop("checked",!1),$('.js-template-add[value="0"]').prop("checked",!0),$("#js-category-add").select2(),$("#js-category-add").select2("val",0),$("#js-policy-type-add").select2({minimumResultsForSearch:-1}),$("#js-policy-type-add").select2("val",1),$("#js-policy-title-add").val(),$("#js-sort-order-add").val(1),$("#js-employee-add").select2(),$("#js-employee-add").select2("val",0),$("#js-employee-add").select2MultiCheckboxes({templateSelection:function(selected,total){return total-=1,"Selected "+(-1!==$.inArray("all",$("#js-employee-add").val())?total:selected.length)+" of "+total}}),$("#js-employee-type-add").select2(),$("#js-employee-type-add").select2("val","all"),$("#js-off-days-add").select2({closeOnSelect:!1}),$("#js-off-days-add").select2("val",null),$("#js-approver-check-add").prop("checked",!1),$("#js-archive-check-add").prop("checked",!1),$("#js-include-check-add").prop("checked",!0),$("#js-accrual-time-add").select2({minimumResultsForSearch:-1}),$("#js-accrual-time-add").select2("val","none"),$("#js-accrual-time-add").trigger("change"),$("#js-accrual-frequency-add").select2({minimumResultsForSearch:-1}),$("#js-accrual-frequency-add").select2("val","none"),$("#js-accrual-frequency-add").trigger("change"),$("#js-accrual-frequency-val-add").val(1),$("#js-accrual-rate-add").val(0),$('#js-accrual-rate-type-add option[value="days"]').prop("selected",!0),$("#js-minimum-applicable-hours-add").val(0),$('.js-minimum-applicable-time-add[value="hours"]').prop("checked",!0).trigger("click"),$("#js-carryover-cap-check-add").select2({minimumResultsForSearch:-1}),$("#js-carryover-cap-check-add").select2("val","no"),$("#js-carryover-cap-check-add").trigger("change"),$("#js-carryover-cap-add").val(0),$("#js-accrual-balance-add").select2({minimumResultsForSearch:-1}),$("#js-accrual-balance-add").select2("val","no"),$("#js-accrual-balance-add").trigger("change"),$("#js-maximum-balance-add").val(0),$('.js-hire-date-add[value="hireDate"]').prop("checked",!0).trigger("click"),$('.js-policy-reset-date-add[value="policyDate"]').prop("checked",!0).trigger("click"),$("#js-accrue-new-hire-add").val(0),$("#js-newhire-prorate-add").val(0),$("#js-plan-box-add").show(),$("#js-plan-box-add").find("ul").html(""),$("#js-plan-area-add").html(""),$(".jsPlanArea").html(""),$(".js-hint").hide(0),$("#js-custom-date-add").datepicker({dateFormat:"mm-dd-yy",changeYear:!0,changeMonth:!0,onSelect:d=>{d<=moment().format("MM-DD-YYYY")?$("#js-applicable-date-text-add").show():$("#js-applicable-date-text-add").hide()}}),$("#js-custom-reset-date-add").datepicker({dateFormat:"mm-dd-yy",changeYear:!0,changeMonth:!0}),$(".js-step").hide(),$('.js-step[data-step="0"]').show(),ml(!1,"policy")):setTimeout(loadAddPage,2e3)}function loadViewPage(){page="view",ml(!0,"policy"),$(".js-page").fadeOut(0),$("#js-page-view").fadeIn(500),window.timeoff.fetchCompanyPolicies()}function loadEditPage(){localStorage.clear(),page="edit",ml(!0,"policy"),$(".js-page").fadeOut(0),$("#js-page-edit").fadeIn(500),void 0!==window.timeoff.categories&&void 0!==window.timeoff.employees?($("#js-policy-type-edit").select2({minimumResultsForSearch:-1}),$("#js-policy-type-edit").select2("val",1),$("#js-category-edit").select2(),$("#js-category-edit").select2("val",0),$("#js-policy-title-edit").val(""),$("#js-sort-order-edit").val(1),$("#js-employee-edit").select2(),$("#js-employee-edit").select2("val",0),$("#js-employee-edit").select2MultiCheckboxes({templateSelection:function(selected,total){return total-=1,"Selected "+(-1!==$.inArray("all",$("#js-employee-edit").val())?total:selected.length)+" of "+total}}),$("#js-employee-type-edit").select2(),$("#js-employee-type-edit").select2("val","all"),$("#js-off-days-edit").select2({closeOnSelect:!1}),$("#js-off-days-edit").select2("val",null),$("#js-approver-check-edit").prop("checked",!1),$("#js-archive-check-edit").prop("checked",!1),$("#js-include-check-edit").prop("checked",!0),$("#js-accrual-time-edit").select2({minimumResultsForSearch:-1}),$("#js-accrual-time-edit").select2("val","none"),$("#js-accrual-time-edit").trigger("change"),$("#js-accrual-frequency-edit").select2({minimumResultsForSearch:-1}),$("#js-accrual-frequency-edit").select2("val","none"),$("#js-accrual-frequency-edit").trigger("change"),$("#js-accrual-frequency-val-edit").val(1),$("#js-accrual-rate-edit").val(0),$('#js-accrual-rate-type-edit option[value="days"]').prop("selected",!0),$("#js-minimum-applicable-hours-edit").val(0),$('.js-minimum-applicable-time-edit[value="hours"]').prop("checked",!0).trigger("click"),$("#js-carryover-cap-check-edit").select2({minimumResultsForSearch:-1}),$("#js-carryover-cap-check-edit").select2("val","no"),$("#js-carryover-cap-check-edit").trigger("change"),$("#js-carryover-cap-edit").val(0),$("#js-accrual-balance-edit").select2({minimumResultsForSearch:-1}),$("#js-accrual-balance-edit").select2("val","no"),$("#js-accrual-balance-edit").trigger("change"),$("#js-maximum-balance-edit").val(0),setTimeout(()=>{$('.js-hire-date-edit[value="hireDate"]').prop("checked",!0),$(".jsImplementDateBox-edit").hide(),$('.js-policy-reset-date-edit[value="policyDate"]').prop("checked",!0).trigger("change")},0),$("#js-accrue-new-hire-edit").val(0),$("#js-newhire-prorate-edit").val(0),$("#js-plan-box-edit").show(),$("#js-plan-box-edit").find("ul").html(""),$("#js-plan-area-edit").html(""),$(".jsPlanArea").html(""),$(".js-hint").hide(0),$("#js-custom-date-edit").datepicker({dateFormat:"mm-dd-yy",changeYear:!0,changeMonth:!0,onSelect:d=>{d<=moment().format("MM-DD-YYYY")?$("#js-applicable-date-text-edit").show():$("#js-applicable-date-text-edit").hide()}}),$("#js-custom-reset-date-edit").datepicker({dateFormat:"mm-dd-yy",changeYear:!0,changeMonth:!0}),$(".js-step").hide(),$('.js-step[data-step="1"]').show(),$('.js-step-tab[data-type="edit"]').parent().removeClass("active"),$('.js-step-tab[data-type="edit"][data-step="1"]').parent().addClass("active"),$('.js-step-tab[data-type="reset"]').parent().removeClass("active"),$('.js-step-tab[data-type="reset"][data-step="1"]').parent().addClass("active"),loadResetPage(),$(".jsEditResetCheckbox[data-type='cp']").trigger("click")):setTimeout(loadEditPage,2e3)}function loadResetPage(){$("#js-category-reset").select2().prop("disabled",!0),$("#js-category-reset").select2("val",0),$("#js-policy-title-reset").val("").prop("disabled",!0),$("#js-sort-order-reset").val(1).prop("disabled",!0),$("#js-employee-reset").select2().prop("disabled",!0),$("#js-employee-reset").select2("val",0),$("#js-employee-reset").select2MultiCheckboxes({templateSelection:function(selected,total){return total-=1,"Selected "+(-1!==$.inArray("all",$("#js-employee-reset").val())?total:selected.length)+" of "+total}}),$("#js-employee-type-reset").select2(),$("#js-employee-type-reset").select2("val","all"),$("#js-approver-check-reset").prop("checked",!1).prop("disabled",!0),$("#js-archive-check-reset").prop("checked",!1).prop("disabled",!0),$("#js-include-check-reset").prop("checked",!0).prop("disabled",!0),$("#js-accrual-time-reset").select2({minimumResultsForSearch:-1}),$("#js-accrual-time-reset").select2("val","none"),$("#js-accrual-time-reset").trigger("change"),$("#js-accrual-frequency-reset").select2({minimumResultsForSearch:-1}),$("#js-accrual-frequency-reset").select2("val","none"),$("#js-accrual-frequency-reset").trigger("change"),$("#js-accrual-frequency-val-reset").val(1),$("#js-accrual-rate-reset").val(0),$('#js-accrual-rate-type-reset option[value="days"]').prop("selected",!0),$("#js-minimum-applicable-hours-reset").val(0),$('.js-minimum-applicable-time-reset[value="hours"]').prop("checked",!0).trigger("click"),$("#js-carryover-cap-check-reset").select2({minimumResultsForSearch:-1}),$("#js-carryover-cap-check-reset").select2("val","no"),$("#js-carryover-cap-check-reset").trigger("change"),$("#js-carryover-cap-reset").val(0),$("#js-accrual-balance-reset").select2({minimumResultsForSearch:-1}),$("#js-accrual-balance-reset").select2("val","no"),$("#js-accrual-balance-reset").trigger("change"),$("#js-maximum-balance-reset").val(0),setTimeout(()=>{$('.js-hire-date-reset[value="hireDate"]').prop("checked",!0),$(".jsImplementDateBox-reset").hide(),$('.js-policy-reset-date-reset[value="policyDate"]').prop("checked",!0).trigger("change")},0),$("#js-accrue-new-hire-reset").val(0),$("#js-newhire-prorate-reset").val(0),$("#js-custom-date-reset").datepicker({dateFormat:"mm-dd-yy",changeYear:!0,changeMonth:!0,onSelect:d=>{d<=moment().format("MM-DD-YYYY")?$("#js-applicable-date-text-reset").show():$("#js-applicable-date-text-reset").hide()}}),$("#js-custom-reset-date-reset").datepicker({dateFormat:"mm-dd-yy",changeYear:!0,changeMonth:!0}),window.timeoff.startPolicyEditProcess()}fetchCategories(),fetchEmployees(),fetchPolicies(),"add"==page&&loadAddPage(),$(".js-step").fadeOut(300),$('.js-step[data-step="1"]').fadeIn(300),$(".jsViewPoliciesBtn").click((function(e){e.preventDefault(),alertify.confirm("WARNING!","Any unsaved changes will be lost.",loadViewPage,()=>{}).set("labels",{ok:"Leave",cancel:"No, I will stay"})})),$(document).on("click",".js-to-step",(function(e){e.preventDefault(),ml(!0,"policy");let step=$(this).closest("div").data("step"),type=$(this).closest("div").data("type");if(1===step){$("#js-step-bar-add").hide();let templateId=$(".js-template-add:checked").val();if(void 0===templateId)return alertify.alert("WARNING!","Please, select a template.",()=>{}),void ml(!1,"policy");0!=templateId&&loadTemplate(templateId),$("#js-step-bar-add").show()}else isStepCompleted(step-1,type)||(step-=1);if(8===step)return redirectPage=!1,void finalStep(type);$(`.js-step-tab[data-type="${type}"]`).parent("li").removeClass("active"),$(`.js-step-tab[data-type="${type}"][data-step="${step}"]`).parent("li").addClass("active"),$(`.js-step-tab[data-type="${type}"]`).find("i").remove(),$(`.js-step-tab[data-type="${type}"][data-step="${step}"]`).append('<i class="fa fa-long-arrow-right"></i>'),$(`.js-step[data-type="${type}"]`).fadeOut(0),$(`.js-step[data-type="${type}"][data-step="${step}"]`).fadeIn(300),$("body, html").animate({scrollTop:0},0),ml(!1,"policy")})),$(document).on("click",".js-to-step-back",(function(e){e.preventDefault(),ml(!0,"policy");let step=$(this).closest("div").data("step"),type=$(this).closest("div").data("type");$(`.js-step-tab[data-type="${type}"]`).parent("li").removeClass("active"),$(`.js-step-tab[data-type="${type}"][data-step="${step-2}"]`).parent("li").addClass("active"),$(`.js-step-tab[data-type="${type}"]`).find("i").remove(),$(`.js-step-tab[data-type="${type}"][data-step="${step-2}"]`).append('<i class="fa fa-long-arrow-right"></i>'),$(`.js-step[data-type="${type}"]`).fadeOut(0),$(`.js-step[data-type="${type}"][data-step="${step-2}"]`).fadeIn(300),ml(!1,"policy")})),$(document).on("click",".js-step-tab",(function(e){e.preventDefault(),ml(!0,"policy");let step=$(this).data("step"),type=$(this).data("type");isStepCompleted(1,type)?isStepCompleted(2,type)?isStepCompleted(3,type)?isStepCompleted(4,type)?isStepCompleted(5,type)?isStepCompleted(6,type)?isStepCompleted(7,type)||(step=7):step=6:step=5:step=4:step=3:step=2:step=1,$(`.js-step-tab[data-type="${type}"]`).parent("li").removeClass("active"),$(`.js-step-tab[data-type="${type}"][data-step="${step}"]`).parent("li").addClass("active"),$(`.js-step-tab[data-type="${type}"]`).find("i").remove(),$(`.js-step-tab[data-type="${type}"][data-step="${step}"]`).append('<i class="fa fa-long-arrow-right"></i>'),$(`.js-step[data-type="${type}"]`).fadeOut(0),$(`.js-step[data-type="${type}"][data-step="${step}"]`).fadeIn(300),ml(!1,"policy")})),$("#js-add-policy-btn").click(e=>{e.preventDefault(),loadAddPage(),$("#NonEntitledEmployeesadd").prop("checked",!0)});