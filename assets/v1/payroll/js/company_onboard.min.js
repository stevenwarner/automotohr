$((function(){let e=0,n="jsCreatePartnerCompanyModal",l=null,a={checkRequirements:function(){null!==l&&l.abort();l=$.ajax({url:window.location.origin+"/payroll/company/"+e+"/requirements",method:"GET"}).success((function(){l=null,a.welcomeStep()})).fail(r)},welcomeStep:function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/1/"+e,method:"GET"}).success((function(e){if(l=null,$(`#${n}Body`).html(e.view),void 0!==e.onboard){if("terms"===e.onboard)return a.gustoTerms();window.location.reload()}_ml(!1,n+"Loader"),$(".jsPayrollLoadSelectEmployees").click((function(e){e.preventDefault(),_ml(!0,n+"Loader"),a.employeeListingStep()}))})).fail(r)},employeeListingStep:function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/2/"+e,method:"GET"}).success((function(e){l=null,$(`#${n}Body`).html(e.view),_ml(!1,n+"Loader"),$(".jsPayrollLoadOnboard").click((function(e){e.preventDefault(),function(){if(t=[],$(".jsEmployeesList:checked").map((function(){t.push($(this).val())})),!t.length)return alertify.alert("ERROR","Please select at least one employee.",CB);_ml(!0,n+"Loader"),a.adminStep()}()})),$(".jsBackToStep1").click((function(e){e.preventDefault(),_ml(!0,n+"Loader"),a.welcomeStep()}))})).fail(r)},adminStep:function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/3/"+e,method:"GET"}).success((function(t){l=null,$(`#${n}Body`).html(t.view),_ml(!1,n+"Loader"),$(".jsPayrollSetAdmin").click((function(a){a.preventDefault(),function(){if(null!==l)return!1;l=$.ajax({url:window.location.origin+"/payroll/cpc/4/"+e,method:"GET"}).success((function(e){l=null,$(`#${n}Body`).html(e.view),_ml(!1,n+"Loader")})).fail(r)}()})),$(".jsBackToStep2").click((function(e){e.preventDefault(),_ml(!0,n+"Loader"),a.employeeListingStep()}))})).fail(r)},createPartnerCompany:i},t=[];function i(){l=$.ajax({url:window.location.origin+"/payroll/cpc/7/"+e,method:"POST",data:{employees:t}}).success((function(){l=null,gustoServiceAgreement(e)})).fail(o)}function o(e){return _ml(!1,n+"Loader"),l=null,handleErrorResponse(e)}function r(e){return $(`#${n} .jsModalCancel`).trigger("click"),handleErrorResponse(e)}$(document).on("click",".jsModalCancel",(function(){l=null})),$(".jsCreatePartnerCompanyBtn").click((function(l){if(l.preventDefault(),e=parseInt($(this).data("cid")),0===e)return alertify.alert("ERROR","Company code is missing.",CB);Modal({Id:n,Title:"",Loader:n+"Loader",Body:`<div id="${n}Body"></div>`},a.checkRequirements)})),$(document).on("click",".jsPayrollViewAdminDetails",(function(a){a.preventDefault(),_ml(!0,n+"Loader"),l=$.ajax({url:window.location.origin+"/payroll/cpc/6/"+e,method:"GET"}).success((function(e){l=null,$(`#${n}Body`).html(e.view),_ml(!1,n+"Loader")})).fail(r)})),$(document).on("click",".jsPayrollSaveAdmin",(function(t){t.preventDefault(),function(){let t={firstName:$(".jsAdminFirstName").val().trim(),lastName:$(".jsAdminLastName").val().trim(),email:$(".jsAdminEmailAddress").val().trim(),id:$(".jsAdminUserId").val().trim()},i=[];t.firstName||i.push('"First name" is missing.');t.lastName||i.push('"Last name" is missing.');t.email||i.push('"Email" is missing.');t.email.verifyEmail()||i.push('"Email" is invalid.');if(i.length)return alertify.alert("ERROR",getErrorsStringFromArray(i),CB);_ml(!0,n+"Loader"),l=$.ajax({url:window.location.origin+"/payroll/cpc/5/"+e,method:"POST",data:t}).success((function(){return l=null,alertify.alert("SUCCESS","Congratulations! You have successfully added a payroll admin for the company.",(function(){a.adminStep()}))})).fail(o)}()})),$(document).on("click",".jsBackToStep3",(function(e){e.preventDefault(),_ml(!0,n+"Loader"),a.adminStep()})),$(document).on("click",".jsCreatePartnerCompanyProcessBtn",(function(e){e.preventDefault(),_ml(!0,n+"Loader","Please wait patiently while we set up the payroll system. This procedure may take a few minutes."),a.createPartnerCompany()})),$(document).on("change","#jsEmployeeChoose",(function(){const e=$(this).val();0!=e&&(ml(!0,"jsCreateLoader"),function(e){ml(!0,"jsCreateLoader","Please wait, while we are generating view."),$.ajax({url:baseUrl("/payrolls/employees/"+e+"/get"),method:"GET"}).success((function(e){$(".jsAdminFirstName").val(e.first_name||""),$(".jsAdminLastName").val(e.last_name||""),$(".jsAdminEmailAddress").val(e.email||""),$(".jsAdminUserId").val(e.id||0)})).fail((function(e){return window.scrollTo(0,0),$(".jsErrorDiv").html(getErrorsStringFromArray((e.responseJSON||JSON.parse(e.responseText)).errors)).removeClass("hidden")})).always((function(){ml(!1,"jsCreateLoader")}))}(e))}))}));