$(function(){function e(){$(".jsSelectSubordinate").prop("checked",$(this).prop("checked"))}function s(){$(this).find('input[name="employees_ids[]"]').prop("checked",!$(this).find('input[name="employees_ids[]"]').prop("checked")),$(".jsCheckAll").prop("checked",$(".jsSelectSubordinate").length==$(".jsSelectSubordinate:checked").length)}function t(){var e=[];return $.each($('input[name="employees_ids[]"]:checked'),function(){var s={};s.employee_sid=parseInt($(this).val()),s.employee_name=$(this).closest("tr").find("td.js-employee-name").text(),e.push(s)}),e}function l(e){null!==n&&n.abort(),ml(!0,"jsPageLoader"),n=$.ajax({url:baseURI+"lms/courses/emailReminder/bulk",method:"POST",data:{employeeList:e}}).success(function(e){return n=null,ml(!1,"jsPageLoader"),alertify.alert("SUCCESS!","You have successfully sent an email reminder to selected employees.")}).fail(handleErrorResponse).done(function(e){n=null})}let n=null;$("#jsSubordinateDepartments").select2({closeOnSelect:!1}),departments&&$("#jsSubordinateDepartments").length&&$("#jsSubordinateDepartments").select2("val",departments.split(",")),$("#jsSubordinateTeams").select2({closeOnSelect:!1}),teams&&$("#jsSubordinateTeams").length&&$("#jsSubordinateTeams").select2("val",teams.split(",")),$("#jsSubordinateEmployees").select2({closeOnSelect:!1}),employees&&$("#jsSubordinateEmployees").length&&$("#jsSubordinateEmployees").select2("val",employees.split(",")),$(document).on("click",".jsSearchEmployees",function(e){e.preventDefault();var s=$("#jsSubordinateDepartments").val(),t=$("#jsSubordinateTeams").val(),l=$("#jsSubordinateEmployees").val();null!==n&&n.abort(),ml(!0,"jsPageLoader"),n=$.ajax({url:baseURL+"lms/courses/report",method:"GET",data:{departments:s,teams:t,employees:l}}).success(function(e){n=null;var s="";$.each(e,function(e,t){t.team_sid,t.department_sid;var l=t.assign_courses?t.assign_courses.split(","):[],n=l?l.length:0,a=n>1?n+" courses assign":n+" course assign";s+='<tr class="js-tr">',s+="<td>",s+='\t<label class="control control--checkbox">',s+=`\t\t<input type="checkbox" name="employees_ids[]" value="${t.employee_sid}" />`,s+='\t\t<div class="control__indicator"></div>',s+="\t</label>",s+="</td>",s+=`<td class="_csVm"><b>${t.full_name}</b></td>`,s+=`<td class="_csVm">${t.department_name}</td>`,s+=`<td class="_csVm">${t.team_name}</td>`,s+=`<td class="_csVm">${a}</td>`,s+=`<td class="_csVm"><a href="${baseURL}lms/subordinate/courses/${t.employee_sid}" class="btn btn-info btn-block csRadius5 csF16">View</a></td>`,s+="</tr>"}),$("#jsSubordinateList").html(s),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){n=null,ml(!1,"jsPageLoader")})}),$(document).on("click",".jsCheckAll",e),$(document).on("click",".jsSelectSubordinate",s),$(document).on("click",".jsSendReminderEmail",function(e){e.preventDefault(),senderList=t(),0!==senderList.length?alertify.confirm("Do you really want to send email reminders to the selected employees?",function(){l(senderList)}):alertify.alert("ERROR!","Please select at least one employee to start the process.")}),ml(!1,"jsPageLoader")});