$(function(){function e(e,o){null!==c&&c.abort(),ml(!0,"jsPageLoader"),c=$.ajax({url:apiURL+`lms/course/store/course/${e}/${o}`,method:"PUT",headers:{Authorization:"Bearer "+apiAccessTokenStore}}).success(function(e){c=null,window.location.reload(),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){c=null,ml(!1,"jsPageLoader")})}function o(){$(".jsStoreCourseRow").find('input[name="courses_ids[]"]').prop("checked",$(this).prop("checked"))}function s(){$(".jsCheckAll").prop("checked",$(".jsAssignCourses").length==$(".jsAssignCourses:checked").length)}function t(e){if(e.preventDefault(),d=r(),0===d.length)return alertify.alert("ERROR!","Please select at least one course to start the process.");h=0,f=d.length,ml(!0,"jsPageLoader"),$("#js-loader-text").html("Please wait, we are copying employee"),n()}function n(){if(d.length>0&&void 0===d[h])return ml(!1,"jsPageLoader"),$("#js-loader-text").html(""),alertify.alert("Course Copy process is completed successfully!",function(){d=[],f=0,j=0,h=0,i(),getLMSDefaultCourses()});if(void 0===d[h])return ml(!1,"jsPageLoader"),void $("#js-loader-text").html("");var e=d[h];c=$.ajax({url:apiURL+"lms/course/assign",method:"POST",headers:{"content-type":"application/json"},data:JSON.stringify({courseID:e.course_sid})}).fail(handleErrorResponse).done(function(){h<=f?(h++,setTimeout(function(){n()},1e3)):(ml(!1,"jsPageLoader"),alertify.alert("Course copy process is completed successfully!").set("onok",function(e){d=[],f=0,j=0,h=0}))})}function r(){var e=[];return $.each($('input[name="courses_ids[]"]:checked'),function(){var o={};o.course_sid=parseInt($(this).val()),o.course_name=$(this).closest("tr").find("td.js-course-name").text(),e.push(o)}),e}function l(){let e="";return e+="title="+encodeURI(u.title),e+="&status="+encodeURI("active"),e+="&companyId="+encodeURI(companySid),e+="&job_titles="+("all"!=u.jobTitleIds?u.jobTitleIds.join(","):[]),e}function i(){null!==c&&c.abort(),ml(!0,"jsPageLoader"),c=$.ajax({url:apiURL+"lms/course/store/courses?"+l(),method:"GET",headers:{Authorization:"Bearer "+apiAccessTokenStore}}).success(function(e){c=null,$("#jsStoreCoursesView").html(e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){c=null,ml(!1,"jsPageLoader")})}function a(e){}let c=null,u={title:"",jobTitleIds:"all"},d=[],f=0,j=0,h=0;$(".jsCourseJobTitleStoreCourse").select2(),$(".jsApplyFilterStoreCourse").click(function(e){e.preventDefault(),u.title=$(".jsCourseTitleStoreCourse").val()||"",u.jobTitleIds=$(".jsCourseJobTitleStoreCourse").select2("val"),i()}),$(document).on("click",".jsToggleViewAssignCompanyCourse",function(e){e.preventDefault(),$('[data-key="jsView'+$(this).closest("tr").data("id")+'"]').toggleClass("hidden")}),$(document).on("click",".jsCheckAll",o),$(document).on("click",".jsAssignCourses",s),$(document).on("click",".jsCopyCoursesBtn",t),$(document).on("click",".jsDisableCourse",function(o){var s=$(this).closest("tr").data("id");alertify.confirm("Are You Sure?","Are you sure want to disable this course?",function(){e(s,"disable")},function(){})}),$(document).on("click",".jsEnableCourse",function(o){var s=$(this).closest("tr").data("id");alertify.confirm("Are You Sure?","Are you sure want to enable this course?",function(){e(s,"enable")},function(){})}),window.sendCourseToSave=a,i()});