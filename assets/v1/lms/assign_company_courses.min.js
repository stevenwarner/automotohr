$(function(){function e(){$(".jsStoreCourseRow").find('input[name="courses_ids[]"]').prop("checked",$(this).prop("checked"))}function s(){$(".jsCheckAll").prop("checked",$(".jsAssignCourses").length==$(".jsAssignCourses:checked").length)}function t(e){if(e.preventDefault(),u=n(),0===u.length)return alertify.alert("ERROR!","Please select at least one course to start the process.");f=0,d=u.length,ml(!0,"jsPageLoader"),$("#js-loader-text").html("Please wait, we are copying employee"),o()}function o(){if(u.length>0&&void 0===u[f])return ml(!1,"jsPageLoader"),$("#js-loader-text").html(""),alertify.alert("Course Copy process is completed successfully!",function(){u=[],d=0,p=0,f=0,r(),getLMSDefaultCourses()});if(void 0===u[f])return ml(!1,"jsPageLoader"),void $("#js-loader-text").html("");var e=u[f];c=$.ajax({url:apiURL+"lms/course/assign",method:"POST",headers:{"content-type":"application/json"},data:JSON.stringify({courseID:e.course_sid})}).fail(handleErrorResponse).done(function(){f<=d?(f++,setTimeout(function(){o()},1e3)):(ml(!1,"jsPageLoader"),alertify.alert("Course copy process is completed successfully!").set("onok",function(e){u=[],d=0,p=0,f=0}))})}function n(){var e=[];return $.each($('input[name="courses_ids[]"]:checked'),function(){var s={};s.course_sid=parseInt($(this).val()),s.course_name=$(this).closest("tr").find("td.js-course-name").text(),e.push(s)}),e}function l(){let e="";return e+="title="+encodeURI(a.title),e+="&status="+encodeURI("active"),e+="&companyId="+encodeURI(companySid),e+="&job_titles="+("all"!=a.jobTitleIds?a.jobTitleIds.join(","):[]),e}function r(){null!==c&&c.abort(),ml(!0,"jsPageLoader"),c=$.ajax({url:apiURL+"lms/course/store/courses?"+l(),method:"GET",headers:{Authorization:"Bearer "+apiAccessTokenStore}}).success(function(e){c=null,$("#jsStoreCoursesView").html(e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){c=null,ml(!1,"jsPageLoader")})}function i(e){}let c=null,a={title:"",jobTitleIds:"all"},u=[],d=0,p=0,f=0;$(".jsCourseJobTitleStoreCourse").select2(),$(".jsApplyFilterStoreCourse").click(function(e){e.preventDefault(),a.title=$(".jsCourseTitleStoreCourse").val()||"",a.jobTitleIds=$(".jsCourseJobTitleStoreCourse").select2("val"),r()}),$(document).on("click",".jsToggleViewAssignCompanyCourse",function(e){e.preventDefault(),$('[data-key="jsView'+$(this).closest("tr").data("id")+'"]').toggleClass("hidden")}),$(document).on("click",".jsCheckAll",e),$(document).on("click",".jsAssignCourses",s),$(document).on("click",".jsCopyCoursesBtn",t),window.sendCourseToSave=i,r()});