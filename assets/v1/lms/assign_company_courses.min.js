$(function(){function e(){$(".jsStoreCourseRow").find('input[name="courses_ids[]"]').prop("checked",$(this).prop("checked"))}function s(){$(".jsCheckAll").prop("checked",$(".jsAssignCourses").length==$(".jsAssignCourses:checked").length)}function o(e){if(e.preventDefault(),a=l(),0===a.length)return alertify.alert("ERROR!","Please select at least one course to start the process.");ml(!0,"jsPageLoader"),$("#js-loader-text").html("Please wait, we are copying employee"),t()}function t(){if(a.length>0&&void 0===a[p])return ml(!1,"jsPageLoader"),$("#js-loader-text").html(""),alertify.alert("Course Copy process is completed successfully!",function(){a=[],u=0,d=0,p=0,r(),getLMSDefaultCourses()});if(void 0===a[p])return ml(!1,"jsPageLoader"),void $("#js-loader-text").html("");var e=a[p];c=$.ajax({url:apiURL+"lms/course/assign",method:"POST",headers:{"content-type":"application/json"},data:JSON.stringify({courseID:e.course_sid})}).fail(handleErrorResponse).done(function(){p<=u?(p++,setTimeout(function(){t()},1e3)):(ml(!1,"jsPageLoader"),alertify.alert("Course copy process is completed successfully!").set("onok",function(e){a=[],u=0,d=0,p=0}))})}function l(){var e=[];return $.each($('input[name="courses_ids[]"]:checked'),function(){var s={};s.course_sid=parseInt($(this).val()),s.course_name=$(this).closest("tr").find("td.js-course-name").text(),e.push(s)}),e}function n(){let e="";return e+="title="+encodeURI(i.title),e+="&status="+encodeURI("active"),e+="&companyId="+encodeURI(companySid),e+="&job_titles="+("all"!=i.jobTitleIds?i.jobTitleIds.join(","):[]),e}function r(){console.log("get courses"),null!==c&&c.abort(),ml(!0,"jsPageLoader"),c=$.ajax({url:apiURL+"lms/course/store/courses?"+n(),method:"GET",headers:{Authorization:"Bearer "+apiAccessTokenStore}}).success(function(e){c=null,$("#jsStoreCoursesView").html(e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){c=null,ml(!1,"jsPageLoader")})}let c=null,i={title:"",jobTitleIds:"all"},a=[],u=0,d=0,p=0;$(".jsCourseJobTitleStoreCourse").select2(),$(".jsApplyFilterStoreCourse").click(function(e){e.preventDefault(),i.title=$(".jsCourseTitleStoreCourse").val()||"",i.jobTitleIds=$(".jsCourseJobTitleStoreCourse").select2("val"),console.log(i),r()}),$(document).on("click",".jsToggleViewAssignCompanyCourse",function(e){e.preventDefault(),$('[data-key="jsView'+$(this).closest("tr").data("id")+'"]').toggleClass("hidden")}),$(document).on("click",".jsCheckAll",e),$(document).on("click",".jsAssignCourses",s),$(document).on("click",".jsCopyCoursesBtn",o),r()});