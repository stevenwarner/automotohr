$(function(){function e(){$(".jsStoreCourseRow").find('input[name="courses_ids[]"]').prop("checked",$(this).prop("checked"))}function s(){$(".jsCheckAll").prop("checked",$(".jsAssignCourses").length==$(".jsAssignCourses:checked").length)}function t(e){if(e.preventDefault(),a=n(),0===a.length)return alertify.alert("ERROR!","Please select at least one course to start the process.");ml(!0,"jsPageLoader"),$("#js-loader-text").html("Please wait, we are copying employee"),o()}function o(){if(a.length>0&&void 0===a[p])return ml(!1,"jsPageLoader"),$("#js-loader-text").html(""),alertify.alert("Course Copy process is completed successfully!",function(){a=[],u=0,d=0,p=0,r(),getLMSDefaultCourses()});if(void 0===a[p])return ml(!1,"jsPageLoader"),void $("#js-loader-text").html("");var e=a[p];i=$.ajax({url:apiURL+"lms/course/assign",method:"POST",headers:{"content-type":"application/json"},data:JSON.stringify({courseID:e.course_sid})}).fail(handleErrorResponse).done(function(){p<=u?(p++,setTimeout(function(){o()},1e3)):(ml(!1,"jsPageLoader"),alertify.alert("Course copy process is completed successfully!").set("onok",function(e){a=[],u=0,d=0,p=0}))})}function n(){var e=[];return $.each($('input[name="courses_ids[]"]:checked'),function(){var s={};s.course_sid=parseInt($(this).val()),s.course_name=$(this).closest("tr").find("td.js-course-name").text(),e.push(s)}),e}function l(){let e="";return e+="title="+encodeURI(c.title),e+="&status="+encodeURI("active"),e+="&companyId="+encodeURI(companySid),e+="&job_titles="+("all"!=c.jobTitleIds?c.jobTitleIds.join(","):[]),e}function r(){null!==i&&i.abort(),ml(!0,"jsPageLoader"),i=$.ajax({url:apiURL+"lms/course/store/courses?"+l(),method:"GET",headers:{Authorization:"Bearer "+apiAccessTokenStore}}).success(function(e){i=null,$("#jsStoreCoursesView").html(e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){i=null,ml(!1,"jsPageLoader")})}let i=null,c={title:"",jobTitleIds:"all"},a=[],u=0,d=0,p=0;$(".jsCourseJobTitleStoreCourse").select2(),$(".jsApplyFilterStoreCourse").click(function(e){e.preventDefault(),c.title=$(".jsCourseTitleStoreCourse").val()||"",c.jobTitleIds=$(".jsCourseJobTitleStoreCourse").select2("val"),r()}),$(document).on("click",".jsToggleViewAssignCompanyCourse",function(e){e.preventDefault(),$('[data-key="jsView'+$(this).closest("tr").data("id")+'"]').toggleClass("hidden")}),$(document).on("click",".jsCheckAll",e),$(document).on("click",".jsAssignCourses",s),$(document).on("click",".jsCopyCoursesBtn",t),r()});