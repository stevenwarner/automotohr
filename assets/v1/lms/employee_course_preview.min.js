$((function(){let t=null,e="MMM DD YYYY, ddd",s={title:"",status:"all"};if(search.length&&(s.status=search),$(".jsFilterBox").click((function(t){t.preventDefault(),$(".jsCourseTitleMyCourse").val(""),$('.jsCourseStatus option[value="'+$(this).data("key")+'"]').prop("selected",!0),s.title=$(".jsCourseTitleMyCourse").val()||"",s.status=$(".jsCourseStatus").val(),a(subordinateId)})),$(".jsApplyFilterMyCourse").click((function(t){t.preventDefault(),s.title=$(".jsCourseTitleMyCourse").val()||"",s.status=$(".jsCourseStatus").val(),a(subordinateId)})),$(".jsClearFilterMyCourse").click((function(t){t.preventDefault(),$(".jsCourseTitleMyCourse").val(""),$('.jsCourseStatus option[value="all"]').prop("selected",!0),s.title=$(".jsCourseTitleMyCourse").val()||"",s.status=$(".jsCourseStatus").val(),a(subordinateId)})),"subordinate_course"===page&&"scorm"===courseType){window.sendCourseToSave=function(t){}}function a(a){null!==t&&t.abort(),ml(!0,"jsPageLoader"),t=$.ajax({url:apiURL+"lms/report/"+a+"/courses?title="+s.title+"&status="+s.status,method:"GET"}).success((function(s){t=null;let o="",n=s.data.count,i=s.data.courses;$("#jsAssignedCount").html(n.assigned),$("#jsPendingCount").html(n.pending),$("#jsCompletedCount").html(n.completed),$("#jsExpiredSoonCount").html(n.expire_soon),s.data.assignedIds.length||($(".jsFilterSectionBtn").hide(),$(".jsSendReminderEmail").hide());var r=[];i.length?i.map((function(t){if((null==t.employee_sid||t.employee_sid==employeeId)&&s.data.assignedIds.includes(t.sid)&&!r.includes(t.sid)){if(r.push(t.sid),s.data.expiredSoonIds.includes(t.sid)?o+='<article class="article-sec" style="background: #fcf8e3 !important">':s.data.expiredIds.includes(t.sid)?o+='<article class="article-sec" style="background: #f2dede !important">':o+='<article class="article-sec">',s.data.expiredSoonIds.includes(t.sid)){const e=moment(t.course_end_period,"YYYY-MM-DD"),s=moment(),a=e.diff(s,"days");var n="";n=0==a?"Expiring today":1==a?`Expiring in ${a} day`:`Expiring in ${a} days`,o+='    <div class="row">',o+='        <div class="col-md-12 col-xs-12 text-right">',o+=`        \t<a href="javascript:;" class="btn btn-warning btn-xs csRadius5 csF14" title="This course will expired in ${a} days" placement="top">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-info-circle csF14" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&nbsp;${n}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,o+="        </div>",o+="    </div>"}if(s.data.expiredIds.includes(t.sid)){const e=moment(t.course_end_period,"YYYY-MM-DD"),s=moment(),a=Math.abs(e.diff(s,"days"));var i="";i=0==a?"Expired today":1==a?`Expired ${a} day ago`:`Expired ${a} days ago`,o+='    <div class="row">',o+='        <div class="col-md-12 col-xs-12 text-right">',o+=`        \t<a href="javascript:;" class="btn btn-danger btn-xs csRadius5 csF14" title="This course was expired ${a} days ago." placement="top">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-info-circle csF14" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&nbsp;${i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,o+="        </div>",o+="    </div>"}o+="    <h1>",o+=t.course_title,o+="    </h1>",o+="    <br>",o+='    <div class="row">',o+='        <div class="col-md-3 col-xs-12">',o+='            <p class="csColumSection"><strong>ASSIGNED DATE</strong></p>',o+=`            <p>${moment(t.course_start_period).format(e)}</p>`,o+="        </div>",o+='        <div class="col-md-3 col-xs-12">',o+='            <p class="csColumSection"><strong>DUE DATE</strong></p>',null===t.course_end_period?o+="--":o+=`            <p>${moment(t.course_end_period).format(e)}</p>`,o+="        </div>",o+='        <div class="col-md-3 col-xs-12">',o+='            <p class="csColumSection"><strong>STATUS</strong></p>',o+=`            <p>${"passed"==t.course_status?"COMPLETED":"PENDING"}</p>`,o+="        </div>",o+='        <div class="col-md-3 col-xs-12">',o+='            <p class="csColumSection"><strong>ASSIGNED TO</strong></p>',o+=`            <p>${s.data.employeeName}</p>`,o+="        </div>",o+="    </div>",o+='    <div class="row">',o+='        <div class="col-md-3 col-xs-12 hidden">',o+='            <p class="csColumSection"><strong>TIME REMAINING/TOTAL</strong></p>',o+="            <p>15 min / 15 min</p>",o+="        </div>",o+='        <div class="col-md-3 col-xs-12">',o+='            <p class="csColumSection"><strong>STARTED DATE </strong></p>',o+=`            <p>${t.created_at?moment(t.created_at).format(e):"-"}</p>`,o+="        </div>",o+='        <div class="col-md-3 col-xs-12">',o+='            <p class="csColumSection"><strong>LANGUAGE</strong></p>',o+=`            <select class="form-control jsSelectCourseLanguage jsCourseLanguage${t.sid}" data-course_id="${t.sid}">`,"scorm"==t.course_type?t.course_languages.map((function(t){o+=`            <option value="${t}">${t.charAt(0).toUpperCase()+t.slice(1)}</option>`})):o+='                <option value="english">English</option>',o+="            </select>",o+="        </div>",o+='        <div class="col-md-6 col-xs-12 text-right">',o+="            <p>&nbsp;</p>";var l="";l="scorm"==t.course_type?t.course_languages[0]:"english","passed"==t.course_status?(o+=`            <a class="btn btn-info csRadius5 csF16 jsStartCourse jsStartCourse${t.sid}" data-course_id="${t.sid}" href="${baseURI}lms/subordinate/course/${t.sid}/${a}/${reviewAs}/${l}">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-eye"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tView Content\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,o+=`        <a class="btn btn-info csRadius5 csF16" href="${baseURI}lms/courses/${t.sid}/${a}/subordinate/certificate}">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-eye"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tView Certificate\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`):o+=`            <a class="btn btn-info csRadius5 csF16 jsStartCourse jsStartCourse${t.sid}" data-course_id="${t.sid}" href="${baseURI}lms/subordinate/course/${t.sid}/${a}/${reviewAs}/${l}">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-play"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tLaunch Content\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,o+="        </div>",o+="    </div>",o+="</article>"}})):o='<p class="alert alert-info text-center">No course(s) found.</p>',$("#jsMyAssignedCourses").html(o),$("#jsEmployeeListing").hide(),$("#jsEmployeeCourses").show(),ml(!1,"jsPageLoader")})).fail(handleErrorResponse).always((function(){t=null,ml(!1,"jsPageLoader")}))}$(document).on("click",".jsStartCourse",(function(t){t.preventDefault();var e=$(this).data("course_id"),s=$(".jsCourseLanguage"+e).val(),a=baseURI+"lms/subordinate/course/"+e+"/"+subordinateId+"/"+reviewAs+"/"+s;$(this).attr("href",a),window.location=$(this).attr("href").toString()})),$(document).on("change",".jsSelectCourseLanguage",(function(t){t.preventDefault();var e=$(this).data("course_id"),s=$(this).val(),a=baseURI+"lms/subordinate/course/"+e+"/"+subordinateId+"/"+reviewAs+"/"+s;$(".jsStartCourse"+e).attr("href",a)})),$(document).on("change",".jsChangeScormLanguage",(function(t){t.preventDefault();var e=$(this).data("course_id"),s=$(this).val(),a=baseURI+"lms/subordinate/course/"+e+"/"+subordinateId+"/"+reviewAs+"/"+s;alertify.confirm("Are you sure you want to change course language?",(function(){window.location=a}),CB).setHeader("Confirm")})),"subordinate_courses"===page?a(subordinateId):($(".jsSaveQuestionResult").hide(),function(){null!==t&&t.abort(),ml(!0,"jsPageLoader");var e=apiURL+"lms/report/"+subordinateId+"/"+courseId;"scorm"==courseType&&(e+="/"+courseLanguage),t=$.ajax({url:e,method:"GET"}).success((function(e){t=null,$("#jsPreviewCourse").html(e),"manual"===courseType&&(null!==t&&t.abort(),ml(!0,"jsPageLoader"),t=$.ajax({url:apiURL+"lms/report/"+subordinateId+"/"+courseId+"/questions/attempt",method:"GET"}).success((function(e){t=null,$("#jsPreviewCourseQuestion").html(e),ml(!1,"jsPageLoader")})).fail(handleErrorResponse).done((function(){t=null,ml(!1,"jsPageLoader")}))),ml(!1,"jsPageLoader")})).fail(handleErrorResponse).always((function(){t=null,ml(!1,"jsPageLoader")}))}()),$(document).on("click",".jsSendReminderEmail",(function(e){e.preventDefault(),alertify.confirm("Do you really want to send email reminder to <b>"+subordinateName+"</b>?",(function(){alertify.prompt("Please Enter a Note","","",(function(t,e){}),(function(){alertify.error("Cancel")})).setContent('<textarea style="resize: none;" rows="5" cols="50"> </textarea>').set("onok",(function(e){var s,a;employeeInfo=(s=[],(a={}).employee_sid=subordinateId,a.employee_name=subordinateName,s.push(a),s),function(e,s){null!==t&&t.abort();ml(!0,"jsPageLoader"),t=$.ajax({url:baseURI+"lms/courses/emailReminder/single",method:"POST",data:{employeeList:e,note:s}}).success((function(e){return t=null,ml(!1,"jsPageLoader"),alertify.alert("SUCCESS!","You have successfully sent an email reminder to <b>"+subordinateName+"</b>.")})).fail(handleErrorResponse).done((function(e){t=null}))}(employeeInfo,this.elements.content.querySelector("textarea").value)}))}))}))}));