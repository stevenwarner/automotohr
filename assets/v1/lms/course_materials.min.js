$((function(){let e,a,t;function o(){void 0!==e&&e.abort(),e=$.ajax({url:apiURL+"lms/course/"+a+"/materials",method:"GET"}).always((function(){e=void 0,ml(!1,"jsManageMaterialsLoader")})).fail((function(e){$(".jsModalCancel").trigger("click")})).done((function(e){$("#jsManageMaterialsBody").html(e),$("#jsCourseMaterialFile").msFileUploader({fileLimit:"200mb",allowedTypes:["jpg","jpeg","png","gif","pdf","rtf","doc","docx","ppt","pptx","xls","xlsx","mov","mp4","wav","mp3"]}),$("#jsCourseMaterialLanguage").select2({minimumResultsForSearch:-1})}))}$(document).on("click",".jsManageMaterials",(function(e){e.preventDefault(),a=$(this).closest("tr.jsCourseRowDashboard").data("id"),t=$(this).closest("tr.jsCourseRowDashboard").children("td:first").text(),Modal({Id:"jsManageMaterialsModal",Title:"Manage Course Materials -  "+t,Loader:"jsManageMaterialsLoader",Body:'<div id="jsManageMaterialsBody"></div>'},o)})),$(document).on("click",".jsToggleCourseMaterialRow",(function(e){e.preventDefault();const a=$(this).data("key");$(".jsCourseMaterialViewRow"+a).toggleClass("hidden")})),$(document).on("click",".jsCourseMaterialAddBtn",(function(t){if(t.preventDefault(),void 0!==e)return;const r={title:$("#jsCourseMaterialTitle").val().trim(),language:$("#jsCourseMaterialLanguage").val(),material:$("#jsCourseMaterialFile").msFileUploader("get")};if(!r.title)return _error("Please add a title for course material.");(function(e,a){const t={required:"Please select a file."};let o;0===Object.keys(e).length?o=t.required:e.errorCode&&(o=e.errorCode);if(o)return void 0===a&&_error(o),{error:o};return!0})(r.material).error||async function(t){e=null;const r=callButtonHook($(".jsCourseMaterialAddBtn"),!0);let i=await uploadFile(t.material);i&&(i=JSON.parse(i));if(!i.data)return e=void 0,callButtonHook(r,!1),_error("Something went wrong while uploading the file.");t.material=i.data,e=$.ajax({url:apiURL+"lms/course/"+a+"/materials",method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},data:JSON.stringify(t)}).always((function(){e=void 0,callButtonHook(r,!1)})).fail(handleErrorResponse).done((function(e){return _success(e.message,o)}))}(r)})),$(document).on("click",".jsCourseMaterialDeleteBtn",(function(t){if(t.preventDefault(),void 0!==e)return;let r=$(this).closest("tr").data("key"),i=$(this);_confirm("<p>This process is not revertible!</p><br/><p>Do you really want to delete the selected course material?</p>",(function(){!function(t,r){e=null;const i=callButtonHook(r,!0);e=$.ajax({url:apiURL+"lms/course/"+a+"/materials/"+t,method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}}).always((function(){e=void 0,callButtonHook(i,!1)})).fail(handleErrorResponse).done((function(e){return _success(e.message,o)}))}(r,i)}))})),$(document).on("click",".jsModalCancel",(function(){a=void 0,t=void 0}))}));