$(function(){function e(){let e="";return e+="title="+encodeURI(u.title),e+="&status="+encodeURI(u.status),e+="&job_titles="+("all"!=u.jobTitleIds?u.jobTitleIds.join(","):[]),e}function t(){null!==a&&a.abort(),ml(!0,"jsPageLoader"),a=$.ajax({url:apiURL+"lms/course?"+e(),method:"GET"}).success(function(e){a=null,$("#jsDefaultCoursesView").html(e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){a=null,void 0!==getSegment(3)&&($(".jsEditCourse").remove(),$(".jsDisableDefaultCourse").remove(),$(".jsToggleViewDefaultCourse").remove()),ml(!1,"jsPageLoader")})}function o(){$.ajax({url:apiURL+"jobs/titles/default",method:"GET"}).success(function(e){if(e.data){let t='<option value="all">All</option>';e.data.map(function(e){t+='<option value="'+e.sid+'">'+e.title+"</option>"}),$(".jsCourseJobTitleDefaultCourse").html(t),$(".jsCourseJobTitleDefaultCourse").select2()}})}function s(e,o){null===a&&(ml(!0,"jsPageLoader"),a=$.ajax({url:apiURL+"lms/course/"+e+"/status",method:"PUT",headers:{"content-type":"application/json"},data:JSON.stringify({active:o})}).success(function(e){a=null,alertify.success(e.success),t()}).fail(handleErrorResponse).done(function(){a=null,ml(!1,"jsPageLoader")}))}function l(e){window.previewCourseId=e,Modal({Id:"jsLMSPreviewCourseModal",Title:"Preview Course",Loader:"jsLMSPreviewCourseModalLoader",Cl:"container",Body:'<div id="jsLMSPreviewCourseModalBody"></div>'},function(){ml(!0,"jsLMSPreviewCourseModalLoader"),a=$.ajax({url:apiURL+"lms/course/"+e+"/preview?_has="+(-1!==window.location.host.indexOf("www.")?"y":"n"),method:"GET"}).success(function(e){a=null,$("#jsLMSPreviewCourseModalBody").html(e)}).fail(handleErrorResponse).done(function(){a=null,ml(!1,"jsLMSPreviewCourseModalLoader")})})}let a=null,u={title:"",status:"active",jobTitleIds:"all"};$(".jsCourseStatusDefaultCourse").select2({minimumResultsForSearch:-1}).select2("val",u.status),$(".jsApplyFilterDefaultCourse").click(function(e){e.preventDefault(),u.title=$(".jsCourseTitleDefaultCourse").val()||"",u.status=$(".jsCourseStatusDefaultCourse").select2("val"),u.jobTitleIds=$(".jsCourseJobTitleDefaultCourse").select2("val"),t()}),$(document).on("click",".jsToggleViewDefaultCourse",function(e){e.preventDefault(),$('[data-key="jsView'+$(this).closest("tr").data("id")+'"]').toggleClass("hidden")}),$(document).on("click",".jsEnableCourse",function(e){e.preventDefault();let t=$(this).closest("tr").data("id");return alertify.confirm("Do you really want to enable this course?",function(){s(t,!0)},CB).set("labels",{ok:"Yes",cancel:"No"}).setHeader("Confirm")}),$(document).on("click",".jsDisableCourse",function(e){e.preventDefault();let t=$(this).closest("tr").data("id");return alertify.confirm("Do you really want to disable this course?",function(){s(t,!1)},CB).set("labels",{ok:"Yes",cancel:"No"}).setHeader("Confirm")}),$(document).on("click",".jsAddCourse",function(e){e.preventDefault(),startCreateCourseProcess(0)}),$(document).on("click",".jsEditCourse",function(e){e.preventDefault(),startEditCourseProcess(0,$(this).closest("tr").data("id"))}),$(document).on("click",".jsPreviewCourse",function(e){e.preventDefault(),l($(this).closest("tr").data("id"))}),window.getLMSDefaultCourses=t,o(),t()});