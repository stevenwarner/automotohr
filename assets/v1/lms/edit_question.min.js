$((function(){let e,i,t,o={question_id:0,question_title:"",question_content:"",question_type:"text",choice_list:{},video_type:"upload",video_file_name:""};$(document).on("click",".jsModalCancel",(function(){t.close()})),$(document).on("change","#jsEditQuestionType",(function(){$(".jsEditQuestionMultipleChoiceBox").addClass("hidden"),"multiple_choice"===$(this).val()&&$(".jsEditQuestionMultipleChoiceBox").removeClass("hidden")})),$(document).on("change",".jsEditQuestionVideoType",(function(){$(".jsEditQuestionUploadVideoBox").addClass("hidden"),$(".jsEditQuestionRecordVideoBox").addClass("hidden"),"upload"===$(this).val()?($(".jsEditQuestionUploadVideoBox").removeClass("hidden"),t.close()):($(".jsEditQuestionRecordVideoBox").removeClass("hidden"),t.init())})),$(document).on("click",".jsEditQuestionSaveBtn",(function(s){s.preventDefault(),async function(){const s=[];o.question_title=$("#jsEditQuestionTitle").val().trim(),o.question_content=$("#jsEditQuestionHelp").val().trim(),o.question_type=$("#jsEditQuestionType").select2("val"),o.choice_list=[],o.video_type=$(".jsEditQuestionVideoType:checked").val()||null,o.question_title||s.push('"Question" field is mandatory.');o.question_type||s.push('"Question type" field is mandatory.');if("multiple_choice"===o.question_type){let e=$("#jsEditQuestionMultipleChoice1").val().trim(),i=$("#jsEditQuestionMultipleChoice2").val().trim(),t=$("#jsEditQuestionMultipleChoice3").val().trim(),d=$("#jsEditQuestionMultipleChoice4").val().trim(),l=$("#jsEditQuestionMultipleChoiceAnswer").select2("val");o.choice_list={choice1:e,choice2:i,choice3:t,choice4:d,rightChoice:l},e||s.push('"Choice one" is mandatory.'),i||s.push('"Choice two" is mandatory.'),t||s.push('"Choice three" is mandatory.'),d||s.push('"Choice four" is mandatory.'),l||s.push('"Correct choice" is mandatory.')}o.video_type||s.push('"Video type" field is mandatory.');let d={},l={},n=!1;"upload"===o.video_type?(d=$("#jsEditQuestionUploadVideo").msFileUploader("get"),Object.keys(d).length?(d.errorCode&&s.push(d.errorCode),n=!0):o.video_file_name||s.push('"Video file" is mandatory. Please upload a file.')):(l=await t.getVideo(),5!==l.length||o.video_file_name?n=!0:s.push('"Video Recording" is mandatory. Please record a video.'));if(s.length)return alertify.alert("ERROR!",getErrorsStringFromArray(s),CB);if(ml(!0,e),n){let i={};if("upload"===o.video_type?(i=await uploadFile(d),"string"==typeof i&&(i=JSON.parse(i))):i=await uploadStream(l),!Object.keys(i).length)return ml(!1,e),alertify.alert("ERROR!","Failed to upload file.",CB);o.video_file_name=i.data}t.close(),$("#jsEditQuestionUploadVideo").msFileUploader("clear"),i(o)}()})),window.loadEditQuestionView=function(s,d,l){o=s,e=d,i=l,t=new msVideoRecorder({recorderPlayer:"jsEditQuestionRecordingLive",previewPlayer:"jsEditQuestionRecordingRecorded",recordButton:"jsEditQuestionRecordingStart",playRecordedVideoBTN:"jsEditQuestionRecordingPlay",pauseRecordedVideoBTN:"jsEditQuestionRecordingPause",resumeRecordedVideoBTN:"jsEditQuestionRecordingResume",removeRecordedVideoBTN:"jsEditQuestionRecordingRemove",errorSectionReference:"jsEditQuestionRecordingError"}),$("#jsEditQuestionUploadVideo").msFileUploader({fileLimit:"30mb",allowedTypes:["mp4"],placeholderImage:o.video_file_name}),$("#jsEditQuestionType").select2({minimumResultsForSearch:-1}),$("#jsEditQuestionMultipleChoiceAnswer").select2({minimumResultsForSearch:-1}),$("#jsEditQuestionTitle").val(o.question_title),$("#jsEditQuestionHelp").val(o.question_content),$("#jsEditQuestionType").select("val",o.question_type),$('.jsEditQuestionVideoType[value="upload"]').prop("checked",!0),$(".jsEditQuestionRecordVideoBox").addClass("hidden"),$(".jsEditQuestionUploadVideoBox").removeClass("hidden"),$(".jsEditQuestionMultipleChoiceBox").addClass("hidden"),$("#jsEditQuestionMultipleChoiceAnswer").select("val","choice_1"),$("#jsEditQuestionMultipleChoice1").val(""),$("#jsEditQuestionMultipleChoice2").val(""),$("#jsEditQuestionMultipleChoice3").val(""),$("#jsEditQuestionMultipleChoice4").val(""),"multiple_choice"===o.question_type&&($(".jsEditQuestionMultipleChoiceBox").removeClass("hidden"),$("#jsEditQuestionMultipleChoiceAnswer").select("val",o.choice_list.rightChoice),$("#jsEditQuestionMultipleChoice1").val(o.choice_list.choice1),$("#jsEditQuestionMultipleChoice2").val(o.choice_list.choice2),$("#jsEditQuestionMultipleChoice3").val(o.choice_list.choice3),$("#jsEditQuestionMultipleChoice4").val(o.choice_list.choice4)),$(".jsPageBox").addClass("hidden"),$('.jsPageBox[data-id="edit_question"]').removeClass("hidden")}}));