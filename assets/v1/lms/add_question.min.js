$((function(){let e,i,o,d={question_id:0,question_title:"",question_content:"",question_type:"text",choice_list:{},video_type:"upload",video_file_name:""};$(document).on("click",".jsModalCancel",(function(){o.close()})),$(document).on("change","#jsAddQuestionType",(function(){$(".jsAddQuestionMultipleChoiceBox").addClass("hidden"),"multiple_choice"===$(this).val()&&$(".jsAddQuestionMultipleChoiceBox").removeClass("hidden")})),$(document).on("change",".jsAddQuestionVideoType",(function(){$(".jsAddQuestionUploadVideoBox").addClass("hidden"),$(".jsAddQuestionRecordVideoBox").addClass("hidden"),"upload"===$(this).val()?($(".jsAddQuestionUploadVideoBox").removeClass("hidden"),o.close()):($(".jsAddQuestionRecordVideoBox").removeClass("hidden"),o.init())})),$(document).on("click",".jsAddQuestionSaveBtn",(function(t){t.preventDefault(),async function(){const t=[];d.question_title=$("#jsAddQuestionTitle").val().trim(),d.question_content=$("#jsAddQuestionHelp").val().trim(),d.question_type=$("#jsAddQuestionType").select2("val"),d.choice_list=[],d.video_type=$(".jsAddQuestionVideoType:checked").val()||null,d.video_file_name="",d.question_title||t.push('"Question" field is mandatory.');d.question_type||t.push('"Question type" field is mandatory.');if("multiple_choice"===d.question_type){let e=$("#jsAddQuestionMultipleChoice1").val().trim(),i=$("#jsAddQuestionMultipleChoice2").val().trim(),o=$("#jsAddQuestionMultipleChoice3").val().trim(),s=$("#jsAddQuestionMultipleChoice4").val().trim(),n=$("#jsAddQuestionMultipleChoiceAnswer").select2("val");d.choice_list={choice1:e,choice2:i,choice3:o,choice4:s,rightChoice:n},e||t.push('"Choice one" is mandatory.'),i||t.push('"Choice two" is mandatory.'),o||t.push('"Choice three" is mandatory.'),s||t.push('"Choice four" is mandatory.'),n||t.push('"Correct choice" is mandatory.')}d.video_type||t.push('"Video type" field is mandatory.');let s={},n={};"upload"===d.video_type?(s=$("#jsAddQuestionUploadVideo").msFileUploader("get"),Object.keys(s).length?s.errorCode&&t.push(s.errorCode):t.push('"Video file" is mandatory. Please upload a file.')):(n=await o.getVideo(),5===n.length&&t.push('"Video Recording" is mandatory. Please record a video.'));if(t.length)return alertify.alert("ERROR!",getErrorsStringFromArray(t),CB);ml(!0,e);let l={};"upload"===d.video_type?(l=await uploadFile(s),"string"==typeof l&&(l=JSON.parse(l))):l=await uploadStream(n);if(!Object.keys(l).length)return ml(!1,e),alertify.alert("ERROR!","Failed to upload file.",CB);d.video_file_name=l.data,d.question_id=Date.now(),o.close(),$("#jsAddQuestionUploadVideo").msFileUploader("clear"),i(d)}()})),window.loadAddQuestionView=function(t,s){e=t,i=s,o=new msVideoRecorder({recorderPlayer:"jsAddQuestionRecordingLive",previewPlayer:"jsAddQuestionRecordingRecorded",recordButton:"jsAddQuestionRecordingStart",playRecordedVideoBTN:"jsAddQuestionRecordingPlay",pauseRecordedVideoBTN:"jsAddQuestionRecordingPause",resumeRecordedVideoBTN:"jsAddQuestionRecordingResume",removeRecordedVideoBTN:"jsAddQuestionRecordingRemove",errorSectionReference:"jsAddQuestionRecordingError"}),$("#jsAddQuestionUploadVideo").msFileUploader({fileLimit:"30mb",allowedTypes:["mp4"]}),$("#jsAddQuestionType").select2({minimumResultsForSearch:-1}),$("#jsAddQuestionMultipleChoiceAnswer").select2({minimumResultsForSearch:-1}),$("#jsAddQuestionTitle").val(""),$("#jsAddQuestionHelp").val(""),$("#jsAddQuestionType").select("val","text"),$(".jsAddQuestionMultipleChoiceBox").addClass("hidden"),$("#jsAddQuestionMultipleChoiceAnswer").select("val","choice_1"),$(".jsAddQuestionVideoType").prop("checked",!1),$(".jsAddQuestionUploadVideoBox").addClass("hidden"),$(".jsAddQuestionRecordVideoBox").addClass("hidden"),$("#jsAddQuestionMultipleChoice1").val(""),$("#jsAddQuestionMultipleChoice2").val(""),$("#jsAddQuestionMultipleChoice3").val(""),$("#jsAddQuestionMultipleChoice4").val(""),d={question_id:0,question_title:"",question_content:"",question_type:"text",choice_list:{},video_type:"upload",video_file_name:""},$(".jsPageBox").addClass("hidden"),$('.jsPageBox[data-id="add_question"]').removeClass("hidden")}}));