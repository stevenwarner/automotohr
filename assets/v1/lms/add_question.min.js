$((function(){let e,t,o,s={question_id:0,question_required:!1,question_title:"",question_content:"",question_type:"text",choice_list:{},video_type:"upload",video_file_name:""};$(document).on("click",".jsModalCancel",(function(){o.close()})),$(document).on("change","#jsAddQuestionType",(function(){$(".jsAddQuestionPlace").addClass("hidden"),"multiple_choice"===$(this).val()||"single_choice"===$(this).val()?$(".jsAddQuestionChoice").removeClass("hidden"):"yes_no"===$(this).val()&&$(".jsAddQuestionYesNo").removeClass("hidden")})),$(document).on("change",".jsAddQuestionVideoType",(function(){$(".jsAddQuestionUploadVideoBox").addClass("hidden"),$(".jsAddQuestionRecordVideoBox").addClass("hidden"),$(".jsAddQuestionLinkVideoBox").addClass("hidden"),o.close(),"upload"===$(this).val()?$(".jsAddQuestionUploadVideoBox").removeClass("hidden"):"record"===$(this).val()?($(".jsAddQuestionRecordVideoBox").removeClass("hidden"),o.init()):"link"===$(this).val()&&$(".jsAddQuestionLinkVideoBox").removeClass("hidden")})),$(document).on("click",".jsAddQuestionSaveBtn",(function(i){i.preventDefault(),async function(){const i=[];s.question_title=$("#jsAddQuestionTitle").val().trim(),s.question_content=$("#jsAddQuestionHelp").val().trim(),s.question_required=$("#jsAddQuestionRequired").prop("checked"),s.question_type=$("#jsAddQuestionType").select2("val"),s.choice_list={},s.video_type=$(".jsAddQuestionVideoType:checked").val()||null,s.video_file_name="",s.question_title||i.push('"Question" field is mandatory.');s.question_type||i.push('"Question type" field is mandatory.');"single_choice"===s.question_type||"multiple_choice"===s.question_type?$(".csChoiceRow").map((function(e){const t={answer_choice:$(this).find(".jsAddQuestionChoiceAnswer").val().trim(),answer_score:$(this).find(".jsAddQuestionChoiceAnswerScore").val().trim(),answer_status:$(this).find(".jsAddQuestionChoiceAnswerStatus").val().trim()};t.answer_choice||i.push('"Answer Choice" is missing for row '+(e+1)+"."),s.choice_list[e]=t})):"yes_no"===s.question_type&&(s.choice_list.yes={score:$("#jsAddQuestionYesNoYSelect option:checked").val(),status:$("#jsAddQuestionYesNoYStatus option:checked").val()},s.choice_list.no={score:$("#jsAddQuestionYesNoNSelect option:checked").val(),status:$("#jsAddQuestionYesNoNStatus option:checked").val()});s.video_type||i.push('"Video type" field is mandatory.');let d={},n={},l=!1;"upload"===s.video_type?(d=$("#jsAddQuestionUploadVideo").msFileUploader("get"),Object.keys(d).length?d.errorCode&&i.push(d.errorCode):i.push('"Video file" is mandatory. Please upload a file.'),l=!0):"record"===s.video_type?(n=await o.getVideo(),5===n.length&&i.push('"Video Recording" is mandatory. Please record a video.'),l=!0):"link"===s.video_type?(s.video_file_name=$("#jsAddQuestionLink").val().trim(),s.video_file_name?s.video_file_name.isValidYoutubeLink()||s.video_file_name.isValidVimeoLink()||i.push("Invalid YouTube / Vimeo link."):i.push("YouTube / Vimeo link is required.")):s.video_file_name="none";if(i.length)return alertify.alert("ERROR!",getErrorsStringFromArray(i),CB);if(ml(!0,e),l&&"none"!=s.video_type){let t={};if("upload"===s.video_type?(t=await uploadFile(d),"string"==typeof t&&(t=JSON.parse(t))):t=await uploadStream(n),!Object.keys(t).length)return ml(!1,e),alertify.alert("ERROR!","Failed to upload file.",CB);s.video_file_name=t.data}s.question_id=Date.now(),o.close(),$("#jsAddQuestionUploadVideo").msFileUploader("clear"),t(s)}()})),$(document).on("click",".jsAddChoiceAnswer",(function(e){e.preventDefault();$(".csChoiceBox").append('\n\t\t\x3c!-- secondary question row --\x3e\n\t\t<div class="csChoiceRow">\n\t\t\t<div class="row">\n\t\t\t\t<div class="col-xs-12 col-sm-5">\n\t\t\t\t\t<label>Answer Choice <strong class="text-danger">*</strong></label>\n\t\t\t\t\t<input type="text" class="form-control jsAddQuestionChoiceAnswer" />\n\t\t\t\t</div>\n\t\t\t\t<div class="col-xs-12 col-sm-3">\n\t\t\t\t\t<label>Question Score <strong class="text-danger">*</strong></label>\n\t\t\t\t\t<select class="form-control jsAddQuestionChoiceAnswerScore">\n\t\t\t\t\t\t<option value="0">Not acceptable - 0</option>\n\t\t\t\t\t\t<option value="1">Acceptable - 1</option>\n\t\t\t\t\t\t<option value="2">Good - 2</option>\n\t\t\t\t\t\t<option value="3">Very Good - 3</option>\n\t\t\t\t\t\t<option value="4">Excellent - 4</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class="col-xs-12 col-sm-2">\n\t\t\t\t\t<label>Status <strong class="text-danger">*</strong></label>\n\t\t\t\t\t<select class="form-control jsAddQuestionChoiceAnswerStatus">\n\t\t\t\t\t\t<option value="pass">Pass</option>\n\t\t\t\t\t\t<option value="fail">Fail</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class="col-xs-12 col-sm-1">\n\t\t\t\t\t<p>&nbsp;</p>\n\t\t\t\t\t<button class="btn btn-danger jsDeleteChoiceAnswer" type="button" title="Remove answer" placement="top">\n\t\t\t\t\t\t<i class="fa fa-times-circle" aria-hidden="true"></i>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<br />\n\t\t</div>\n\t\t\t\t')})),$(document).on("click",".jsDeleteChoiceAnswer",(function(e){e.preventDefault(),$(this).closest(".csChoiceRow").remove()})),window.loadAddQuestionView=function(i,d){e=i,t=d,o=new msVideoRecorder({recorderPlayer:"jsAddQuestionRecordingLive",previewPlayer:"jsAddQuestionRecordingRecorded",recordButton:"jsAddQuestionRecordingStart",playRecordedVideoBTN:"jsAddQuestionRecordingPlay",pauseRecordedVideoBTN:"jsAddQuestionRecordingPause",resumeRecordedVideoBTN:"jsAddQuestionRecordingResume",removeRecordedVideoBTN:"jsAddQuestionRecordingRemove",errorSectionReference:"jsAddQuestionRecordingError"}),$("#jsAddQuestionUploadVideo").msFileUploader({fileLimit:"30mb",allowedTypes:["mp4","mov"]}),$("#jsAddQuestionType").select2({minimumResultsForSearch:-1}),$("#jsAddQuestionTitle").val(""),$("#jsAddQuestionHelp").val(""),$("#jsAddQuestionRequired").prop("checked",!1),$("#jsAddQuestionType").select2("val","text"),$(".jsAddQuestionPlace").addClass("hidden"),$('#jsAddQuestionYesNoYSelect option[value="0"]').prop("selected",!0),$('#jsAddQuestionYesNoYStatus option[value="pass"]').prop("selected",!0),$('#jsAddQuestionYesNoNSelect option[value="0"]').prop("selected",!0),$('#jsAddQuestionYesNoNStatus option[value="pass"]').prop("selected",!0),$(".jsAddQuestionChoiceAnswer").val(""),$(".csChoiceBox").html(""),$('#jsAddQuestionChoiceAnswerScore option[value="0"]').prop("selected",!0),$('#jsAddQuestionChoiceAnswerStatus option[value="pass"]').prop("selected",!0),$(".jsAddQuestionVideoType").prop("checked",!1),$(".jsAddQuestionUploadVideoBox").addClass("hidden"),$(".jsAddQuestionRecordVideoBox").addClass("hidden"),$(".jsAddQuestionLinkVideoBox").addClass("hidden"),$("#jsAddQuestionLink").val(""),s={question_id:0,question_title:"",question_required:!1,question_content:"",question_type:"text",choice_list:{},video_type:"upload",video_file_name:""},$(".jsPageBox").addClass("hidden"),$('.jsPageBox[data-id="add_question"]').removeClass("hidden")}}));