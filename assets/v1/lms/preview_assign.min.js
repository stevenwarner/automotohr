$(function(){function e(e,s){var t="",o=s.split(".").pop().toLowerCase();if("jpg"==o||"jpeg"==o||"png"==o||"gif"==o)t+='<div class="img-thumbnail">',t+=`<img class="img-responsive" src="${e}" style="width:100%; height:500px;" />`,t+="</div>";else if("pdf"==o||"rtf"==o||"doc"==o||"docx"==o||"ppt"==o||"pptx"==o||"xls"==o||"xlsx"==o){switch(o){case"pdf":case"rtf":preview_iframe_url="https://docs.google.com/gview?url="+e+"&embedded=true";break;case"doc":case"docx":preview_iframe_url="https://view.officeapps.live.com/op/embed.aspx?src="+encodeURI(e);break;case"ppt":preview_iframe_url="https://docs.google.com/gview?url="+e+"&embedded=true";break;case"pptx":dpreview_iframe_url="https://docs.google.com/gview?url="+e+"&embedded=true";break;case"xls":case"xlsx":preview_iframe_url="https://view.officeapps.live.com/op/embed.aspx?src="+encodeURI(e)}t+=`<iframe src="${preview_iframe_url}" id="preview_iframe" class="uploaded-file-preview" style="width:100%; height:800px;" frameborder="0"></iframe>`}else"mov"!=o&&"mp4"!=o&&"wav"!=o&&"mp3"!=o||(t+='<div id="latest-iframe-container"">',t+='\t<div class="embed-responsive embed-responsive-4by3">',t+=' \t\t<div id="latest-iframe-holder" class="embed-responsive-item">',t+='<video controls style="width:100%; height:auto;">',"mp3"==o?t+=`<source src="${e}" type="audio/mpeg">`:"mp4"==o?t+=`<source src="${e}" type="audio/mp4">`:"wav"==o?t+=`<source src="${e}" type="audio/wav">`:"mov"==o&&(t+=`<source src="${e}" type="audio/mov">`),t+="\tYour browser does not support the audio element.",t+="</video>",t+="       </div>",t+="\t</div>",t+="</div>");$("#jsMaterialModelBody").html(t)}function s(e){null!==i&&i.abort(),ml(!0,"jsPageLoader"),i=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+courseId+"/"+e,method:"PUT"}).success(function(s){i=null,"language_changed"===s.status&&(window.location=baseURI+"lms/courses/"+courseId+"/"+e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){i=null,ml(!1,"jsPageLoader")})}function t(){null!==i&&i.abort(),ml(!0,"jsPageLoader"),i=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+courseId+"/"+courseLanguage+"/start?_has="+(-1!==window.location.host.indexOf("www.")?"y":"n"),method:"GET"}).success(function(e){i=null,"course_started"===e.status&&($("#jsStartCourseDiv").hide(),$(".jsSaveQuestionResult").show(),o()),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){i=null,ml(!1,"jsPageLoader")})}function o(){null!==i&&i.abort(),ml(!0,"jsPageLoader"),i=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+courseId+"/"+courseLanguage+"?_has="+(-1!==window.location.host.indexOf("www.")?"y":"n"),method:"GET"}).success(function(e){i=null,$("#jsPreviewCourse").html(e),"manual"===courseType&&a(),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){i=null,ml(!1,"jsPageLoader")})}function a(){null!==i&&i.abort(),ml(!0,"jsPageLoader"),i=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+courseId+"/questions/"+mode,method:"GET"}).success(function(e){i=null,$("#jsPreviewCourseQuestion").html(e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){i=null,ml(!1,"jsPageLoader")})}function r(e){null!==i&&i.abort(),ml(!0,"jsPageLoader"),i=$.ajax({url:apiURL+"lms/trainings/"+employeeId,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify({courseId:courseId,answers:e})}).success(function(e){if(i=null,"failed"!==e.status)return"passed"===e.status?alertify.alert("SUCCESS!","Congratulations! you have successfully passed this course!",function(){window.location=baseURI+"lms/courses/my"}):void ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){i=null,ml(!1,"jsPageLoader")})}let i=null;if($(".jsStartCourseButton").click(function(e){e.preventDefault(),alertify.confirm("Are you sure you want to start this course?",function(){t()},CB).setHeader("Confirm")}),$(document).on("change",".jsChangeScormLanguage",function(e){e.preventDefault();var t=$(this).val();alertify.confirm("Are you sure you want to change course language?",function(){s(t)},CB).setHeader("Confirm")}),$(document).on("click",".jsViewMaterial",function(s){s.preventDefault();var t=$(this).data("path"),o=$(this).data("name"),a=$(this).data("title");$("#jsMaterialModelTitle").text(a),$("#jsMaterialModel").modal("show"),$("#jsMaterialModelLoader").hide(),e(t,o)}),$(document).on("click",".jsMaterialModelCancel",function(e){e.preventDefault(),$("#jsMaterialModelBody").html(""),$("#jsMaterialModel").modal("hide")}),"scorm"===courseType){function n(e){"completed"!=lessonStatus&&(i=$.ajax({url:apiURL+"lms/trainings/save_scorm/"+employeeId,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify({courseId:courseId,cmiElement:e,type:"scorm",version:scormVersion})}).success(function(e){if("failed"!==e.status)return"passed"===e.status?alertify.alert("SUCCESS!","Congratulations on successfully passing this course!",function(){window.location=baseURI+"lms/courses/my_lms_dashboard"}):void 0}).fail(handleErrorResponse).done(function(e){i=null}))}window.sendCourseToSave=n}$(document).on("click",".jsSaveQuestionResult",function(e){e.preventDefault();var s=[],t={};if(JSON.parse(questions).map(function(e){var o=e.question_type+"_"+e.question_id;if("yes_no"===e.question_type||"single_choice"===e.question_type){var a=$("input[name="+o+"]:checked").val();t[e.question_id]=a,a&&void 0!==a||1==e.question_required&&s.push(e.question_title)}else if("multiple_choice"===e.question_type){var r=[];$("input[name='"+o+"']:checked").each(function(){r.push($(this).val())}),t[e.question_id]=r,0==r.length&&1==e.question_required&&s.push(e.question_title)}else if("text"===e.question_type){var i=$('textarea[name="textarea_'+e.question_id+'"]').val();t[e.question_id]=i,i&&void 0!==i||1==e.question_required&&s.push(e.question_title)}}),s.length)return alertify.alert("WARNING!",getQuestionsFromArray(s),CB);try{return r(t),alertify.alert("SUCCESS!",createCourseResponse.data,function(){getLMSDefaultCourses(),$("#"+modalId).remove()})}catch(e){return ml(!1,modalLoaderId),alertify.alert("ERROR!",getErrorsStringFromArray(e.errors,"Errors!!"),CB)}}),"not_started"===lessonStatus?(ml(!1,"jsPageLoader"),$("#jsStartCourseDiv").show(),$(".jsSaveQuestionResult").hide()):"started"!==lessonStatus&&"completed"!==lessonStatus||(o(),"completed"===lessonStatus&&$(".jsSaveQuestionResult").hide())});