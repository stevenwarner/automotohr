$(function(){function e(){null!==n&&n.abort(),ml(!0,"jsPageLoader"),n=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+courseId+"/start?_has="+(-1!==window.location.host.indexOf("www.")?"y":"n"),method:"GET"}).success(function(e){n=null,"course_started"===e.status&&($("#jsStartCourseDiv").hide(),$(".jsSaveQuestionResult").show(),s()),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){n=null,ml(!1,"jsPageLoader")})}function s(){null!==n&&n.abort(),ml(!0,"jsPageLoader"),n=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+courseId+"/"+courseLanguage+"?_has="+(-1!==window.location.host.indexOf("www.")?"y":"n"),method:"GET"}).success(function(e){n=null,$("#jsPreviewCourse").html(e),"manual"===courseType&&o(),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){n=null,ml(!1,"jsPageLoader")})}function o(){null!==n&&n.abort(),ml(!0,"jsPageLoader"),n=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+courseId+"/questions/"+mode,method:"GET"}).success(function(e){n=null,$("#jsPreviewCourseQuestion").html(e),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){n=null,ml(!1,"jsPageLoader")})}function t(e){null!==n&&n.abort(),ml(!0,"jsPageLoader"),n=$.ajax({url:apiURL+"lms/trainings/"+employeeId,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify({courseId:courseId,answers:e})}).success(function(e){return n=null,"failed"===e.status?alertify.alert("WARNING!","Apologies for not passing this course. We highly encourage you to consider giving it another attempt.",function(){window.location=baseURI+"lms/courses/"+courseId}):"passed"===e.status?alertify.alert("SUCCESS!","Congratulations! you have successfully passed this course!",function(){window.location=baseURI+"lms/courses/my"}):void ml(!1,"jsPageLoader")}).fail(handleErrorResponse).done(function(){n=null,ml(!1,"jsPageLoader")})}let n=null;if($(".jsStartCourseButton").click(function(s){s.preventDefault(),alertify.confirm("Are you sure you want to start this course?",function(){e()},CB).setHeader("Confirm")}),$(document).on("change",".jsChangeScormLanguage",function(e){e.preventDefault();var s=$(this).data("course_id"),o=$(this).val(),t=baseURI+"lms/courses/"+s+"/"+o;alertify.confirm("Are you sure you want to change course language?",function(){window.location=t},CB).setHeader("Confirm")}),"scorm"===courseType){function a(e){"completed"!=lessonStatus&&(n=$.ajax({url:apiURL+"lms/trainings/save_scorm/"+employeeId,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify({courseId:courseId,cmiElement:e,type:"scorm",version:scormVersion})}).success(function(e){return"failed"===e.status?alertify.alert("WARNING!","Apologies for not passing this course. We highly encourage you to consider giving it another attempt.",function(){window.location=baseURI+"lms/courses/"+courseId}):"passed"===e.status?alertify.alert("SUCCESS!","Congratulations on successfully passing this course!",function(){window.location=baseURI+"lms/courses/my"}):void 0}).fail(handleErrorResponse).done(function(e){n=null}))}window.sendCourseToSave=a}$(document).on("click",".jsSaveQuestionResult",function(e){e.preventDefault();var s=[],o={};if(JSON.parse(questions).map(function(e){var t=e.question_type+"_"+e.question_id;if("yes_no"===e.question_type||"single_choice"===e.question_type){var n=$("input[name="+t+"]:checked").val();o[e.question_id]=n,n&&void 0!==n||1==e.question_required&&s.push(e.question_title)}else if("multiple_choice"===e.question_type){var a=[];$("input[name='"+t+"']:checked").each(function(){a.push($(this).val())}),o[e.question_id]=a,0==a.length&&1==e.question_required&&s.push(e.question_title)}else if("text"===e.question_type){var r=$('textarea[name="textarea_'+e.question_id+'"]').val();o[e.question_id]=r,r&&void 0!==r||1==e.question_required&&s.push(e.question_title)}}),s.length)return alertify.alert("WARNING!",getQuestionsFromArray(s),CB);try{return t(o),alertify.alert("SUCCESS!",createCourseResponse.data,function(){getLMSDefaultCourses(),$("#"+modalId).remove()})}catch(e){return ml(!1,modalLoaderId),alertify.alert("ERROR!",getErrorsStringFromArray(e.errors,"Errors!!"),CB)}}),"not_started"===lessonStatus?(ml(!1,"jsPageLoader"),$("#jsStartCourseDiv").show(),$(".jsSaveQuestionResult").hide()):"started"!==lessonStatus&&"completed"!==lessonStatus||(s(),"completed"===lessonStatus&&$(".jsSaveQuestionResult").hide())});