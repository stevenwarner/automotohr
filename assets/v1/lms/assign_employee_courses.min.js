$(function(){function t(t,s){null!==e&&e.abort(),ml(!0,"jsPageLoader"),e=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"/"+s+"/"+t,method:"PUT"}).success(function(a){e=null,"language_changed"===a.status&&(window.location=baseURI+"lms/courses/"+s+"/"+t),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){e=null,ml(!1,"jsPageLoader")})}function s(){null!==e&&e.abort(),ml(!0,"jsPageLoader"),e=$.ajax({url:apiURL+"lms/trainings/"+employeeId+"?title="+a.title+"&status="+a.status,method:"GET"}).success(function(t){e=null;let s="",a=t.data.count,i=t.data.courses;$("#jsAssignedCount").html(a.assigned),$("#jsPendingCount").html(a.pending),$("#jsCompletedCount").html(a.completed),$("#jsExpiredSoonCount").html(a.expire_soon),t.data.assignedIds.length||($(".jsFilterSectionBtn").hide(),$(".jsSendReminderEmail").hide());var l=[];i.length?i.map(function(e){if((null==e.employee_sid||e.employee_sid==employeeId)&&t.data.assignedIds.includes(e.sid)&&!l.includes(e.sid)){if(l.push(e.sid),t.data.expiredSoonIds.includes(e.sid)?s+='<article class="article-sec" style="background: #fcf8e3 !important">':t.data.expiredIds.includes(e.sid)?s+='<article class="article-sec" style="background: #f2dede !important">':s+='<article class="article-sec">',t.data.expiredSoonIds.includes(e.sid)){const t=moment(e.course_end_period,"YYYY-MM-DD"),o=moment(),i=t.diff(o,"days");var a="";a=0==i?"Expiring today":1==i?`Expiring in ${i} day`:`Expiring in ${i} days`,s+='    <div class="row">',s+='        <div class="col-md-12 col-xs-12 text-right">',s+=`        \t<a href="javascript:;" class="btn btn-warning btn-xs csRadius5 csF14" title="This course will expire in ${i} days" placement="top">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-info-circle csF14" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&nbsp;${a}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,s+="        </div>",s+="    </div>"}if(t.data.expiredIds.includes(e.sid)){const t=moment(e.course_end_period,"YYYY-MM-DD"),a=moment(),o=Math.abs(t.diff(a,"days"));var i="";i=0==o?"Expired today":1==o?`Expired ${o} day ago`:`Expired ${o} days ago`,s+='    <div class="row">',s+='        <div class="col-md-12 col-xs-12 text-right">',s+=`        \t<a href="javascript:;" class="btn btn-danger btn-xs csRadius5 csF14" title="This course was expired ${o} days ago." placement="top">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-info-circle csF14" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&nbsp;${i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,s+="        </div>",s+="    </div>"}s+="    <h1>",s+=e.course_title,s+="    </h1>",s+="    <br>",s+='    <div class="row">',s+='        <div class="col-md-3 col-xs-12">',s+='            <p class="csColumSection"><strong>ASSIGNED DATE</strong></p>',s+=`            <p>${moment(e.course_start_period).format(o)}</p>`,s+="        </div>",s+='        <div class="col-md-3 col-xs-12">',s+='            <p class="csColumSection"><strong>DUE DATE</strong></p>',null===e.course_end_period?s+="--":s+=`            <p>${moment(e.course_end_period).format(o)}</p>`,s+="        </div>",s+='        <div class="col-md-3 col-xs-12">',s+='            <p class="csColumSection"><strong>STATUS</strong></p>',s+=`            <p>${"passed"==e.course_status?"COMPLETED":"PENDING"}</p>`,s+="        </div>",s+='        <div class="col-md-3 col-xs-12">',s+='            <p class="csColumSection"><strong>ASSIGNED TO</strong></p>',s+=`            <p>${t.data.employeeName}</p>`,s+="        </div>",s+="    </div>",s+='    <div class="row">',s+='        <div class="col-md-3 col-xs-12 hidden">',s+='            <p class="csColumSection"><strong>TIME REMAINING/TOTAL</strong></p>',s+="            <p>15 min / 15 min</p>",s+="        </div>",s+='        <div class="col-md-3 col-xs-12">',s+='            <p class="csColumSection"><strong>STARTED DATE </strong></p>',s+=`            <p>${e.created_at?moment(e.created_at).format(o):"-"}</p>`,s+="        </div>",s+='        <div class="col-md-3 col-xs-12">',s+='            <p class="csColumSection"><strong>LANGUAGE</strong></p>',s+=`            <select class="form-control jsSelectCourseLanguage jsCourseLanguage${e.sid}" data-course_id="${e.sid}">`;var n="",c="";n="scorm"==e.course_type?e.course_languages[0]:"english","scorm"==e.course_type?e.course_languages.map(function(t){e.selected_language&&e.selected_language==t?(n=e.selected_language,c=e.selected_language,s+=`            <option value="${t}" selected="selected">${t.charAt(0).toUpperCase()+t.slice(1)}</option>`):s+=`            <option value="${t}">${t.charAt(0).toUpperCase()+t.slice(1)}</option>`}):s+='                <option value="english">English</option>',s+="            </select>",s+="        </div>",s+='        <div class="col-md-6 col-xs-12 text-right">',s+="            <p>&nbsp;</p>","passed"==e.course_status?(s+=`            <a class="btn btn-info csRadius5 csF16 jsStartCourse jsStartCourse${e.sid}" data-previous_language="${c}" data-course_id="${e.sid}" href="${baseURI+"lms/courses/"+e.sid+"/"+n}">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-eye"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tView Content\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,s+=`        <a class="btn btn-info csRadius5 csF16" href="${window.location.origin}/lms/courses/${e.sid}/${employeeId}/my/certificate">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-eye"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tView Certificate\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`):s+=`            <a class="btn btn-info csRadius5 csF16 jsStartCourse jsStartCourse${e.sid}" data-previous_language="${c}" data-course_id="${e.sid}" href="${baseURI+"lms/courses/"+e.sid+"/"+n}">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-play"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tLaunch Content\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>`,s+="        </div>",s+="    </div>",s+="</article>"}}):s='<p class="alert alert-info text-center">No Courses found.</p>',$("#jsMyAssignedCourses").html(s),ml(!1,"jsPageLoader")}).fail(handleErrorResponse).always(function(){e=null,ml(!1,"jsPageLoader")})}let e=null,a={title:"",status:"all"};search.length&&(a.status=search);let o="MMM DD YYYY, ddd";$(".jsFilterBox").click(function(t){t.preventDefault(),$(".jsCourseTitleMyCourse").val(""),$('.jsCourseStatus option[value="'+$(this).data("key")+'"]').prop("selected",!0),a.title=$(".jsCourseTitleMyCourse").val()||"",a.status=$(".jsCourseStatus").val(),s()}),$(".jsApplyFilterMyCourse").click(function(t){t.preventDefault(),a.title=$(".jsCourseTitleMyCourse").val()||"",a.status=$(".jsCourseStatus").val(),s()}),$(".jsClearFilterMyCourse").click(function(t){t.preventDefault(),$(".jsCourseTitleMyCourse").val(""),$('.jsCourseStatus option[value="all"]').prop("selected",!0),a.title=$(".jsCourseTitleMyCourse").val()||"",a.status=$(".jsCourseStatus").val(),s()}),$(document).on("click",".jsStartCourse",function(s){s.preventDefault();var e=$(this).data("course_id"),a=$(".jsCourseLanguage"+e).val(),o=baseURI+"lms/courses/"+e+"/"+a,i=$(this).data("previous_language");i.length&&i!=a?alertify.confirm("Are you sure you want to change course language?",function(){t(a,e)},CB).setHeader("Confirm"):($(this).attr("href",o),window.location=$(this).attr("href").toString())}),$(document).on("change",".jsSelectCourseLanguage",function(t){t.preventDefault();var s=$(this).data("course_id"),e=$(this).val(),a=baseURI+"lms/courses/"+s+"/"+e;$(".jsStartCourse"+s).attr("href",a)}),s()});