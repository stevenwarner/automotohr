$((function () { let e = null; function t(t, n, a) { null !== e && e.abort(), e = $.ajax({ url: baseUrl("cms/ui/" + n), method: "GET" }).always((function () { e = null })).fail(handleErrorResponse).done((function (e) { $("#js" + t + "ModalBody").html(e.view), void 0 !== a && a(), ml(!1, "js" + t + "ModalLoader") })) } $(".jsDraggable").sortable({ update: function (t, n) { var a = 0, d = [], i = n.item.context.className.split(" "); $("." + i[0]).map((function (e) { a = $(this).data("index"), d.push($(this).data("key")) })); var o = {}; o.tagIndex = a, o.sortOrders = d, function (t) { null !== e && e.abort(); e = $.ajax({ url: baseUrl("cms/update_sort_order/" + getSegment(2)), method: "post", data: t }).always((function () { e = null })).fail(handleErrorResponse).done((function (e) { })) }(o) } }), $("#jsSection0File").msFileUploader({ allowedTypes: ["jpg", "jpeg", "png", "webp"], allowLinks: !1, activeLink: section0.sourceType, placeholderImage: section0.sourceFile, fileLimit: "200mb" }), $("#jsSection0Form").validate({ ignore: [], rules: { title: { required: !0 } }, submitHandler: function (e) { let t = formArrayToObj($(e).serializeArray()); t.append("section", "section0"); const n = $("#jsSection0File").msFileUploader("get"); return isValidFile(n) ? (void 0 !== n.link ? (t.append("source_type", n.type), t.append("source_link", n.link)) : (t.append("source_type", "upload"), t.append("file", n)), processOldData(t, $(".jsSection0Btn"), "section0")) : _error("Please select a valid image for banner.") } }), $(".jsAddMainSection").click((function (e) { e.preventDefault(), Modal({ Id: "jsAddModal", Loader: "jsAddModalLoader", Body: '<div id="jsAddModalBody"></div>', Title: "Add a Section" }, (function () { t("Add", "add", (function () { $("#jsAddForm").validate({ rules: { title: { required: !0 } }, submitHandler: function (e) { let t = formArrayToObj($(e).serializeArray()); return t.append("section", "section0"), t.append("index", "tags"), processPageSection(t, $(".jsAddBtn"), "section0") } }) })) })) })), $(".jsDeleteSection").click((function (e) { e.preventDefault(), e.stopPropagation(); const t = $(this).data("index"); return _confirm("Do you really wan tto delete this section?", (function () { !function (e) { $.ajax({ url: baseUrl("cms/" + getSegment(2) + "/tag/" + e), method: "delete" }).fail(handleErrorResponse).done((function (e) { _success(e.msg, (function () { window.location.href = baseUrl("manage_admin/edit_page/" + getSegment(2) + "/?page=section_0") })) })) }(t) })) })), $(".jsAddCardSection").click((function (e) { e.preventDefault(); const n = $(this).data("index"); Modal({ Id: "jsAddModal", Loader: "jsAddModalLoader", Body: '<div id="jsAddModalBody"></div>', Title: "Add a Card Section" }, (function () { t("Add", "add_card", (function () { $("#jsSortOrderSection").removeClass("hidden"), $("#jsAddCardForm").validate({ rules: { title: { required: !0 }, details: { required: !0 }, buttonText: { required: !0 }, buttonLink: { required: !0 }, sortOrder: { required: !0 } }, submitHandler: function (e) { let t = formArrayToObj($(e).serializeArray()); return t.append("section", "section0"), t.append("tagIndex", n), processCardSection(t, $(".jsAddCardBtn"), "sectionTag" + n) } }) })) })) })), $(".jsDeleteTagCard").click((function (e) { e.preventDefault(); const t = $(this).closest(".row").data("key"), n = $(this).closest(".row").data("index"); return _confirm("Do you really wan tto delete this card?", (function () { !function (e, t) { $.ajax({ url: baseUrl("cms/" + getSegment(2) + "/tag/" + e + "/" + t), method: "delete" }).fail(handleErrorResponse).done((function (e) { _success(e.msg, (function () { window.location.href = baseUrl("manage_admin/edit_page/" + getSegment(2) + "/?page=sectionTag" + t) })) })) }(t, n) })) })), $(".jsEditTagCard").click((function (t) { t.preventDefault(); const n = $(this).closest(".row").data("key"), a = $(this).closest(".row").data("index"); Modal({ Id: "jsEditModal", Loader: "jsEditModalLoader", Body: '<div id="jsEditModalBody"></div>', Title: "Edit a Card Section" }, (function () { !function (t, n, a, d) { null !== e && e.abort(); e = $.ajax({ url: baseUrl("cms/ui/" + n), method: "post", data: d }).always((function () { e = null })).fail(handleErrorResponse).done((function (e) { $("#js" + t + "ModalBody").html(e.view), void 0 !== a && a(), ml(!1, "js" + t + "ModalLoader") })) }("Edit", "edit_card", (function () { $("#jsSortOrderSection").removeClass("hidden"), $("#jsEditCardForm").validate({ rules: { title: { required: !0 }, details: { required: !0 }, buttonText: { required: !0 }, buttonLink: { required: !0 }, sortOrder: { required: !0 } }, submitHandler: function (e) { let t = formArrayToObj($(e).serializeArray()); return t.append("pageId", getSegment(2)), t.append("tagIndex", a), t.append("index", n), processCardSection(t, $(".jsEditCardBtn"), "sectionTag" + a) } }) }), { section: "section0|tags|" + a + "|cards|" + n, pageId: getSegment(2) }) })) })), $(document).on("keyup", '[data-target="buttonLink"]', (function () { const e = $(this).data("target"); $('[name="' + e + '"]').val($(this).val().replace(/[^a-z0-9]/gi, "-").replace(/-+/g, "-").toLowerCase()) })), $(".jsEditSection").click((function (e) { e.preventDefault(), e.stopPropagation(); const n = $(this).data("index"), a = $(this).data("title"); e.preventDefault(), Modal({ Id: "jsEditModal", Loader: "jsEditModalLoader", Body: '<div id="jsEditModalBody"></div>', Title: "Edit Section" }, (function () { t("Edit", "edit", (function () { $("#jsSectionTitle").val(a), $("#jsSectionIndex").val(n), $("#jsEditForm").validate({ rules: { title: { required: !0 } }, submitHandler: function (e) { let t = formArrayToObj($(e).serializeArray()); return t.append("section", "section0"), t.append("index", "tags"), processPageSection(t, $(".jsAddBtn"), "section0") } }) })) })) })) }));