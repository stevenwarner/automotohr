$((function(){let employeeId,employeeName;function getEmployeeProfileHistory(e){e.preventDefault(),employeeId=$(this).data("id"),employeeName=$(this).data("name"),Model({Id:"jsEmployeeProfileHistoryModel",Loader:"jsEmployeeProfileHistoryLoader",Body:'<div class="container"><div id="jsEmployeeProfileHistoryBody"></div></div>',Title:"Profile History of "+employeeName},getData)}function getData(){let rows="";rows+="<div>",rows+="  \x3c!-- Nav tabs --\x3e",rows+='  <ul class="nav nav-tabs" role="tablist">',rows+='    <li role="presentation" class="active"><a href="#profile" id="profileHead" aria-controls="profile" role="tab" data-toggle="tab">Profile <span></span></a></li>',rows+='    <li role="presentation"><a href="#directDeposit" id="directDepositHead" aria-controls="directDeposit" role="tab" data-toggle="tab">Direct Deposit <span></span></a></li>',rows+='    <li role="presentation"><a href="#driversLicense" id="driversLicenseHead" aria-controls="driversLicense" role="tab" data-toggle="tab">Drivers License <span></span></a></li>',rows+='    <li role="presentation"><a href="#occupationalLicense" id="occupationalLicenseHead" aria-controls="occupationalLicense" role="tab" data-toggle="tab">Occupational License <span></span></a></li>',rows+='    <li role="presentation"><a href="#dependent" id="dependentHead" aria-controls="dependent" role="tab" data-toggle="tab">Dependents <span></span></a></li>',rows+='    <li role="presentation"><a href="#emergencyContact" id="emergencyContactHead" aria-controls="emergencyContact" role="tab" data-toggle="tab">Emergency Contacts <span></span></a></li>',rows+="  </ul>",rows+="  \x3c!-- Tab panes --\x3e",rows+='  <div class="tab-content">',rows+='    <div role="tabpanel" class="tab-pane active" id="profile"></div>',rows+='    <div role="tabpanel" class="tab-pane" id="directDeposit"></div>',rows+='    <div role="tabpanel" class="tab-pane" id="driversLicense"></div>',rows+='    <div role="tabpanel" class="tab-pane" id="occupationalLicense"></div>',rows+='    <div role="tabpanel" class="tab-pane" id="dependent"></div>',rows+='    <div role="tabpanel" class="tab-pane" id="emergencyContact"></div>',rows+="  </div>",rows+="</div>",$("#jsEmployeeProfileHistoryBody").html(rows),$.get(baseURI+"get_employee_profile_history/"+employeeId).success(loadData).fail(handleError)}function loadData(response){let obj={profile:"",directDeposit:"",driversLicense:"",occupationalLicense:"",dependent:"",emergencyContact:""};response.history.map((function(record){let rows="",data=JSON.parse(record.profile_data);rows+="<br />",rows+='<table class="table table-bordered">',rows+="   <thead>",rows+='       <tr class="bg-primary">',rows+='           <th colspan="3">',rows+='<span class="pull-right"> '+moment(record.created_at).format("DD MMMM Y, dddd HH:mm:ss")+"</span>",0!=record.employer_sid?rows+=" "+record.full_name:rows+="Self",rows+="           </th>",rows+="       </tr>",rows+="   </thead>",rows+="   <tbody>",rows+="   {{innerRows}}",rows+="   </tbody>",rows+="</table>",rows+="<hr />";let innerRows="";for(let index in data){let newData=data[index].new||"-",oldData=data[index].old||"-";"location_state"==index.toLowerCase()&&(newData=response.states[newData]||"-",oldData=response.states[oldData]||"-"),"dob"!=index.toLowerCase()&&"rehire_date"!=index.toLowerCase()&&"joined_at"!=index.toLowerCase()&&"birth_date"!=index.toLowerCase()&&"license_issue_date"!=index.toLowerCase()&&"license_expiration_date"!=index.toLowerCase()&&"consent_date"!=index.toLowerCase()||(newData="-"!=newData?moment(newData,"Y-MM-DD").format("DD MMMM Y, dddd"):newData,oldData="-"!=oldData?moment(oldData,"Y-MM-DD").format("DD MMMM Y, dddd"):oldData),"profile_picture"!=index.toLowerCase()&&"license_file"!=index.toLowerCase()&&"voided_cheque"!=index.toLowerCase()&&"user_signature"!=index.toLowerCase()||(newData="-"!=newData?'<img src="'+("user_signature"==index.toLowerCase()?"":"https://automotohrattachments.s3.amazonaws.com/")+newData+'" width="60" />':newData,oldData="-"!=oldData?'<img src="'+("user_signature"==index.toLowerCase()?"":"https://automotohrattachments.s3.amazonaws.com/")+oldData+'" width="60" />':oldData),innerRows+="   <tr>",innerRows+="       <td><strong>"+index.replace(/[^a-z]/gi," ").toUpperCase()+"</strong></td>","action"==index?innerRows+='       <td class="bg-danger text-center" colspan="2">Deleted</td>':(innerRows+='       <td class="bg-danger">'+oldData+"</td>",innerRows+='       <td class="bg-success">'+newData+"</td>"),innerRows+="   </tr>"}innerRows.length>0&&(obj[record.history_type]+=rows.replace(/{{innerRows}}/i,innerRows))}));for(let index in obj)0===obj[index].length&&$("#"+index+"Head").parent().remove(),$("#"+index).html(obj[index]);ml(!1,"jsEmployeeProfileHistoryLoader")}function handleError(){let rows="";rows+='<div class="alert alert-danger text-center">',rows+="   <p>Oops! Something went wrong</p>",rows+="</div>",$("#jsEmployeeProfileHistoryBody").html(rows),ml(!1,"jsEmployeeProfileHistoryLoader")}$("#jsProfileHistory").click(getEmployeeProfileHistory),$(".jsProfileHistory").click(getEmployeeProfileHistory)}));